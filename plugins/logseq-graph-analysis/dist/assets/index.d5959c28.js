var Th=Object.defineProperty,Oh=Object.defineProperties;var kh=Object.getOwnPropertyDescriptors;var Ji=Object.getOwnPropertySymbols;var Ds=Object.prototype.hasOwnProperty,Ps=Object.prototype.propertyIsEnumerable;var xs=(n,t,e)=>t in n?Th(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,wr=(n,t)=>{for(var e in t||(t={}))Ds.call(t,e)&&xs(n,e,t[e]);if(Ji)for(var e of Ji(t))Ps.call(t,e)&&xs(n,e,t[e]);return n},ci=(n,t)=>Oh(n,kh(t));var Jo=(n,t)=>{var e={};for(var r in n)Ds.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&Ji)for(var r of Ji(n))t.indexOf(r)<0&&Ps.call(n,r)&&(e[r]=n[r]);return e};const yo={},xh=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}};xh();var Y=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Rs={exports:{}};/*! For license information please see lsplugin.user.js.LICENSE.txt */(function(n,t){(function(e,r){n.exports=r()})(self,()=>(()=>{var e={227:(a,s,c)=>{var l=c(155);s.formatArgs=function(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+a.exports.humanize(this.diff),!this.useColors)return;const g="color: "+this.color;p.splice(1,0,g,"color: inherit");let v=0,m=0;p[0].replace(/%[a-zA-Z%]/g,E=>{E!=="%%"&&(v++,E==="%c"&&(m=v))}),p.splice(m,0,g)},s.save=function(p){try{p?s.storage.setItem("debug",p):s.storage.removeItem("debug")}catch{}},s.load=function(){let p;try{p=s.storage.getItem("debug")}catch{}return!p&&l!==void 0&&"env"in l&&(p=l.env.DEBUG),p},s.useColors=function(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},s.storage=function(){try{return localStorage}catch{}}(),s.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],s.log=console.debug||console.log||(()=>{}),a.exports=c(447)(s);const{formatters:f}=a.exports;f.j=function(p){try{return JSON.stringify(p)}catch(g){return"[UnexpectedJSONParseError]: "+g.message}}},447:(a,s,c)=>{a.exports=function(l){function f(v){let m,E,S,C=null;function L(...O){if(!L.enabled)return;const x=L,A=Number(new Date),R=A-(m||A);x.diff=R,x.prev=m,x.curr=A,m=A,O[0]=f.coerce(O[0]),typeof O[0]!="string"&&O.unshift("%O");let b=0;O[0]=O[0].replace(/%([a-zA-Z%])/g,(_,w)=>{if(_==="%%")return"%";b++;const $=f.formatters[w];if(typeof $=="function"){const M=O[b];_=$.call(x,M),O.splice(b,1),b--}return _}),f.formatArgs.call(x,O),(x.log||f.log).apply(x,O)}return L.namespace=v,L.useColors=f.useColors(),L.color=f.selectColor(v),L.extend=p,L.destroy=f.destroy,Object.defineProperty(L,"enabled",{enumerable:!0,configurable:!1,get:()=>C!==null?C:(E!==f.namespaces&&(E=f.namespaces,S=f.enabled(v)),S),set:O=>{C=O}}),typeof f.init=="function"&&f.init(L),L}function p(v,m){const E=f(this.namespace+(m===void 0?":":m)+v);return E.log=this.log,E}function g(v){return v.toString().substring(2,v.toString().length-2).replace(/\.\*\?$/,"*")}return f.debug=f,f.default=f,f.coerce=function(v){return v instanceof Error?v.stack||v.message:v},f.disable=function(){const v=[...f.names.map(g),...f.skips.map(g).map(m=>"-"+m)].join(",");return f.enable(""),v},f.enable=function(v){let m;f.save(v),f.namespaces=v,f.names=[],f.skips=[];const E=(typeof v=="string"?v:"").split(/[\s,]+/),S=E.length;for(m=0;m<S;m++)E[m]&&((v=E[m].replace(/\*/g,".*?"))[0]==="-"?f.skips.push(new RegExp("^"+v.slice(1)+"$")):f.names.push(new RegExp("^"+v+"$")))},f.enabled=function(v){if(v[v.length-1]==="*")return!0;let m,E;for(m=0,E=f.skips.length;m<E;m++)if(f.skips[m].test(v))return!1;for(m=0,E=f.names.length;m<E;m++)if(f.names[m].test(v))return!0;return!1},f.humanize=c(824),f.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(l).forEach(v=>{f[v]=l[v]}),f.names=[],f.skips=[],f.formatters={},f.selectColor=function(v){let m=0;for(let E=0;E<v.length;E++)m=(m<<5)-m+v.charCodeAt(E),m|=0;return f.colors[Math.abs(m)%f.colors.length]},f.enable(f.load()),f}},856:function(a){a.exports=function(){function s(q){return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},s(q)}function c(q,V){return c=Object.setPrototypeOf||function(ae,ge){return ae.__proto__=ge,ae},c(q,V)}function l(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f(q,V,ae){return f=l()?Reflect.construct:function(ge,Re,xe){var Be=[null];Be.push.apply(Be,Re);var re=new(Function.bind.apply(ge,Be));return xe&&c(re,xe.prototype),re},f.apply(null,arguments)}function p(q){return g(q)||v(q)||m(q)||S()}function g(q){if(Array.isArray(q))return E(q)}function v(q){if(typeof Symbol!="undefined"&&q[Symbol.iterator]!=null||q["@@iterator"]!=null)return Array.from(q)}function m(q,V){if(q){if(typeof q=="string")return E(q,V);var ae=Object.prototype.toString.call(q).slice(8,-1);return ae==="Object"&&q.constructor&&(ae=q.constructor.name),ae==="Map"||ae==="Set"?Array.from(q):ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ae)?E(q,V):void 0}}function E(q,V){(V==null||V>q.length)&&(V=q.length);for(var ae=0,ge=new Array(V);ae<V;ae++)ge[ae]=q[ae];return ge}function S(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var C=Object.hasOwnProperty,L=Object.setPrototypeOf,O=Object.isFrozen,x=Object.getPrototypeOf,A=Object.getOwnPropertyDescriptor,R=Object.freeze,b=Object.seal,_=Object.create,w=typeof Reflect!="undefined"&&Reflect,$=w.apply,M=w.construct;$||($=function(q,V,ae){return q.apply(V,ae)}),R||(R=function(q){return q}),b||(b=function(q){return q}),M||(M=function(q,V){return f(q,p(V))});var Q=P(Array.prototype.forEach),pe=P(Array.prototype.pop),J=P(Array.prototype.push),Te=P(String.prototype.toLowerCase),Ve=P(String.prototype.match),le=P(String.prototype.replace),D=P(String.prototype.indexOf),U=P(String.prototype.trim),B=P(RegExp.prototype.test),I=fe(TypeError);function P(q){return function(V){for(var ae=arguments.length,ge=new Array(ae>1?ae-1:0),Re=1;Re<ae;Re++)ge[Re-1]=arguments[Re];return $(q,V,ge)}}function fe(q){return function(){for(var V=arguments.length,ae=new Array(V),ge=0;ge<V;ge++)ae[ge]=arguments[ge];return M(q,ae)}}function K(q,V){L&&L(q,null);for(var ae=V.length;ae--;){var ge=V[ae];if(typeof ge=="string"){var Re=Te(ge);Re!==ge&&(O(V)||(V[ae]=Re),ge=Re)}q[ge]=!0}return q}function he(q){var V,ae=_(null);for(V in q)$(C,q,[V])&&(ae[V]=q[V]);return ae}function Pe(q,V){for(;q!==null;){var ae=A(q,V);if(ae){if(ae.get)return P(ae.get);if(typeof ae.value=="function")return P(ae.value)}q=x(q)}function ge(Re){return console.warn("fallback value for",Re),null}return ge}var Ce=R(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ie=R(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),St=R(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ne=R(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ke=R(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Oe=R(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tt=R(["#text"]),rt=R(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ye=R(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),be=R(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),_e=R(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ut=b(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ce=b(/<%[\w\W]*|[\w\W]*%>/gm),de=b(/^data-[\-\w.\u00B7-\uFFFF]/),G=b(/^aria-[\-\w]+$/),vt=b(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ct=b(/^(?:\w+script|data):/i),ht=b(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),kt=b(/^html$/i),mt=function(){return typeof window=="undefined"?null:window},Qe=function(q,V){if(s(q)!=="object"||typeof q.createPolicy!="function")return null;var ae=null,ge="data-tt-policy-suffix";V.currentScript&&V.currentScript.hasAttribute(ge)&&(ae=V.currentScript.getAttribute(ge));var Re="dompurify"+(ae?"#"+ae:"");try{return q.createPolicy(Re,{createHTML:function(xe){return xe}})}catch{return console.warn("TrustedTypes policy "+Re+" could not be created."),null}};function Et(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mt(),V=function(T){return Et(T)};if(V.version="2.3.8",V.removed=[],!q||!q.document||q.document.nodeType!==9)return V.isSupported=!1,V;var ae=q.document,ge=q.document,Re=q.DocumentFragment,xe=q.HTMLTemplateElement,Be=q.Node,re=q.Element,Ae=q.NodeFilter,je=q.NamedNodeMap,gr=je===void 0?q.NamedNodeMap||q.MozNamedAttrMap:je,$n=q.HTMLFormElement,xi=q.DOMParser,Di=q.trustedTypes,Mr=re.prototype,Pi=Pe(Mr,"cloneNode"),Ri=Pe(Mr,"nextSibling"),Ro=Pe(Mr,"childNodes"),kr=Pe(Mr,"parentNode");if(typeof xe=="function"){var Un=ge.createElement("template");Un.content&&Un.content.ownerDocument&&(ge=Un.content.ownerDocument)}var nr=Qe(Di,ae),Fi=nr?nr.createHTML(""):"",zr=ge,Nn=zr.implementation,Ii=zr.createNodeIterator,ji=zr.createDocumentFragment,Fo=zr.getElementsByTagName,Mn=ae.importNode,Gi={};try{Gi=he(ge).documentMode?ge.documentMode:{}}catch{}var yt={};V.isSupported=typeof kr=="function"&&Nn&&Nn.createHTMLDocument!==void 0&&Gi!==9;var xr,ir,zn=ut,Bn=ce,an=de,$t=G,Wn=Ct,Br=ht,qn=vt,ft=null,Hn=K({},[].concat(p(Ce),p(ie),p(St),p(Ke),p(tt))),pt=null,Vn=K({},[].concat(p(rt),p(ye),p(be),p(_e))),Je=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Wr=null,Yn=null,Kn=!0,Zn=!0,$i=!1,Dr=!1,Fe=!1,Xn=!1,Qn=!1,vr=!1,or=!1,Pr=!1,Jn=!0,sn=!0,mr=!1,ar={},Rr=null,Ui=K({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ni=null,Mi=K({},["audio","video","img","source","image","track"]),ei=null,un=K({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ti="http://www.w3.org/1998/Math/MathML",ln="http://www.w3.org/2000/svg",sr="http://www.w3.org/1999/xhtml",cn=sr,zi=!1,Bi=["application/xhtml+xml","text/html"],Io="text/html",Fr=null,jo=ge.createElement("form"),hn=function(T){return T instanceof RegExp||T instanceof Function},ri=function(T){Fr&&Fr===T||(T&&s(T)==="object"||(T={}),T=he(T),ft="ALLOWED_TAGS"in T?K({},T.ALLOWED_TAGS):Hn,pt="ALLOWED_ATTR"in T?K({},T.ALLOWED_ATTR):Vn,ei="ADD_URI_SAFE_ATTR"in T?K(he(un),T.ADD_URI_SAFE_ATTR):un,Ni="ADD_DATA_URI_TAGS"in T?K(he(Mi),T.ADD_DATA_URI_TAGS):Mi,Rr="FORBID_CONTENTS"in T?K({},T.FORBID_CONTENTS):Ui,Wr="FORBID_TAGS"in T?K({},T.FORBID_TAGS):{},Yn="FORBID_ATTR"in T?K({},T.FORBID_ATTR):{},ar="USE_PROFILES"in T&&T.USE_PROFILES,Kn=T.ALLOW_ARIA_ATTR!==!1,Zn=T.ALLOW_DATA_ATTR!==!1,$i=T.ALLOW_UNKNOWN_PROTOCOLS||!1,Dr=T.SAFE_FOR_TEMPLATES||!1,Fe=T.WHOLE_DOCUMENT||!1,vr=T.RETURN_DOM||!1,or=T.RETURN_DOM_FRAGMENT||!1,Pr=T.RETURN_TRUSTED_TYPE||!1,Qn=T.FORCE_BODY||!1,Jn=T.SANITIZE_DOM!==!1,sn=T.KEEP_CONTENT!==!1,mr=T.IN_PLACE||!1,qn=T.ALLOWED_URI_REGEXP||qn,cn=T.NAMESPACE||sr,T.CUSTOM_ELEMENT_HANDLING&&hn(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Je.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&hn(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Je.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Je.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),xr=xr=Bi.indexOf(T.PARSER_MEDIA_TYPE)===-1?Io:T.PARSER_MEDIA_TYPE,ir=xr==="application/xhtml+xml"?function(ee){return ee}:Te,Dr&&(Zn=!1),or&&(vr=!0),ar&&(ft=K({},p(tt)),pt=[],ar.html===!0&&(K(ft,Ce),K(pt,rt)),ar.svg===!0&&(K(ft,ie),K(pt,ye),K(pt,_e)),ar.svgFilters===!0&&(K(ft,St),K(pt,ye),K(pt,_e)),ar.mathMl===!0&&(K(ft,Ke),K(pt,be),K(pt,_e))),T.ADD_TAGS&&(ft===Hn&&(ft=he(ft)),K(ft,T.ADD_TAGS)),T.ADD_ATTR&&(pt===Vn&&(pt=he(pt)),K(pt,T.ADD_ATTR)),T.ADD_URI_SAFE_ATTR&&K(ei,T.ADD_URI_SAFE_ATTR),T.FORBID_CONTENTS&&(Rr===Ui&&(Rr=he(Rr)),K(Rr,T.FORBID_CONTENTS)),sn&&(ft["#text"]=!0),Fe&&K(ft,["html","head","body"]),ft.table&&(K(ft,["tbody"]),delete Wr.tbody),R&&R(T),Fr=T)},ni=K({},["mi","mo","mn","ms","mtext"]),Wi=K({},["foreignobject","desc","title","annotation-xml"]),Go=K({},["title","style","font","a","script"]),dn=K({},ie);K(dn,St),K(dn,Ne);var ii=K({},Ke);K(ii,Oe);var $o=function(T){var ee=kr(T);ee&&ee.tagName||(ee={namespaceURI:sr,tagName:"template"});var X=Te(T.tagName),We=Te(ee.tagName);return T.namespaceURI===ln?ee.namespaceURI===sr?X==="svg":ee.namespaceURI===ti?X==="svg"&&(We==="annotation-xml"||ni[We]):Boolean(dn[X]):T.namespaceURI===ti?ee.namespaceURI===sr?X==="math":ee.namespaceURI===ln?X==="math"&&Wi[We]:Boolean(ii[X]):T.namespaceURI===sr&&!(ee.namespaceURI===ln&&!Wi[We])&&!(ee.namespaceURI===ti&&!ni[We])&&!ii[X]&&(Go[X]||!dn[X])},Zt=function(T){J(V.removed,{element:T});try{T.parentNode.removeChild(T)}catch{try{T.outerHTML=Fi}catch{T.remove()}}},qi=function(T,ee){try{J(V.removed,{attribute:ee.getAttributeNode(T),from:ee})}catch{J(V.removed,{attribute:null,from:ee})}if(ee.removeAttribute(T),T==="is"&&!pt[T])if(vr||or)try{Zt(ee)}catch{}else try{ee.setAttribute(T,"")}catch{}},Hi=function(T){var ee,X;if(Qn)T="<remove></remove>"+T;else{var We=Ve(T,/^[\r\n\t ]+/);X=We&&We[0]}xr==="application/xhtml+xml"&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");var it=nr?nr.createHTML(T):T;if(cn===sr)try{ee=new xi().parseFromString(it,xr)}catch{}if(!ee||!ee.documentElement){ee=Nn.createDocument(cn,"template",null);try{ee.documentElement.innerHTML=zi?"":it}catch{}}var bt=ee.body||ee.documentElement;return T&&X&&bt.insertBefore(ge.createTextNode(X),bt.childNodes[0]||null),cn===sr?Fo.call(ee,Fe?"html":"body")[0]:Fe?ee.documentElement:bt},qr=function(T){return Ii.call(T.ownerDocument||T,T,Ae.SHOW_ELEMENT|Ae.SHOW_COMMENT|Ae.SHOW_TEXT,null,!1)},Uo=function(T){return T instanceof $n&&(typeof T.nodeName!="string"||typeof T.textContent!="string"||typeof T.removeChild!="function"||!(T.attributes instanceof gr)||typeof T.removeAttribute!="function"||typeof T.setAttribute!="function"||typeof T.namespaceURI!="string"||typeof T.insertBefore!="function")},Hr=function(T){return s(Be)==="object"?T instanceof Be:T&&s(T)==="object"&&typeof T.nodeType=="number"&&typeof T.nodeName=="string"},Xt=function(T,ee,X){yt[T]&&Q(yt[T],function(We){We.call(V,ee,X,Fr)})},oi=function(T){var ee;if(Xt("beforeSanitizeElements",T,null),Uo(T)||B(/[\u0080-\uFFFF]/,T.nodeName))return Zt(T),!0;var X=ir(T.nodeName);if(Xt("uponSanitizeElement",T,{tagName:X,allowedTags:ft}),T.hasChildNodes()&&!Hr(T.firstElementChild)&&(!Hr(T.content)||!Hr(T.content.firstElementChild))&&B(/<[/\w]/g,T.innerHTML)&&B(/<[/\w]/g,T.textContent)||X==="select"&&B(/<template/i,T.innerHTML))return Zt(T),!0;if(!ft[X]||Wr[X]){if(!Wr[X]&&ai(X)&&(Je.tagNameCheck instanceof RegExp&&B(Je.tagNameCheck,X)||Je.tagNameCheck instanceof Function&&Je.tagNameCheck(X)))return!1;if(sn&&!Rr[X]){var We=kr(T)||T.parentNode,it=Ro(T)||T.childNodes;if(it&&We)for(var bt=it.length-1;bt>=0;--bt)We.insertBefore(Pi(it[bt],!0),Ri(T))}return Zt(T),!0}return T instanceof re&&!$o(T)?(Zt(T),!0):X!=="noscript"&&X!=="noembed"||!B(/<\/no(script|embed)/i,T.innerHTML)?(Dr&&T.nodeType===3&&(ee=T.textContent,ee=le(ee,zn," "),ee=le(ee,Bn," "),T.textContent!==ee&&(J(V.removed,{element:T.cloneNode()}),T.textContent=ee)),Xt("afterSanitizeElements",T,null),!1):(Zt(T),!0)},Vi=function(T,ee,X){if(Jn&&(ee==="id"||ee==="name")&&(X in ge||X in jo))return!1;if(!(Zn&&!Yn[ee]&&B(an,ee))){if(!(Kn&&B($t,ee))){if(!pt[ee]||Yn[ee]){if(!(ai(T)&&(Je.tagNameCheck instanceof RegExp&&B(Je.tagNameCheck,T)||Je.tagNameCheck instanceof Function&&Je.tagNameCheck(T))&&(Je.attributeNameCheck instanceof RegExp&&B(Je.attributeNameCheck,ee)||Je.attributeNameCheck instanceof Function&&Je.attributeNameCheck(ee))||ee==="is"&&Je.allowCustomizedBuiltInElements&&(Je.tagNameCheck instanceof RegExp&&B(Je.tagNameCheck,X)||Je.tagNameCheck instanceof Function&&Je.tagNameCheck(X))))return!1}else if(!ei[ee]){if(!B(qn,le(X,Br,""))){if((ee!=="src"&&ee!=="xlink:href"&&ee!=="href"||T==="script"||D(X,"data:")!==0||!Ni[T])&&!($i&&!B(Wn,le(X,Br,"")))){if(X)return!1}}}}}return!0},ai=function(T){return T.indexOf("-")>0},Vr=function(T){var ee,X,We,it;Xt("beforeSanitizeAttributes",T,null);var bt=T.attributes;if(bt){var wt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:pt};for(it=bt.length;it--;){var Yr=ee=bt[it],Qt=Yr.name,De=Yr.namespaceURI;if(X=Qt==="value"?ee.value:U(ee.value),We=ir(Qt),wt.attrName=We,wt.attrValue=X,wt.keepAttr=!0,wt.forceKeepAttr=void 0,Xt("uponSanitizeAttribute",T,wt),X=wt.attrValue,!wt.forceKeepAttr&&(qi(Qt,T),wt.keepAttr))if(B(/\/>/i,X))qi(Qt,T);else{Dr&&(X=le(X,zn," "),X=le(X,Bn," "));var yr=ir(T.nodeName);if(Vi(yr,We,X))try{De?T.setAttributeNS(De,Qt,X):T.setAttribute(Qt,X),pe(V.removed)}catch{}}}Xt("afterSanitizeAttributes",T,null)}},si=function T(ee){var X,We=qr(ee);for(Xt("beforeSanitizeShadowDOM",ee,null);X=We.nextNode();)Xt("uponSanitizeShadowNode",X,null),oi(X)||(X.content instanceof Re&&T(X.content),Vr(X));Xt("afterSanitizeShadowDOM",ee,null)};return V.sanitize=function(T,ee){var X,We,it,bt,wt;if((zi=!T)&&(T="<!-->"),typeof T!="string"&&!Hr(T)){if(typeof T.toString!="function")throw I("toString is not a function");if(typeof(T=T.toString())!="string")throw I("dirty is not a string, aborting")}if(!V.isSupported){if(s(q.toStaticHTML)==="object"||typeof q.toStaticHTML=="function"){if(typeof T=="string")return q.toStaticHTML(T);if(Hr(T))return q.toStaticHTML(T.outerHTML)}return T}if(Xn||ri(ee),V.removed=[],typeof T=="string"&&(mr=!1),mr){if(T.nodeName){var Yr=ir(T.nodeName);if(!ft[Yr]||Wr[Yr])throw I("root node is forbidden and cannot be sanitized in-place")}}else if(T instanceof Be)(We=(X=Hi("<!---->")).ownerDocument.importNode(T,!0)).nodeType===1&&We.nodeName==="BODY"||We.nodeName==="HTML"?X=We:X.appendChild(We);else{if(!vr&&!Dr&&!Fe&&T.indexOf("<")===-1)return nr&&Pr?nr.createHTML(T):T;if(!(X=Hi(T)))return vr?null:Pr?Fi:""}X&&Qn&&Zt(X.firstChild);for(var Qt=qr(mr?T:X);it=Qt.nextNode();)it.nodeType===3&&it===bt||oi(it)||(it.content instanceof Re&&si(it.content),Vr(it),bt=it);if(bt=null,mr)return T;if(vr){if(or)for(wt=ji.call(X.ownerDocument);X.firstChild;)wt.appendChild(X.firstChild);else wt=X;return pt.shadowroot&&(wt=Mn.call(ae,wt,!0)),wt}var De=Fe?X.outerHTML:X.innerHTML;return Fe&&ft["!doctype"]&&X.ownerDocument&&X.ownerDocument.doctype&&X.ownerDocument.doctype.name&&B(kt,X.ownerDocument.doctype.name)&&(De="<!DOCTYPE "+X.ownerDocument.doctype.name+`>
`+De),Dr&&(De=le(De,zn," "),De=le(De,Bn," ")),nr&&Pr?nr.createHTML(De):De},V.setConfig=function(T){ri(T),Xn=!0},V.clearConfig=function(){Fr=null,Xn=!1},V.isValidAttribute=function(T,ee,X){Fr||ri({});var We=ir(T),it=ir(ee);return Vi(We,it,X)},V.addHook=function(T,ee){typeof ee=="function"&&(yt[T]=yt[T]||[],J(yt[T],ee))},V.removeHook=function(T){if(yt[T])return pe(yt[T])},V.removeHooks=function(T){yt[T]&&(yt[T]=[])},V.removeAllHooks=function(){yt={}},V}return Et()}()},729:a=>{var s=Object.prototype.hasOwnProperty,c="~";function l(){}function f(m,E,S){this.fn=m,this.context=E,this.once=S||!1}function p(m,E,S,C,L){if(typeof S!="function")throw new TypeError("The listener must be a function");var O=new f(S,C||m,L),x=c?c+E:E;return m._events[x]?m._events[x].fn?m._events[x]=[m._events[x],O]:m._events[x].push(O):(m._events[x]=O,m._eventsCount++),m}function g(m,E){--m._eventsCount==0?m._events=new l:delete m._events[E]}function v(){this._events=new l,this._eventsCount=0}Object.create&&(l.prototype=Object.create(null),new l().__proto__||(c=!1)),v.prototype.eventNames=function(){var m,E,S=[];if(this._eventsCount===0)return S;for(E in m=this._events)s.call(m,E)&&S.push(c?E.slice(1):E);return Object.getOwnPropertySymbols?S.concat(Object.getOwnPropertySymbols(m)):S},v.prototype.listeners=function(m){var E=c?c+m:m,S=this._events[E];if(!S)return[];if(S.fn)return[S.fn];for(var C=0,L=S.length,O=new Array(L);C<L;C++)O[C]=S[C].fn;return O},v.prototype.listenerCount=function(m){var E=c?c+m:m,S=this._events[E];return S?S.fn?1:S.length:0},v.prototype.emit=function(m,E,S,C,L,O){var x=c?c+m:m;if(!this._events[x])return!1;var A,R,b=this._events[x],_=arguments.length;if(b.fn){switch(b.once&&this.removeListener(m,b.fn,void 0,!0),_){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,E),!0;case 3:return b.fn.call(b.context,E,S),!0;case 4:return b.fn.call(b.context,E,S,C),!0;case 5:return b.fn.call(b.context,E,S,C,L),!0;case 6:return b.fn.call(b.context,E,S,C,L,O),!0}for(R=1,A=new Array(_-1);R<_;R++)A[R-1]=arguments[R];b.fn.apply(b.context,A)}else{var w,$=b.length;for(R=0;R<$;R++)switch(b[R].once&&this.removeListener(m,b[R].fn,void 0,!0),_){case 1:b[R].fn.call(b[R].context);break;case 2:b[R].fn.call(b[R].context,E);break;case 3:b[R].fn.call(b[R].context,E,S);break;case 4:b[R].fn.call(b[R].context,E,S,C);break;default:if(!A)for(w=1,A=new Array(_-1);w<_;w++)A[w-1]=arguments[w];b[R].fn.apply(b[R].context,A)}}return!0},v.prototype.on=function(m,E,S){return p(this,m,E,S,!1)},v.prototype.once=function(m,E,S){return p(this,m,E,S,!0)},v.prototype.removeListener=function(m,E,S,C){var L=c?c+m:m;if(!this._events[L])return this;if(!E)return g(this,L),this;var O=this._events[L];if(O.fn)O.fn!==E||C&&!O.once||S&&O.context!==S||g(this,L);else{for(var x=0,A=[],R=O.length;x<R;x++)(O[x].fn!==E||C&&!O[x].once||S&&O[x].context!==S)&&A.push(O[x]);A.length?this._events[L]=A.length===1?A[0]:A:g(this,L)}return this},v.prototype.removeAllListeners=function(m){var E;return m?(E=c?c+m:m,this._events[E]&&g(this,E)):(this._events=new l,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=c,v.EventEmitter=v,a.exports=v},717:a=>{typeof Object.create=="function"?a.exports=function(s,c){s.super_=c,s.prototype=Object.create(c.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(s,c){s.super_=c;var l=function(){};l.prototype=c.prototype,s.prototype=new l,s.prototype.constructor=s}},824:a=>{var s=1e3,c=60*s,l=60*c,f=24*l,p=7*f,g=365.25*f;function v(m,E,S,C){var L=E>=1.5*S;return Math.round(m/S)+" "+C+(L?"s":"")}a.exports=function(m,E){E=E||{};var S=typeof m;if(S==="string"&&m.length>0)return function(C){if(!((C=String(C)).length>100)){var L=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(C);if(!!L){var O=parseFloat(L[1]);switch((L[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return O*g;case"weeks":case"week":case"w":return O*p;case"days":case"day":case"d":return O*f;case"hours":case"hour":case"hrs":case"hr":case"h":return O*l;case"minutes":case"minute":case"mins":case"min":case"m":return O*c;case"seconds":case"second":case"secs":case"sec":case"s":return O*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return O;default:return}}}}(m);if(S==="number"&&isFinite(m))return E.long?function(C){var L=Math.abs(C);return L>=f?v(C,L,f,"day"):L>=l?v(C,L,l,"hour"):L>=c?v(C,L,c,"minute"):L>=s?v(C,L,s,"second"):C+" ms"}(m):function(C){var L=Math.abs(C);return L>=f?Math.round(C/f)+"d":L>=l?Math.round(C/l)+"h":L>=c?Math.round(C/c)+"m":L>=s?Math.round(C/s)+"s":C+"ms"}(m);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(m))}},520:(a,s,c)=>{var l=c(155),f=l.platform==="win32",p=c(539);function g(b,_){for(var w=[],$=0;$<b.length;$++){var M=b[$];M&&M!=="."&&(M===".."?w.length&&w[w.length-1]!==".."?w.pop():_&&w.push(".."):w.push(M))}return w}function v(b){for(var _=b.length-1,w=0;w<=_&&!b[w];w++);for(var $=_;$>=0&&!b[$];$--);return w===0&&$===_?b:w>$?[]:b.slice(w,$+1)}var m=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,E=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,S={};function C(b){var _=m.exec(b),w=(_[1]||"")+(_[2]||""),$=_[3]||"",M=E.exec($);return[w,M[1],M[2],M[3]]}function L(b){var _=m.exec(b),w=_[1]||"",$=!!w&&w[1]!==":";return{device:w,isUnc:$,isAbsolute:$||!!_[2],tail:_[3]}}function O(b){return"\\\\"+b.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}S.resolve=function(){for(var b="",_="",w=!1,$=arguments.length-1;$>=-1;$--){var M;if($>=0?M=arguments[$]:b?(M=l.env["="+b])&&M.substr(0,3).toLowerCase()===b.toLowerCase()+"\\"||(M=b+"\\"):M=l.cwd(),!p.isString(M))throw new TypeError("Arguments to path.resolve must be strings");if(M){var Q=L(M),pe=Q.device,J=Q.isUnc,Te=Q.isAbsolute,Ve=Q.tail;if((!pe||!b||pe.toLowerCase()===b.toLowerCase())&&(b||(b=pe),w||(_=Ve+"\\"+_,w=Te),b&&w))break}}return J&&(b=O(b)),b+(w?"\\":"")+(_=g(_.split(/[\\\/]+/),!w).join("\\"))||"."},S.normalize=function(b){var _=L(b),w=_.device,$=_.isUnc,M=_.isAbsolute,Q=_.tail,pe=/[\\\/]$/.test(Q);return(Q=g(Q.split(/[\\\/]+/),!M).join("\\"))||M||(Q="."),Q&&pe&&(Q+="\\"),$&&(w=O(w)),w+(M?"\\":"")+Q},S.isAbsolute=function(b){return L(b).isAbsolute},S.join=function(){for(var b=[],_=0;_<arguments.length;_++){var w=arguments[_];if(!p.isString(w))throw new TypeError("Arguments to path.join must be strings");w&&b.push(w)}var $=b.join("\\");return/^[\\\/]{2}[^\\\/]/.test(b[0])||($=$.replace(/^[\\\/]{2,}/,"\\")),S.normalize($)},S.relative=function(b,_){b=S.resolve(b),_=S.resolve(_);for(var w=b.toLowerCase(),$=_.toLowerCase(),M=v(_.split("\\")),Q=v(w.split("\\")),pe=v($.split("\\")),J=Math.min(Q.length,pe.length),Te=J,Ve=0;Ve<J;Ve++)if(Q[Ve]!==pe[Ve]){Te=Ve;break}if(Te==0)return _;var le=[];for(Ve=Te;Ve<Q.length;Ve++)le.push("..");return(le=le.concat(M.slice(Te))).join("\\")},S._makeLong=function(b){if(!p.isString(b))return b;if(!b)return"";var _=S.resolve(b);return/^[a-zA-Z]\:\\/.test(_)?"\\\\?\\"+_:/^\\\\[^?.]/.test(_)?"\\\\?\\UNC\\"+_.substring(2):b},S.dirname=function(b){var _=C(b),w=_[0],$=_[1];return w||$?($&&($=$.substr(0,$.length-1)),w+$):"."},S.basename=function(b,_){var w=C(b)[2];return _&&w.substr(-1*_.length)===_&&(w=w.substr(0,w.length-_.length)),w},S.extname=function(b){return C(b)[3]},S.format=function(b){if(!p.isObject(b))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof b);var _=b.root||"";if(!p.isString(_))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof b.root);var w=b.dir,$=b.base||"";return w?w[w.length-1]===S.sep?w+$:w+S.sep+$:$},S.parse=function(b){if(!p.isString(b))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof b);var _=C(b);if(!_||_.length!==4)throw new TypeError("Invalid path '"+b+"'");return{root:_[0],dir:_[0]+_[1].slice(0,-1),base:_[2],ext:_[3],name:_[2].slice(0,_[2].length-_[3].length)}},S.sep="\\",S.delimiter=";";var x=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,A={};function R(b){return x.exec(b).slice(1)}A.resolve=function(){for(var b="",_=!1,w=arguments.length-1;w>=-1&&!_;w--){var $=w>=0?arguments[w]:l.cwd();if(!p.isString($))throw new TypeError("Arguments to path.resolve must be strings");$&&(b=$+"/"+b,_=$[0]==="/")}return(_?"/":"")+(b=g(b.split("/"),!_).join("/"))||"."},A.normalize=function(b){var _=A.isAbsolute(b),w=b&&b[b.length-1]==="/";return(b=g(b.split("/"),!_).join("/"))||_||(b="."),b&&w&&(b+="/"),(_?"/":"")+b},A.isAbsolute=function(b){return b.charAt(0)==="/"},A.join=function(){for(var b="",_=0;_<arguments.length;_++){var w=arguments[_];if(!p.isString(w))throw new TypeError("Arguments to path.join must be strings");w&&(b+=b?"/"+w:w)}return A.normalize(b)},A.relative=function(b,_){b=A.resolve(b).substr(1),_=A.resolve(_).substr(1);for(var w=v(b.split("/")),$=v(_.split("/")),M=Math.min(w.length,$.length),Q=M,pe=0;pe<M;pe++)if(w[pe]!==$[pe]){Q=pe;break}var J=[];for(pe=Q;pe<w.length;pe++)J.push("..");return(J=J.concat($.slice(Q))).join("/")},A._makeLong=function(b){return b},A.dirname=function(b){var _=R(b),w=_[0],$=_[1];return w||$?($&&($=$.substr(0,$.length-1)),w+$):"."},A.basename=function(b,_){var w=R(b)[2];return _&&w.substr(-1*_.length)===_&&(w=w.substr(0,w.length-_.length)),w},A.extname=function(b){return R(b)[3]},A.format=function(b){if(!p.isObject(b))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof b);var _=b.root||"";if(!p.isString(_))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof b.root);return(b.dir?b.dir+A.sep:"")+(b.base||"")},A.parse=function(b){if(!p.isString(b))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof b);var _=R(b);if(!_||_.length!==4)throw new TypeError("Invalid path '"+b+"'");return _[1]=_[1]||"",_[2]=_[2]||"",_[3]=_[3]||"",{root:_[0],dir:_[0]+_[1].slice(0,-1),base:_[2],ext:_[3],name:_[2].slice(0,_[2].length-_[3].length)}},A.sep="/",A.delimiter=":",a.exports=f?S:A,a.exports.posix=A,a.exports.win32=S},155:a=>{var s,c,l=a.exports={};function f(){throw new Error("setTimeout has not been defined")}function p(){throw new Error("clearTimeout has not been defined")}function g(A){if(s===setTimeout)return setTimeout(A,0);if((s===f||!s)&&setTimeout)return s=setTimeout,setTimeout(A,0);try{return s(A,0)}catch{try{return s.call(null,A,0)}catch{return s.call(this,A,0)}}}(function(){try{s=typeof setTimeout=="function"?setTimeout:f}catch{s=f}try{c=typeof clearTimeout=="function"?clearTimeout:p}catch{c=p}})();var v,m=[],E=!1,S=-1;function C(){E&&v&&(E=!1,v.length?m=v.concat(m):S=-1,m.length&&L())}function L(){if(!E){var A=g(C);E=!0;for(var R=m.length;R;){for(v=m,m=[];++S<R;)v&&v[S].run();S=-1,R=m.length}v=null,E=!1,function(b){if(c===clearTimeout)return clearTimeout(b);if((c===p||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(b);try{c(b)}catch{try{return c.call(null,b)}catch{return c.call(this,b)}}}(A)}}function O(A,R){this.fun=A,this.array=R}function x(){}l.nextTick=function(A){var R=new Array(arguments.length-1);if(arguments.length>1)for(var b=1;b<arguments.length;b++)R[b-1]=arguments[b];m.push(new O(A,R)),m.length!==1||E||g(L)},O.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=x,l.addListener=x,l.once=x,l.off=x,l.removeListener=x,l.removeAllListeners=x,l.emit=x,l.prependListener=x,l.prependOnceListener=x,l.listeners=function(A){return[]},l.binding=function(A){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(A){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},384:a=>{a.exports=function(s){return s&&typeof s=="object"&&typeof s.copy=="function"&&typeof s.fill=="function"&&typeof s.readUInt8=="function"}},539:(a,s,c)=>{var l=c(155),f=/%[sdj%]/g;s.format=function(U){if(!b(U)){for(var B=[],I=0;I<arguments.length;I++)B.push(v(arguments[I]));return B.join(" ")}I=1;for(var P=arguments,fe=P.length,K=String(U).replace(f,function(Pe){if(Pe==="%%")return"%";if(I>=fe)return Pe;switch(Pe){case"%s":return String(P[I++]);case"%d":return Number(P[I++]);case"%j":try{return JSON.stringify(P[I++])}catch{return"[Circular]"}default:return Pe}}),he=P[I];I<fe;he=P[++I])A(he)||!$(he)?K+=" "+he:K+=" "+v(he);return K},s.deprecate=function(U,B){if(_(c.g.process))return function(){return s.deprecate(U,B).apply(this,arguments)};if(l.noDeprecation===!0)return U;var I=!1;return function(){if(!I){if(l.throwDeprecation)throw new Error(B);l.traceDeprecation?console.trace(B):console.error(B),I=!0}return U.apply(this,arguments)}};var p,g={};function v(U,B){var I={seen:[],stylize:E};return arguments.length>=3&&(I.depth=arguments[2]),arguments.length>=4&&(I.colors=arguments[3]),x(B)?I.showHidden=B:B&&s._extend(I,B),_(I.showHidden)&&(I.showHidden=!1),_(I.depth)&&(I.depth=2),_(I.colors)&&(I.colors=!1),_(I.customInspect)&&(I.customInspect=!0),I.colors&&(I.stylize=m),S(I,U,I.depth)}function m(U,B){var I=v.styles[B];return I?"\x1B["+v.colors[I][0]+"m"+U+"\x1B["+v.colors[I][1]+"m":U}function E(U,B){return U}function S(U,B,I){if(U.customInspect&&B&&pe(B.inspect)&&B.inspect!==s.inspect&&(!B.constructor||B.constructor.prototype!==B)){var P=B.inspect(I,U);return b(P)||(P=S(U,P,I)),P}var fe=function(Ke,Oe){if(_(Oe))return Ke.stylize("undefined","undefined");if(b(Oe)){var tt="'"+JSON.stringify(Oe).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Ke.stylize(tt,"string")}if(R(Oe))return Ke.stylize(""+Oe,"number");if(x(Oe))return Ke.stylize(""+Oe,"boolean");if(A(Oe))return Ke.stylize("null","null")}(U,B);if(fe)return fe;var K=Object.keys(B),he=function(Ke){var Oe={};return Ke.forEach(function(tt,rt){Oe[tt]=!0}),Oe}(K);if(U.showHidden&&(K=Object.getOwnPropertyNames(B)),Q(B)&&(K.indexOf("message")>=0||K.indexOf("description")>=0))return C(B);if(K.length===0){if(pe(B)){var Pe=B.name?": "+B.name:"";return U.stylize("[Function"+Pe+"]","special")}if(w(B))return U.stylize(RegExp.prototype.toString.call(B),"regexp");if(M(B))return U.stylize(Date.prototype.toString.call(B),"date");if(Q(B))return C(B)}var Ce,ie="",St=!1,Ne=["{","}"];return O(B)&&(St=!0,Ne=["[","]"]),pe(B)&&(ie=" [Function"+(B.name?": "+B.name:"")+"]"),w(B)&&(ie=" "+RegExp.prototype.toString.call(B)),M(B)&&(ie=" "+Date.prototype.toUTCString.call(B)),Q(B)&&(ie=" "+C(B)),K.length!==0||St&&B.length!=0?I<0?w(B)?U.stylize(RegExp.prototype.toString.call(B),"regexp"):U.stylize("[Object]","special"):(U.seen.push(B),Ce=St?function(Ke,Oe,tt,rt,ye){for(var be=[],_e=0,ut=Oe.length;_e<ut;++_e)D(Oe,String(_e))?be.push(L(Ke,Oe,tt,rt,String(_e),!0)):be.push("");return ye.forEach(function(ce){ce.match(/^\d+$/)||be.push(L(Ke,Oe,tt,rt,ce,!0))}),be}(U,B,I,he,K):K.map(function(Ke){return L(U,B,I,he,Ke,St)}),U.seen.pop(),function(Ke,Oe,tt){return Ke.reduce(function(rt,ye){return ye.indexOf(`
`)>=0,rt+ye.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?tt[0]+(Oe===""?"":Oe+`
 `)+" "+Ke.join(`,
  `)+" "+tt[1]:tt[0]+Oe+" "+Ke.join(", ")+" "+tt[1]}(Ce,ie,Ne)):Ne[0]+ie+Ne[1]}function C(U){return"["+Error.prototype.toString.call(U)+"]"}function L(U,B,I,P,fe,K){var he,Pe,Ce;if((Ce=Object.getOwnPropertyDescriptor(B,fe)||{value:B[fe]}).get?Pe=Ce.set?U.stylize("[Getter/Setter]","special"):U.stylize("[Getter]","special"):Ce.set&&(Pe=U.stylize("[Setter]","special")),D(P,fe)||(he="["+fe+"]"),Pe||(U.seen.indexOf(Ce.value)<0?(Pe=A(I)?S(U,Ce.value,null):S(U,Ce.value,I-1)).indexOf(`
`)>-1&&(Pe=K?Pe.split(`
`).map(function(ie){return"  "+ie}).join(`
`).substr(2):`
`+Pe.split(`
`).map(function(ie){return"   "+ie}).join(`
`)):Pe=U.stylize("[Circular]","special")),_(he)){if(K&&fe.match(/^\d+$/))return Pe;(he=JSON.stringify(""+fe)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(he=he.substr(1,he.length-2),he=U.stylize(he,"name")):(he=he.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),he=U.stylize(he,"string"))}return he+": "+Pe}function O(U){return Array.isArray(U)}function x(U){return typeof U=="boolean"}function A(U){return U===null}function R(U){return typeof U=="number"}function b(U){return typeof U=="string"}function _(U){return U===void 0}function w(U){return $(U)&&J(U)==="[object RegExp]"}function $(U){return typeof U=="object"&&U!==null}function M(U){return $(U)&&J(U)==="[object Date]"}function Q(U){return $(U)&&(J(U)==="[object Error]"||U instanceof Error)}function pe(U){return typeof U=="function"}function J(U){return Object.prototype.toString.call(U)}function Te(U){return U<10?"0"+U.toString(10):U.toString(10)}s.debuglog=function(U){if(_(p)&&(p=l.env.NODE_DEBUG||""),U=U.toUpperCase(),!g[U])if(new RegExp("\\b"+U+"\\b","i").test(p)){var B=l.pid;g[U]=function(){var I=s.format.apply(s,arguments);console.error("%s %d: %s",U,B,I)}}else g[U]=function(){};return g[U]},s.inspect=v,v.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},v.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},s.isArray=O,s.isBoolean=x,s.isNull=A,s.isNullOrUndefined=function(U){return U==null},s.isNumber=R,s.isString=b,s.isSymbol=function(U){return typeof U=="symbol"},s.isUndefined=_,s.isRegExp=w,s.isObject=$,s.isDate=M,s.isError=Q,s.isFunction=pe,s.isPrimitive=function(U){return U===null||typeof U=="boolean"||typeof U=="number"||typeof U=="string"||typeof U=="symbol"||U===void 0},s.isBuffer=c(384);var Ve=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function le(){var U=new Date,B=[Te(U.getHours()),Te(U.getMinutes()),Te(U.getSeconds())].join(":");return[U.getDate(),Ve[U.getMonth()],B].join(" ")}function D(U,B){return Object.prototype.hasOwnProperty.call(U,B)}s.log=function(){console.log("%s - %s",le(),s.format.apply(s,arguments))},s.inherits=c(717),s._extend=function(U,B){if(!B||!$(B))return U;for(var I=Object.keys(B),P=I.length;P--;)U[I[P]]=B[I[P]];return U}}},r={};function i(a){var s=r[a];if(s!==void 0)return s.exports;var c=r[a]={exports:{}};return e[a].call(c.exports,c,c.exports,i),c.exports}i.n=a=>{var s=a&&a.__esModule?()=>a.default:()=>a;return i.d(s,{a:s}),s},i.d=(a,s)=>{for(var c in s)i.o(s,c)&&!i.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:s[c]})},i.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),i.o=(a,s)=>Object.prototype.hasOwnProperty.call(a,s),i.r=a=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var o={};return(()=>{i.r(o),i.d(o,{LSPluginUser:()=>Qo,setupPluginUserInstance:()=>ks});var a=i(520);i(856);const s=function(){this.__data__=[],this.size=0},c=function(h,u){return h===u||h!=h&&u!=u},l=function(h,u){for(var d=h.length;d--;)if(c(h[d][0],u))return d;return-1};var f=Array.prototype.splice;const p=function(h){var u=this.__data__,d=l(u,h);return!(d<0)&&(d==u.length-1?u.pop():f.call(u,d,1),--this.size,!0)},g=function(h){var u=this.__data__,d=l(u,h);return d<0?void 0:u[d][1]},v=function(h){return l(this.__data__,h)>-1},m=function(h,u){var d=this.__data__,y=l(d,h);return y<0?(++this.size,d.push([h,u])):d[y][1]=u,this};function E(h){var u=-1,d=h==null?0:h.length;for(this.clear();++u<d;){var y=h[u];this.set(y[0],y[1])}}E.prototype.clear=s,E.prototype.delete=p,E.prototype.get=g,E.prototype.has=v,E.prototype.set=m;const S=E,C=function(){this.__data__=new S,this.size=0},L=function(h){var u=this.__data__,d=u.delete(h);return this.size=u.size,d},O=function(h){return this.__data__.get(h)},x=function(h){return this.__data__.has(h)},A=typeof Y=="object"&&Y&&Y.Object===Object&&Y;var R=typeof self=="object"&&self&&self.Object===Object&&self;const b=A||R||Function("return this")(),_=b.Symbol;var w=Object.prototype,$=w.hasOwnProperty,M=w.toString,Q=_?_.toStringTag:void 0;const pe=function(h){var u=$.call(h,Q),d=h[Q];try{h[Q]=void 0;var y=!0}catch{}var k=M.call(h);return y&&(u?h[Q]=d:delete h[Q]),k};var J=Object.prototype.toString;const Te=function(h){return J.call(h)};var Ve=_?_.toStringTag:void 0;const le=function(h){return h==null?h===void 0?"[object Undefined]":"[object Null]":Ve&&Ve in Object(h)?pe(h):Te(h)},D=function(h){var u=typeof h;return h!=null&&(u=="object"||u=="function")},U=function(h){if(!D(h))return!1;var u=le(h);return u=="[object Function]"||u=="[object GeneratorFunction]"||u=="[object AsyncFunction]"||u=="[object Proxy]"},B=b["__core-js_shared__"];var I,P=(I=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||""))?"Symbol(src)_1."+I:"";const fe=function(h){return!!P&&P in h};var K=Function.prototype.toString;const he=function(h){if(h!=null){try{return K.call(h)}catch{}try{return h+""}catch{}}return""};var Pe=/^\[object .+?Constructor\]$/,Ce=Function.prototype,ie=Object.prototype,St=Ce.toString,Ne=ie.hasOwnProperty,Ke=RegExp("^"+St.call(Ne).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Oe=function(h){return!(!D(h)||fe(h))&&(U(h)?Ke:Pe).test(he(h))},tt=function(h,u){return h==null?void 0:h[u]},rt=function(h,u){var d=tt(h,u);return Oe(d)?d:void 0},ye=rt(b,"Map"),be=rt(Object,"create"),_e=function(){this.__data__=be?be(null):{},this.size=0},ut=function(h){var u=this.has(h)&&delete this.__data__[h];return this.size-=u?1:0,u};var ce=Object.prototype.hasOwnProperty;const de=function(h){var u=this.__data__;if(be){var d=u[h];return d==="__lodash_hash_undefined__"?void 0:d}return ce.call(u,h)?u[h]:void 0};var G=Object.prototype.hasOwnProperty;const vt=function(h){var u=this.__data__;return be?u[h]!==void 0:G.call(u,h)},Ct=function(h,u){var d=this.__data__;return this.size+=this.has(h)?0:1,d[h]=be&&u===void 0?"__lodash_hash_undefined__":u,this};function ht(h){var u=-1,d=h==null?0:h.length;for(this.clear();++u<d;){var y=h[u];this.set(y[0],y[1])}}ht.prototype.clear=_e,ht.prototype.delete=ut,ht.prototype.get=de,ht.prototype.has=vt,ht.prototype.set=Ct;const kt=ht,mt=function(){this.size=0,this.__data__={hash:new kt,map:new(ye||S),string:new kt}},Qe=function(h){var u=typeof h;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?h!=="__proto__":h===null},Et=function(h,u){var d=h.__data__;return Qe(u)?d[typeof u=="string"?"string":"hash"]:d.map},q=function(h){var u=Et(this,h).delete(h);return this.size-=u?1:0,u},V=function(h){return Et(this,h).get(h)},ae=function(h){return Et(this,h).has(h)},ge=function(h,u){var d=Et(this,h),y=d.size;return d.set(h,u),this.size+=d.size==y?0:1,this};function Re(h){var u=-1,d=h==null?0:h.length;for(this.clear();++u<d;){var y=h[u];this.set(y[0],y[1])}}Re.prototype.clear=mt,Re.prototype.delete=q,Re.prototype.get=V,Re.prototype.has=ae,Re.prototype.set=ge;const xe=Re,Be=function(h,u){var d=this.__data__;if(d instanceof S){var y=d.__data__;if(!ye||y.length<199)return y.push([h,u]),this.size=++d.size,this;d=this.__data__=new xe(y)}return d.set(h,u),this.size=d.size,this};function re(h){var u=this.__data__=new S(h);this.size=u.size}re.prototype.clear=C,re.prototype.delete=L,re.prototype.get=O,re.prototype.has=x,re.prototype.set=Be;const Ae=re,je=function(){try{var h=rt(Object,"defineProperty");return h({},"",{}),h}catch{}}(),gr=function(h,u,d){u=="__proto__"&&je?je(h,u,{configurable:!0,enumerable:!0,value:d,writable:!0}):h[u]=d},$n=function(h,u,d){(d!==void 0&&!c(h[u],d)||d===void 0&&!(u in h))&&gr(h,u,d)},xi=function(h){return function(u,d,y){for(var k=-1,F=Object(u),j=y(u),N=j.length;N--;){var W=j[h?N:++k];if(d(F[W],W,F)===!1)break}return u}}();var Di=t&&!t.nodeType&&t,Mr=Di&&!0&&n&&!n.nodeType&&n,Pi=Mr&&Mr.exports===Di?b.Buffer:void 0,Ri=Pi?Pi.allocUnsafe:void 0;const Ro=function(h,u){if(u)return h.slice();var d=h.length,y=Ri?Ri(d):new h.constructor(d);return h.copy(y),y},kr=b.Uint8Array,Un=function(h){var u=new h.constructor(h.byteLength);return new kr(u).set(new kr(h)),u},nr=function(h,u){var d=u?Un(h.buffer):h.buffer;return new h.constructor(d,h.byteOffset,h.length)},Fi=function(h,u){var d=-1,y=h.length;for(u||(u=Array(y));++d<y;)u[d]=h[d];return u};var zr=Object.create;const Nn=function(){function h(){}return function(u){if(!D(u))return{};if(zr)return zr(u);h.prototype=u;var d=new h;return h.prototype=void 0,d}}(),Ii=function(h,u){return function(d){return h(u(d))}},ji=Ii(Object.getPrototypeOf,Object);var Fo=Object.prototype;const Mn=function(h){var u=h&&h.constructor;return h===(typeof u=="function"&&u.prototype||Fo)},Gi=function(h){return typeof h.constructor!="function"||Mn(h)?{}:Nn(ji(h))},yt=function(h){return h!=null&&typeof h=="object"},xr=function(h){return yt(h)&&le(h)=="[object Arguments]"};var ir=Object.prototype,zn=ir.hasOwnProperty,Bn=ir.propertyIsEnumerable;const an=xr(function(){return arguments}())?xr:function(h){return yt(h)&&zn.call(h,"callee")&&!Bn.call(h,"callee")},$t=Array.isArray,Wn=function(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=9007199254740991},Br=function(h){return h!=null&&Wn(h.length)&&!U(h)},qn=function(h){return yt(h)&&Br(h)},ft=function(){return!1};var Hn=t&&!t.nodeType&&t,pt=Hn&&!0&&n&&!n.nodeType&&n,Vn=pt&&pt.exports===Hn?b.Buffer:void 0;const Je=(Vn?Vn.isBuffer:void 0)||ft;var Wr=Function.prototype,Yn=Object.prototype,Kn=Wr.toString,Zn=Yn.hasOwnProperty,$i=Kn.call(Object);const Dr=function(h){if(!yt(h)||le(h)!="[object Object]")return!1;var u=ji(h);if(u===null)return!0;var d=Zn.call(u,"constructor")&&u.constructor;return typeof d=="function"&&d instanceof d&&Kn.call(d)==$i};var Fe={};Fe["[object Float32Array]"]=Fe["[object Float64Array]"]=Fe["[object Int8Array]"]=Fe["[object Int16Array]"]=Fe["[object Int32Array]"]=Fe["[object Uint8Array]"]=Fe["[object Uint8ClampedArray]"]=Fe["[object Uint16Array]"]=Fe["[object Uint32Array]"]=!0,Fe["[object Arguments]"]=Fe["[object Array]"]=Fe["[object ArrayBuffer]"]=Fe["[object Boolean]"]=Fe["[object DataView]"]=Fe["[object Date]"]=Fe["[object Error]"]=Fe["[object Function]"]=Fe["[object Map]"]=Fe["[object Number]"]=Fe["[object Object]"]=Fe["[object RegExp]"]=Fe["[object Set]"]=Fe["[object String]"]=Fe["[object WeakMap]"]=!1;const Xn=function(h){return yt(h)&&Wn(h.length)&&!!Fe[le(h)]},Qn=function(h){return function(u){return h(u)}};var vr=t&&!t.nodeType&&t,or=vr&&!0&&n&&!n.nodeType&&n,Pr=or&&or.exports===vr&&A.process,Jn=function(){try{var h=or&&or.require&&or.require("util").types;return h||Pr&&Pr.binding&&Pr.binding("util")}catch{}}(),sn=Jn&&Jn.isTypedArray;const mr=sn?Qn(sn):Xn,ar=function(h,u){if((u!=="constructor"||typeof h[u]!="function")&&u!="__proto__")return h[u]};var Rr=Object.prototype.hasOwnProperty;const Ui=function(h,u,d){var y=h[u];Rr.call(h,u)&&c(y,d)&&(d!==void 0||u in h)||gr(h,u,d)},Ni=function(h,u,d,y){var k=!d;d||(d={});for(var F=-1,j=u.length;++F<j;){var N=u[F],W=y?y(d[N],h[N],N,d,h):void 0;W===void 0&&(W=h[N]),k?gr(d,N,W):Ui(d,N,W)}return d},Mi=function(h,u){for(var d=-1,y=Array(h);++d<h;)y[d]=u(d);return y};var ei=/^(?:0|[1-9]\d*)$/;const un=function(h,u){var d=typeof h;return!!(u=u==null?9007199254740991:u)&&(d=="number"||d!="symbol"&&ei.test(h))&&h>-1&&h%1==0&&h<u};var ti=Object.prototype.hasOwnProperty;const ln=function(h,u){var d=$t(h),y=!d&&an(h),k=!d&&!y&&Je(h),F=!d&&!y&&!k&&mr(h),j=d||y||k||F,N=j?Mi(h.length,String):[],W=N.length;for(var ne in h)!u&&!ti.call(h,ne)||j&&(ne=="length"||k&&(ne=="offset"||ne=="parent")||F&&(ne=="buffer"||ne=="byteLength"||ne=="byteOffset")||un(ne,W))||N.push(ne);return N},sr=function(h){var u=[];if(h!=null)for(var d in Object(h))u.push(d);return u};var cn=Object.prototype.hasOwnProperty;const zi=function(h){if(!D(h))return sr(h);var u=Mn(h),d=[];for(var y in h)(y!="constructor"||!u&&cn.call(h,y))&&d.push(y);return d},Bi=function(h){return Br(h)?ln(h,!0):zi(h)},Io=function(h){return Ni(h,Bi(h))},Fr=function(h,u,d,y,k,F,j){var N=ar(h,d),W=ar(u,d),ne=j.get(W);if(ne)$n(h,d,ne);else{var se=F?F(N,W,d+"",h,u,j):void 0,ue=se===void 0;if(ue){var me=$t(W),Le=!me&&Je(W),Ee=!me&&!Le&&mr(W);se=W,me||Le||Ee?$t(N)?se=N:qn(N)?se=Fi(N):Le?(ue=!1,se=Ro(W,!0)):Ee?(ue=!1,se=nr(W,!0)):se=[]:Dr(W)||an(W)?(se=N,an(N)?se=Io(N):D(N)&&!U(N)||(se=Gi(W))):ue=!1}ue&&(j.set(W,se),k(se,W,y,F,j),j.delete(W)),$n(h,d,se)}},jo=function h(u,d,y,k,F){u!==d&&xi(d,function(j,N){if(F||(F=new Ae),D(j))Fr(u,d,N,y,h,k,F);else{var W=k?k(ar(u,N),j,N+"",u,d,F):void 0;W===void 0&&(W=j),$n(u,N,W)}},Bi)},hn=function(h){return h},ri=function(h,u,d){switch(d.length){case 0:return h.call(u);case 1:return h.call(u,d[0]);case 2:return h.call(u,d[0],d[1]);case 3:return h.call(u,d[0],d[1],d[2])}return h.apply(u,d)};var ni=Math.max;const Wi=function(h,u,d){return u=ni(u===void 0?h.length-1:u,0),function(){for(var y=arguments,k=-1,F=ni(y.length-u,0),j=Array(F);++k<F;)j[k]=y[u+k];k=-1;for(var N=Array(u+1);++k<u;)N[k]=y[k];return N[u]=d(j),ri(h,this,N)}},Go=function(h){return function(){return h}},dn=je?function(h,u){return je(h,"toString",{configurable:!0,enumerable:!1,value:Go(u),writable:!0})}:hn;var ii=Date.now;const $o=function(h){var u=0,d=0;return function(){var y=ii(),k=16-(y-d);if(d=y,k>0){if(++u>=800)return arguments[0]}else u=0;return h.apply(void 0,arguments)}}(dn),Zt=function(h,u){return $o(Wi(h,u,hn),h+"")},qi=function(h,u,d){if(!D(d))return!1;var y=typeof u;return!!(y=="number"?Br(d)&&un(u,d.length):y=="string"&&u in d)&&c(d[u],h)},Hi=function(h){return Zt(function(u,d){var y=-1,k=d.length,F=k>1?d[k-1]:void 0,j=k>2?d[2]:void 0;for(F=h.length>3&&typeof F=="function"?(k--,F):void 0,j&&qi(d[0],d[1],j)&&(F=k<3?void 0:F,k=1),u=Object(u);++y<k;){var N=d[y];N&&h(u,N,y,F)}return u})}(function(h,u,d){jo(h,u,d)});var qr=function(){return qr=Object.assign||function(h){for(var u,d=1,y=arguments.length;d<y;d++)for(var k in u=arguments[d])Object.prototype.hasOwnProperty.call(u,k)&&(h[k]=u[k]);return h},qr.apply(this,arguments)};function Uo(h){return h.toLowerCase()}var Hr=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],Xt=/[^A-Z0-9]+/gi;function oi(h,u,d){return u instanceof RegExp?h.replace(u,d):u.reduce(function(y,k){return y.replace(k,d)},h)}function Vi(h,u){return u===void 0&&(u={}),function(d,y){y===void 0&&(y={});for(var k=y.splitRegexp,F=k===void 0?Hr:k,j=y.stripRegexp,N=j===void 0?Xt:j,W=y.transform,ne=W===void 0?Uo:W,se=y.delimiter,ue=se===void 0?" ":se,me=oi(oi(d,F,"$1\0$2"),N,"\0"),Le=0,Ee=me.length;me.charAt(Le)==="\0";)Le++;for(;me.charAt(Ee-1)==="\0";)Ee--;return me.slice(Le,Ee).split("\0").map(ne).join(ue)}(h,qr({delimiter:"."},u))}var ai=i(729),Vr=i.n(ai);function si(h,u,d){return u in h?Object.defineProperty(h,u,{value:d,enumerable:!0,configurable:!0,writable:!0}):h[u]=d,h}const T=navigator.platform.toLowerCase()==="win32"?a.win32:a.posix,ee=function(h,u){return u===void 0&&(u={}),Vi(h,qr({delimiter:"_"},u))},X=Hi;class We extends Vr(){constructor(u,d){super(),si(this,"_tag",void 0),si(this,"_opts",void 0),si(this,"_logs",[]),this._tag=u,this._opts=d}write(u,d,y){var k;d!=null&&d.length&&d[d.length-1]===!0&&(y=!0,d.pop());const F=d.reduce((N,W)=>(W&&W instanceof Error?N+=`${W.message} ${W.stack}`:N+=W.toString(),N),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var j;this._logs.push([u,F]),(y||(k=this._opts)!==null&&k!==void 0&&k.console)&&((j=console)===null||j===void 0||j[u==="ERROR"?"error":"debug"](`${u}: ${F}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...u){this.write("INFO",u)}error(...u){this.write("ERROR",u)}warn(...u){this.write("WARN",u)}setTag(u){this._tag=u}toJSON(){return this._logs}}function it(h,...u){try{const d=new URL(h);if(!d.origin)throw new Error(null);const y=T.join(h.substr(d.origin.length),...u);return d.origin+y}catch{return T.join(h,...u)}}function bt(h,u){let d,y,k=!1;const F=N=>W=>{h&&clearTimeout(h),N(W),k=!0},j=new Promise((N,W)=>{d=F(N),y=F(W),h&&(h=setTimeout(()=>y(new Error(`[deferred timeout] ${u}`)),h))});return{created:Date.now(),setTag:N=>u=N,resolve:d,reject:y,promise:j,get settled(){return k}}}const wt=new Map;window.__injectedUIEffects=wt;var Yr=i(227),Qt=i.n(Yr);function De(h,u,d){return u in h?Object.defineProperty(h,u,{value:d,enumerable:!0,configurable:!0,writable:!0}):h[u]=d,h}const yr="application/x-postmate-v1+json";let Ja=0;const dc={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},No=(h,u)=>(typeof u!="string"||h.origin===u)&&!!h.data&&(typeof h.data!="object"||"postmate"in h.data)&&h.data.type===yr&&!!dc[h.data.postmate];class fc{constructor(u){De(this,"parent",void 0),De(this,"frame",void 0),De(this,"child",void 0),De(this,"events",{}),De(this,"childOrigin",void 0),De(this,"listener",void 0),this.parent=u.parent,this.frame=u.frame,this.child=u.child,this.childOrigin=u.childOrigin,this.listener=d=>{if(!No(d,this.childOrigin))return!1;const{data:y,name:k}=((d||{}).data||{}).value||{};d.data.postmate==="emit"&&k in this.events&&this.events[k].forEach(F=>{F.call(this,y)})},this.parent.addEventListener("message",this.listener,!1)}get(u,...d){return new Promise(y=>{const k=++Ja,F=j=>{j.data.uid===k&&j.data.postmate==="reply"&&(this.parent.removeEventListener("message",F,!1),y(j.data.value))};this.parent.addEventListener("message",F,!1),this.child.postMessage({postmate:"request",type:yr,property:u,args:d,uid:k},this.childOrigin)})}call(u,d){this.child.postMessage({postmate:"call",type:yr,property:u,data:d},this.childOrigin)}on(u,d){this.events[u]||(this.events[u]=[]),this.events[u].push(d)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class pc{constructor(u){De(this,"model",void 0),De(this,"parent",void 0),De(this,"parentOrigin",void 0),De(this,"child",void 0),this.model=u.model,this.parent=u.parent,this.parentOrigin=u.parentOrigin,this.child=u.child,this.child.addEventListener("message",d=>{if(!No(d,this.parentOrigin))return;const{property:y,uid:k,data:F,args:j}=d.data;d.data.postmate!=="call"?((N,W,ne)=>{const se=typeof N[W]=="function"?N[W].apply(null,ne):N[W];return Promise.resolve(se)})(this.model,y,j).then(N=>{d.source.postMessage({property:y,postmate:"reply",type:yr,uid:k,value:N},d.origin)}):y in this.model&&typeof this.model[y]=="function"&&this.model[y](F)})}emit(u,d){this.parent.postMessage({postmate:"emit",type:yr,value:{name:u,data:d}},this.parentOrigin)}}class Mo{constructor(u){De(this,"container",void 0),De(this,"parent",void 0),De(this,"frame",void 0),De(this,"child",void 0),De(this,"childOrigin",void 0),De(this,"url",void 0),De(this,"model",void 0),this.container=u.container,this.url=u.url,this.parent=window,this.frame=document.createElement("iframe"),u.id&&(this.frame.id=u.id),u.name&&(this.frame.name=u.name),this.frame.classList.add.apply(this.frame.classList,u.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=u.model||{}}sendHandshake(u){const d=(F=>{const j=document.createElement("a");j.href=F;const N=j.protocol.length>4?j.protocol:window.location.protocol,W=j.host.length?j.port==="80"||j.port==="443"?j.hostname:j.host:window.location.host;return j.origin||`${N}//${W}`})(u=u||this.url);let y,k=0;return new Promise((F,j)=>{const N=ne=>!!No(ne,d)&&(ne.data.postmate==="handshake-reply"?(clearInterval(y),this.parent.removeEventListener("message",N,!1),this.childOrigin=ne.origin,F(new fc(this))):j("Failed handshake"));this.parent.addEventListener("message",N,!1);const W=()=>{k++,this.child.postMessage({postmate:"handshake",type:yr,model:this.model},d),k===5&&clearInterval(y)};this.frame.addEventListener("load",()=>{W(),y=setInterval(W,500)}),this.frame.src=u})}destroy(){this.frame.parentNode.removeChild(this.frame)}}De(Mo,"debug",!1),De(Mo,"Model",void 0);class gc{constructor(u){De(this,"child",void 0),De(this,"model",void 0),De(this,"parent",void 0),De(this,"parentOrigin",void 0),this.child=window,this.model=u,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((u,d)=>{const y=k=>{if(k.data.postmate){if(k.data.postmate==="handshake"){this.child.removeEventListener("message",y,!1),k.source.postMessage({postmate:"handshake-reply",type:yr},k.origin),this.parentOrigin=k.origin;const F=k.data.model;return F&&Object.keys(F).forEach(j=>{this.model[j]=F[j]}),u(new pc(this))}return d("Handshake Reply Failed")}};this.child.addEventListener("message",y,!1)})}}function ui(h,u,d){return u in h?Object.defineProperty(h,u,{value:d,enumerable:!0,configurable:!0,writable:!0}):h[u]=d,h}const{importHTML:vc,createSandboxContainer:mc}=window.QSandbox||{};function yc(h,u){return h.startsWith("http")?fetch(h,u):(h=h.replace("file://",""),new Promise(async(d,y)=>{try{const k=await window.apis.doAction(["readFile",h]);d({text:()=>k})}catch(k){console.error(k),y(k)}}))}class bc extends Vr(){constructor(u){super(),ui(this,"_pluginLocal",void 0),ui(this,"_frame",void 0),ui(this,"_root",void 0),ui(this,"_loaded",!1),ui(this,"_unmountFns",[]),this._pluginLocal=u,u._dispose(()=>{this._unmount()})}async load(){const{name:u,entry:d}=this._pluginLocal.options;if(this.loaded||!d)return;const{template:y,execScripts:k}=await vc(d,{fetch:yc});this._mount(y,document.body);const F=mc(u,{elementGetter:()=>{var N;return(N=this._root)===null||N===void 0?void 0:N.firstChild}}).instance.proxy;F.__shadow_mode__=!0,F.LSPluginLocal=this._pluginLocal,F.LSPluginShadow=this,F.LSPluginUser=F.logseq=new Qo(this._pluginLocal.toJSON(),this._pluginLocal.caller);const j=await k(F,!0);this._unmountFns.push(j.unmount),this._loaded=!0}_mount(u,d){const y=this._frame=document.createElement("div");y.classList.add("lsp-shadow-sandbox"),y.id=this._pluginLocal.id,this._root=y.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${u}</div>`,d.appendChild(y),this.emit("mounted")}_unmount(){for(const u of this._unmountFns)u&&u.call(null)}destroy(){var u,d;(u=this.frame)===null||u===void 0||(d=u.parentNode)===null||d===void 0||d.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var u;return(u=this._root)===null||u===void 0?void 0:u.firstChild}get frame(){return this._frame}}function ur(h,u,d){return u in h?Object.defineProperty(h,u,{value:d,enumerable:!0,configurable:!0,writable:!0}):h[u]=d,h}const Ir=Qt()("LSPlugin:caller"),li="#await#response#",wc="#lspmsg#",es="#lspmsg#error#",Yi=h=>`#lspmsg#${h}`;class _c extends Vr(){constructor(u){super(),ur(this,"_pluginLocal",void 0),ur(this,"_connected",!1),ur(this,"_parent",void 0),ur(this,"_child",void 0),ur(this,"_shadow",void 0),ur(this,"_status",void 0),ur(this,"_userModel",{}),ur(this,"_call",void 0),ur(this,"_callUserModel",void 0),ur(this,"_debugTag",""),this._pluginLocal=u,u&&(this._debugTag=u.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:u}=this._pluginLocal;u?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(u={}){if(this._connected)return;const d=this,y=this._pluginLocal!=null;let k=0;const F=new Map,j=bt(6e4),N=this._extendUserModel(wr({"#lspmsg#ready#":async se=>{N[Yi(se==null?void 0:se.pid)]=({type:ue,payload:me})=>{Ir(`[host (_call) -> *user] ${this._debugTag}`,ue,me),d.emit(ue,me)},await j.resolve()},"#lspmsg#beforeunload#":async se=>{const ue=bt(1e4);d.emit("beforeunload",Object.assign({actor:ue},se)),await ue.promise},"#lspmsg#settings#":async({type:se,payload:ue})=>{d.emit("settings:changed",ue)},[wc]:async({ns:se,type:ue,payload:me})=>{Ir(`[host (async) -> *user] ${this._debugTag} ns=${se} type=${ue}`,me),se&&se.startsWith("hook")?d.emit(`${se}:${ue}`,me):d.emit(ue,me)},"#lspmsg#reply#":({_sync:se,result:ue})=>{if(Ir(`[sync host -> *user] #${se}`,ue),F.has(se)){const me=F.get(se);me&&(ue!=null&&ue.hasOwnProperty(es)?me.reject(ue[es]):me.resolve(ue),F.delete(se))}}},u));var W;if(y)return await j.promise,JSON.parse(JSON.stringify((W=this._pluginLocal)===null||W===void 0?void 0:W.toJSON()));const ne=new gc(N).sendHandshakeReply();return this._status="pending",await ne.then(se=>{this._child=se,this._connected=!0,this._call=async(ue,me={},Le)=>{if(Le){const Ee=++k;F.set(Ee,Le),me._sync=Ee,Le.setTag(`async call #${Ee}`),Ir(`async call #${Ee}`)}return se.emit(Yi(N.baseInfo.id),{type:ue,payload:me}),Le==null?void 0:Le.promise},this._callUserModel=async(ue,me)=>{try{N[ue](me)}catch{Ir(`[model method] #${ue} not existed`)}},setInterval(()=>{if(F.size>100)for(const[ue,me]of F)me.settled&&F.delete(ue)},18e5)}).finally(()=>{this._status=void 0}),await j.promise,N.baseInfo}async call(u,d={}){var y;return(y=this._call)===null||y===void 0?void 0:y.call(this,u,d)}async callAsync(u,d={}){var y;const k=bt(1e4);return(y=this._call)===null||y===void 0?void 0:y.call(this,u,d,k)}async callUserModel(u,...d){var y;return(y=this._callUserModel)===null||y===void 0?void 0:y.apply(this,[u,...d])}async callUserModelAsync(u,...d){var y;return u=`${li}${u}`,(y=this._callUserModel)===null||y===void 0?void 0:y.apply(this,[u,...d])}async _setupIframeSandbox(){const u=this._pluginLocal,d=u.id,y=`${d}_lsp_main`,k=new URL(u.options.entry);k.searchParams.set("__v__",u.options.version);const F=document.querySelector(`#${y}`);F&&F.parentElement.removeChild(F);const j=document.createElement("div");j.classList.add("lsp-iframe-sandbox-container"),j.id=y,j.dataset.pid=d;try{var N;const ue=(N=await this._pluginLocal._loadLayoutsData())===null||N===void 0?void 0:N.$$0;if(ue){j.dataset.inited_layout="true";let{width:me,height:Le,left:Ee,top:qe,vw:lt,vh:xt}=ue;Ee=Math.max(Ee,0),Ee=typeof lt=="number"?`${Math.min(100*Ee/lt,99)}%`:`${Ee}px`,qe=Math.max(qe,45),qe=typeof xt=="number"?`${Math.min(100*qe/xt,99)}%`:`${qe}px`,Object.assign(j.style,{width:me+"px",height:Le+"px",left:Ee,top:qe})}}catch(ue){console.error("[Restore Layout Error]",ue)}document.body.appendChild(j);const W=new Mo({id:d+"_iframe",container:j,url:k.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(u.toJSON()))}});let ne,se=W.sendHandshake();return this._status="pending",new Promise((ue,me)=>{ne=setTimeout(()=>{me(new Error("handshake Timeout")),W.destroy()},4e3),se.then(Le=>{this._parent=Le,this._connected=!0,this.emit("connected"),Le.on(Yi(u.id),({type:Ee,payload:qe})=>{var lt,xt;Ir("[user -> *host] ",Ee,qe),(lt=this._pluginLocal)===null||lt===void 0||lt.emit(Ee,qe||{}),(xt=this._pluginLocal)===null||xt===void 0||xt.caller.emit(Ee,qe||{})}),this._call=async(...Ee)=>{await Le.call(Yi(u.id),{type:Ee[0],payload:Object.assign(Ee[1]||{},{$$pid:u.id})})},this._callUserModel=async(Ee,...qe)=>{if(Ee.startsWith(li))return await Le.get(Ee.replace(li,""),...qe);Le.call(Ee,qe==null?void 0:qe[0])},ue(null)}).catch(Le=>{me(Le)}).finally(()=>{clearTimeout(ne)})}).catch(ue=>{throw Ir("[iframe sandbox] error",ue),ue}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){const u=this._pluginLocal,d=this._shadow=new bc(u);try{this._status="pending",await d.load(),this._connected=!0,this.emit("connected"),this._call=async(y,k={},F)=>{var j;return F&&(k.actor=F),(j=this._pluginLocal)===null||j===void 0||j.emit(y,Object.assign(k,{$$pid:u.id})),F==null?void 0:F.promise},this._callUserModel=async(...y)=>{var k;let F=y[0];(k=F)!==null&&k!==void 0&&k.startsWith(li)&&(F=F.replace(li,""));const j=y[1]||{},N=this._userModel[F];typeof N=="function"&&await N.call(null,j)}}catch(y){throw Ir("[shadow sandbox] error",y),y}finally{this._status=void 0}}_extendUserModel(u){return Object.assign(this._userModel,u)}_getSandboxIframeContainer(){var u;return(u=this._parent)===null||u===void 0?void 0:u.frame.parentNode}_getSandboxShadowContainer(){var u;return(u=this._shadow)===null||u===void 0?void 0:u.frame.parentNode}_getSandboxIframeRoot(){var u;return(u=this._parent)===null||u===void 0?void 0:u.frame}_getSandboxShadowRoot(){var u;return(u=this._shadow)===null||u===void 0?void 0:u.frame}set debugTag(u){this._debugTag=u}async destroy(){var u;let d=null;this._parent&&(d=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(d=this._getSandboxShadowContainer(),this._shadow.destroy()),(u=d)===null||u===void 0||u.parentNode.removeChild(d)}}function ts(h,u,d){return u in h?Object.defineProperty(h,u,{value:d,enumerable:!0,configurable:!0,writable:!0}):h[u]=d,h}class rs{constructor(u,d){ts(this,"ctx",void 0),ts(this,"opts",void 0),this.ctx=u,this.opts=d}get ctxId(){return this.ctx.baseInfo.id}setItem(u,d){var y;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,u,d,(y=this.opts)===null||y===void 0?void 0:y.assets]})}getItem(u){var d;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,u,(d=this.opts)===null||d===void 0?void 0:d.assets]})}removeItem(u){var d;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,u,(d=this.opts)===null||d===void 0?void 0:d.assets]})}allKeys(){var u;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(u=this.opts)===null||u===void 0?void 0:u.assets]})}clear(){var u;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(u=this.opts)===null||u===void 0?void 0:u.assets]})}hasItem(u){var d;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,u,(d=this.opts)===null||d===void 0?void 0:d.assets]})}}class Ec{constructor(u){var d,y,k;k=void 0,(y="ctx")in(d=this)?Object.defineProperty(d,y,{value:k,enumerable:!0,configurable:!0,writable:!0}):d[y]=k,this.ctx=u}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(u,...d){var y,k;const F=this.ensureHostScope();return u=(y=ee(u))===null||y===void 0?void 0:y.toLowerCase(),(k=F.logseq.api["exper_"+u])===null||k===void 0?void 0:k.apply(F,d)}async loadScripts(...u){(u=u.map(d=>d!=null&&d.startsWith("http")?d:this.ctx.resolveResourceFullUrl(d))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...u)}registerFencedCodeRenderer(u,d){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,u,d)}registerExtensionsEnhancer(u,d){const y=this.ensureHostScope();return u==="katex"&&y.katex&&d(y.katex).catch(console.error),y.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,u,d)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function fn(h,u,d){return u in h?Object.defineProperty(h,u,{value:d,enumerable:!0,configurable:!0,writable:!0}):h[u]=d,h}const ns=h=>`task_callback_${h}`;class Ac{constructor(u,d,y={}){fn(this,"_client",void 0),fn(this,"_requestId",void 0),fn(this,"_requestOptions",void 0),fn(this,"_promise",void 0),fn(this,"_aborted",!1),this._client=u,this._requestId=d,this._requestOptions=y,this._promise=new Promise((N,W)=>{if(!this._requestId)return W(null);this._client.once(ns(this._requestId),ne=>{ne&&ne instanceof Error?W(ne):N(ne)})});const{success:k,fail:F,final:j}=this._requestOptions;this._promise.then(N=>{k==null||k(N)}).catch(N=>{F==null||F(N)}).finally(()=>{j==null||j()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class zo extends ai.EventEmitter{constructor(u){super(),fn(this,"_ctx",void 0),this._ctx=u,this.ctx.caller.on("#lsp#request#callback",d=>{const y=d==null?void 0:d.requestId;y&&this.emit(ns(y),d==null?void 0:d.payload)})}static createRequestTask(u,d,y){return new Ac(u,d,y)}async _request(u){const d=this.ctx.baseInfo.id,ne=u,{success:y,fail:k,final:F}=ne,j=Jo(ne,["success","fail","final"]),N=this.ctx.Experiments.invokeExperMethod("request",d,j),W=zo.createRequestTask(this.ctx.Request,N,u);return j.abortable?W:W.promise}get ctx(){return this._ctx}}const Sc=Ii(Object.keys,Object);var Cc=Object.prototype.hasOwnProperty;const Lc=function(h){if(!Mn(h))return Sc(h);var u=[];for(var d in Object(h))Cc.call(h,d)&&d!="constructor"&&u.push(d);return u},Bo=function(h){return Br(h)?ln(h):Lc(h)},Tc=function(h,u){return h&&xi(h,u,Bo)},Oc=function(h){return this.__data__.set(h,"__lodash_hash_undefined__"),this},kc=function(h){return this.__data__.has(h)};function Ki(h){var u=-1,d=h==null?0:h.length;for(this.__data__=new xe;++u<d;)this.add(h[u])}Ki.prototype.add=Ki.prototype.push=Oc,Ki.prototype.has=kc;const xc=Ki,Dc=function(h,u){for(var d=-1,y=h==null?0:h.length;++d<y;)if(u(h[d],d,h))return!0;return!1},Pc=function(h,u){return h.has(u)},is=function(h,u,d,y,k,F){var j=1&d,N=h.length,W=u.length;if(N!=W&&!(j&&W>N))return!1;var ne=F.get(h),se=F.get(u);if(ne&&se)return ne==u&&se==h;var ue=-1,me=!0,Le=2&d?new xc:void 0;for(F.set(h,u),F.set(u,h);++ue<N;){var Ee=h[ue],qe=u[ue];if(y)var lt=j?y(qe,Ee,ue,u,h,F):y(Ee,qe,ue,h,u,F);if(lt!==void 0){if(lt)continue;me=!1;break}if(Le){if(!Dc(u,function(xt,br){if(!Pc(Le,br)&&(Ee===xt||k(Ee,xt,d,y,F)))return Le.push(br)})){me=!1;break}}else if(Ee!==qe&&!k(Ee,qe,d,y,F)){me=!1;break}}return F.delete(h),F.delete(u),me},Rc=function(h){var u=-1,d=Array(h.size);return h.forEach(function(y,k){d[++u]=[k,y]}),d},Fc=function(h){var u=-1,d=Array(h.size);return h.forEach(function(y){d[++u]=y}),d};var os=_?_.prototype:void 0,Wo=os?os.valueOf:void 0;const Ic=function(h,u,d,y,k,F,j){switch(d){case"[object DataView]":if(h.byteLength!=u.byteLength||h.byteOffset!=u.byteOffset)return!1;h=h.buffer,u=u.buffer;case"[object ArrayBuffer]":return!(h.byteLength!=u.byteLength||!F(new kr(h),new kr(u)));case"[object Boolean]":case"[object Date]":case"[object Number]":return c(+h,+u);case"[object Error]":return h.name==u.name&&h.message==u.message;case"[object RegExp]":case"[object String]":return h==u+"";case"[object Map]":var N=Rc;case"[object Set]":var W=1&y;if(N||(N=Fc),h.size!=u.size&&!W)return!1;var ne=j.get(h);if(ne)return ne==u;y|=2,j.set(h,u);var se=is(N(h),N(u),y,k,F,j);return j.delete(h),se;case"[object Symbol]":if(Wo)return Wo.call(h)==Wo.call(u)}return!1},jc=function(h,u){for(var d=-1,y=u.length,k=h.length;++d<y;)h[k+d]=u[d];return h},Gc=function(h,u,d){var y=u(h);return $t(h)?y:jc(y,d(h))},$c=function(h,u){for(var d=-1,y=h==null?0:h.length,k=0,F=[];++d<y;){var j=h[d];u(j,d,h)&&(F[k++]=j)}return F},Uc=function(){return[]};var Nc=Object.prototype.propertyIsEnumerable,as=Object.getOwnPropertySymbols;const Mc=as?function(h){return h==null?[]:(h=Object(h),$c(as(h),function(u){return Nc.call(h,u)}))}:Uc,ss=function(h){return Gc(h,Bo,Mc)};var zc=Object.prototype.hasOwnProperty;const Bc=function(h,u,d,y,k,F){var j=1&d,N=ss(h),W=N.length;if(W!=ss(u).length&&!j)return!1;for(var ne=W;ne--;){var se=N[ne];if(!(j?se in u:zc.call(u,se)))return!1}var ue=F.get(h),me=F.get(u);if(ue&&me)return ue==u&&me==h;var Le=!0;F.set(h,u),F.set(u,h);for(var Ee=j;++ne<W;){var qe=h[se=N[ne]],lt=u[se];if(y)var xt=j?y(lt,qe,se,u,h,F):y(qe,lt,se,h,u,F);if(!(xt===void 0?qe===lt||k(qe,lt,d,y,F):xt)){Le=!1;break}Ee||(Ee=se=="constructor")}if(Le&&!Ee){var br=h.constructor,Zr=u.constructor;br==Zr||!("constructor"in h)||!("constructor"in u)||typeof br=="function"&&br instanceof br&&typeof Zr=="function"&&Zr instanceof Zr||(Le=!1)}return F.delete(h),F.delete(u),Le},qo=rt(b,"DataView"),Ho=rt(b,"Promise"),Vo=rt(b,"Set"),Yo=rt(b,"WeakMap");var us="[object Map]",ls="[object Promise]",cs="[object Set]",hs="[object WeakMap]",ds="[object DataView]",Wc=he(qo),qc=he(ye),Hc=he(Ho),Vc=he(Vo),Yc=he(Yo),Kr=le;(qo&&Kr(new qo(new ArrayBuffer(1)))!=ds||ye&&Kr(new ye)!=us||Ho&&Kr(Ho.resolve())!=ls||Vo&&Kr(new Vo)!=cs||Yo&&Kr(new Yo)!=hs)&&(Kr=function(h){var u=le(h),d=u=="[object Object]"?h.constructor:void 0,y=d?he(d):"";if(y)switch(y){case Wc:return ds;case qc:return us;case Hc:return ls;case Vc:return cs;case Yc:return hs}return u});const fs=Kr;var ps="[object Arguments]",gs="[object Array]",Zi="[object Object]",vs=Object.prototype.hasOwnProperty;const Kc=function(h,u,d,y,k,F){var j=$t(h),N=$t(u),W=j?gs:fs(h),ne=N?gs:fs(u),se=(W=W==ps?Zi:W)==Zi,ue=(ne=ne==ps?Zi:ne)==Zi,me=W==ne;if(me&&Je(h)){if(!Je(u))return!1;j=!0,se=!1}if(me&&!se)return F||(F=new Ae),j||mr(h)?is(h,u,d,y,k,F):Ic(h,u,W,d,y,k,F);if(!(1&d)){var Le=se&&vs.call(h,"__wrapped__"),Ee=ue&&vs.call(u,"__wrapped__");if(Le||Ee){var qe=Le?h.value():h,lt=Ee?u.value():u;return F||(F=new Ae),k(qe,lt,d,y,F)}}return!!me&&(F||(F=new Ae),Bc(h,u,d,y,k,F))},ms=function h(u,d,y,k,F){return u===d||(u==null||d==null||!yt(u)&&!yt(d)?u!=u&&d!=d:Kc(u,d,y,k,h,F))},Zc=function(h,u,d,y){var k=d.length,F=k,j=!y;if(h==null)return!F;for(h=Object(h);k--;){var N=d[k];if(j&&N[2]?N[1]!==h[N[0]]:!(N[0]in h))return!1}for(;++k<F;){var W=(N=d[k])[0],ne=h[W],se=N[1];if(j&&N[2]){if(ne===void 0&&!(W in h))return!1}else{var ue=new Ae;if(y)var me=y(ne,se,W,h,u,ue);if(!(me===void 0?ms(se,ne,3,y,ue):me))return!1}}return!0},ys=function(h){return h==h&&!D(h)},Xc=function(h){for(var u=Bo(h),d=u.length;d--;){var y=u[d],k=h[y];u[d]=[y,k,ys(k)]}return u},bs=function(h,u){return function(d){return d!=null&&d[h]===u&&(u!==void 0||h in Object(d))}},Qc=function(h){var u=Xc(h);return u.length==1&&u[0][2]?bs(u[0][0],u[0][1]):function(d){return d===h||Zc(d,h,u)}},Ko=function(h){return typeof h=="symbol"||yt(h)&&le(h)=="[object Symbol]"};var Jc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eh=/^\w*$/;const Zo=function(h,u){if($t(h))return!1;var d=typeof h;return!(d!="number"&&d!="symbol"&&d!="boolean"&&h!=null&&!Ko(h))||eh.test(h)||!Jc.test(h)||u!=null&&h in Object(u)};function Xo(h,u){if(typeof h!="function"||u!=null&&typeof u!="function")throw new TypeError("Expected a function");var d=function(){var y=arguments,k=u?u.apply(this,y):y[0],F=d.cache;if(F.has(k))return F.get(k);var j=h.apply(this,y);return d.cache=F.set(k,j)||F,j};return d.cache=new(Xo.Cache||xe),d}Xo.Cache=xe;const th=Xo;var rh=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,nh=/\\(\\)?/g;const ih=function(h){var u=th(h,function(y){return d.size===500&&d.clear(),y}),d=u.cache;return u}(function(h){var u=[];return h.charCodeAt(0)===46&&u.push(""),h.replace(rh,function(d,y,k,F){u.push(k?F.replace(nh,"$1"):y||d)}),u}),oh=function(h,u){for(var d=-1,y=h==null?0:h.length,k=Array(y);++d<y;)k[d]=u(h[d],d,h);return k};var ws=_?_.prototype:void 0,_s=ws?ws.toString:void 0;const ah=function h(u){if(typeof u=="string")return u;if($t(u))return oh(u,h)+"";if(Ko(u))return _s?_s.call(u):"";var d=u+"";return d=="0"&&1/u==-1/0?"-0":d},sh=function(h){return h==null?"":ah(h)},Es=function(h,u){return $t(h)?h:Zo(h,u)?[h]:ih(sh(h))},Xi=function(h){if(typeof h=="string"||Ko(h))return h;var u=h+"";return u=="0"&&1/h==-1/0?"-0":u},As=function(h,u){for(var d=0,y=(u=Es(u,h)).length;h!=null&&d<y;)h=h[Xi(u[d++])];return d&&d==y?h:void 0},uh=function(h,u,d){var y=h==null?void 0:As(h,u);return y===void 0?d:y},lh=function(h,u){return h!=null&&u in Object(h)},ch=function(h,u,d){for(var y=-1,k=(u=Es(u,h)).length,F=!1;++y<k;){var j=Xi(u[y]);if(!(F=h!=null&&d(h,j)))break;h=h[j]}return F||++y!=k?F:!!(k=h==null?0:h.length)&&Wn(k)&&un(j,k)&&($t(h)||an(h))},hh=function(h,u){return h!=null&&ch(h,u,lh)},dh=function(h,u){return Zo(h)&&ys(u)?bs(Xi(h),u):function(d){var y=uh(d,h);return y===void 0&&y===u?hh(d,h):ms(u,y,3)}},fh=function(h){return function(u){return u==null?void 0:u[h]}},ph=function(h){return function(u){return As(u,h)}},gh=function(h){return Zo(h)?fh(Xi(h)):ph(h)},vh=function(h){return typeof h=="function"?h:h==null?hn:typeof h=="object"?$t(h)?dh(h[0],h[1]):Qc(h):gh(h)},mh=function(h,u){var d={};return u=vh(u),Tc(h,function(y,k,F){gr(d,u(y,k,F),y)}),d};function Ss(h,u,d){return u in h?Object.defineProperty(h,u,{value:d,enumerable:!0,configurable:!0,writable:!0}):h[u]=d,h}class yh{constructor(u,d){Ss(this,"ctx",void 0),Ss(this,"serviceHooks",void 0),this.ctx=u,this.serviceHooks=d,u._execCallableAPI("register-search-service",u.baseInfo.id,d.name,d.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:y=>($t(y==null?void 0:y.blocks)&&(y.blocks=y.blocks.map(k=>k&&mh(k,(F,j)=>`block/${j}`))),y)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([y,k])=>{const F=(j=>`service:search:${j}:${d.name}`)(y);u.caller.on(F,async j=>{if(U(d==null?void 0:d[k.f])){let N=null;try{N=await d[k.f].apply(d,(k.args||[]).map(W=>{if(j){if(W===!0)return j;if(j.hasOwnProperty(W)){const ne=j[W];return delete j[W],ne}}})),k.transformOutput&&(N=k.transformOutput(N))}catch(W){console.error("[SearchService] ",W),N=W}finally{k.reply&&u.caller.call(`${F}:reply`,N)}}})})}}function Jt(h,u,d){return u in h?Object.defineProperty(h,u,{value:d,enumerable:!0,configurable:!0,writable:!0}):h[u]=d,h}const bh=Symbol.for("proxy-continue"),wh=Qt()("LSPlugin:user"),Cs=new We("",{console:!0});function pn(h,u,d){var y;if(typeof d!="function")return!1;const{key:k,label:F,desc:j,palette:N,keybinding:W,extras:ne}=u,se=`SimpleCommandHook${k}${++Os}`;this.Editor["on"+se](d),(y=this.caller)===null||y===void 0||y.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:k,label:F,type:h,desc:j,keybinding:W,extras:ne},["editor/hook",se]],N]})}function Ls(h){return!(typeof(u=h)!="string"||u.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(u))||(Cs.error(`#${h} is not a valid UUID string.`),!1);var u}let Qi=null,Ts=new Map;const _h={async getInfo(h){return Qi||(Qi=await this._execCallableAPIAsync("get-app-info")),typeof h=="string"?Qi[h]:Qi},registerCommand:pn,registerSearchService(h){if(Ts.has(h.name))throw new Error(`SearchService: #${h.name} has registered!`);Ts.set(h.name,new yh(this,h))},registerCommandPalette(h,u){const{key:d,label:y,keybinding:k}=h;return pn.call(this,"$palette$",{key:d,label:y,palette:!0,keybinding:k},u)},registerCommandShortcut(h,u){const{binding:d}=h,y="$shortcut$",k=y+ee(d);return pn.call(this,y,{key:k,palette:!1,keybinding:h},u)},registerUIItem(h,u){var d;const y=this.baseInfo.id;(d=this.caller)===null||d===void 0||d.call("api:call",{method:"register-plugin-ui-item",args:[y,h,u]})},registerPageMenuItem(h,u){if(typeof u!="function")return!1;const d=h+"_"+this.baseInfo.id,y=h;pn.call(this,"page-menu-item",{key:d,label:y},u)},onBlockRendererSlotted(h,u){if(!Ls(h))return;const d=this.baseInfo.id,y=`hook:editor:${ee(`slot:${h}`)}`;return this.caller.on(y,u),this.App._installPluginHook(d,y),()=>{this.caller.off(y,u),this.App._uninstallPluginHook(d,y)}},invokeExternalPlugin(h,...u){var d;if(!(h=(d=h)===null||d===void 0?void 0:d.trim()))return;let[y,k]=h.split(".");if(!["models","commands"].includes(k==null?void 0:k.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const F=h.replace(`${y}.${k}.`,"");if(!y||!k||!F)throw new Error(`Illegal type of #${h} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",y,k.toLowerCase(),F,u)},setFullScreen(h){const u=(...d)=>this._callWin("setFullScreen",...d);h==="toggle"?this._callWin("isFullScreen").then(d=>{d?u():u(!0)}):h?u(!0):u()}};let Os=0;const Eh={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(h,u){var d;wh("Register slash command #",this.baseInfo.id,h,u),typeof u=="function"&&(u=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",u]]),u=u.map(y=>{const[k,...F]=y;if(k==="editor/hook"){let j=F[0],N=()=>{var ne;(ne=this.caller)===null||ne===void 0||ne.callUserModel(j)};typeof j=="function"&&(N=j);const W=`SlashCommandHook${k}${++Os}`;y[1]=W,this.Editor["on"+W](N)}return y}),(d=this.caller)===null||d===void 0||d.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[h,u]]})},registerBlockContextMenuItem(h,u){if(typeof u!="function")return!1;const d=h+"_"+this.baseInfo.id;pn.call(this,"block-context-menu-item",{key:d,label:h},u)},registerHighlightContextMenuItem(h,u,d){if(typeof u!="function")return!1;const y=h+"_"+this.baseInfo.id;pn.call(this,"highlight-context-menu-item",{key:y,label:h,extras:d},u)},scrollToBlockInPage(h,u,d){const y="block-content-"+u;d!=null&&d.replaceState?this.App.replaceState("page",{name:h},{anchor:y}):this.App.pushState("page",{name:h},{anchor:y})}},Ah={onBlockChanged(h,u){if(!Ls(h))return;const d=this.baseInfo.id,y=`hook:db:${ee(`block:${h}`)}`,k=({block:F,txData:j,txMeta:N})=>{F.uuid===h&&u(F,j,N)};return this.caller.on(y,k),this.App._installPluginHook(d,y),()=>{this.caller.off(y,k),this.App._uninstallPluginHook(d,y)}},datascriptQuery(h,...u){return u.pop(),u!=null&&u.some(d=>typeof d=="function")?this.Experiments.ensureHostScope().logseq.api.datascript_query(h,...u):this._execCallableAPIAsync("datascript_query",h,...u)}},Sh={},Ch={},Lh={makeSandboxStorage(){return new rs(this,{assets:!0})}};class Qo extends Vr(){constructor(u,d){super(),Jt(this,"_baseInfo",void 0),Jt(this,"_caller",void 0),Jt(this,"_version","0.0.15"),Jt(this,"_debugTag",""),Jt(this,"_settingsSchema",void 0),Jt(this,"_connected",!1),Jt(this,"_ui",new Map),Jt(this,"_mFileStorage",void 0),Jt(this,"_mRequest",void 0),Jt(this,"_mExperiments",void 0),Jt(this,"_beforeunloadCallback",void 0),this._baseInfo=u,this._caller=d,d.on("sys:ui:visible",y=>{y!=null&&y.toggle&&this.toggleMainUI()}),d.on("settings:changed",y=>{const k=Object.assign({},this.settings),F=Object.assign(this._baseInfo.settings,y);this.emit("settings:changed",wr({},F),k)}),d.on("beforeunload",async y=>{const N=y,{actor:k}=N,F=Jo(N,["actor"]),j=this._beforeunloadCallback;try{j&&await j(F),k==null||k.resolve(null)}catch(W){console.debug(`${d.debugTag} [beforeunload] `,W),k==null||k.reject(W)}})}async ready(u,d){if(!this._connected)try{var y;typeof u=="function"&&(d=u,u={});let k=await this._caller.connectToParent(u);this._connected=!0,k=X(this._baseInfo,k),(y=k)!==null&&y!==void 0&&y.id&&(this._debugTag=this._caller.debugTag=`#${k.id} [${k.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(k.settings=function(F,j){const N=(j||[]).reduce((W,ne)=>("default"in ne&&(W[ne.key]=ne.default),W),{});return Object.assign(N,F)}(k.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(F){console.warn(F)}d&&d.call(this,k)}catch(k){console.error(`${this._debugTag} [Ready Error]`,k)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(u){typeof u=="function"&&(this._beforeunloadCallback=u)}provideModel(u){return this.caller._extendUserModel(u),this}provideTheme(u){return this.caller.call("provider:theme",u),this}provideStyle(u){return this.caller.call("provider:style",u),this}provideUI(u){return this.caller.call("provider:ui",u),this}useSettingsSchema(u){return this.connected&&this.caller.call("settings:schema",{schema:u,isSync:!0}),this._settingsSchema=u,this}updateSettings(u){this.caller.call("settings:update",u)}onSettingsChanged(u){const d="settings:changed";return this.on(d,u),()=>this.off(d,u)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(u){this.caller.call("main-ui:attrs",u)}setMainUIInlineStyle(u){this.caller.call("main-ui:style",u)}hideMainUI(u){const d={key:0,visible:!1,cursor:u==null?void 0:u.restoreEditingCursor};this.caller.call("main-ui:visible",d),this.emit("ui:visible:changed",d),this._ui.set(d.key,d)}showMainUI(u){const d={key:0,visible:!0,autoFocus:u==null?void 0:u.autoFocus};this.caller.call("main-ui:visible",d),this.emit("ui:visible:changed",d),this._ui.set(d.key,d)}toggleMainUI(){const d=this._ui.get(0);d&&d.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const u=this._ui.get(0);return Boolean(u&&u.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(u=this)&&(((d=u.baseInfo)===null||d===void 0?void 0:d.effect)||!((y=u.baseInfo)!==null&&y!==void 0&&y.iir));var u,d,y}get logger(){return Cs}get settings(){var u;return(u=this.baseInfo)===null||u===void 0?void 0:u.settings}get caller(){return this._caller}resolveResourceFullUrl(u){if(this.ensureConnected(),u)return u=u.replace(/^[.\\/]+/,""),it(this._baseInfo.lsr,u)}_makeUserProxy(u,d){const y=this,k=this.caller;return new Proxy(u,{get(F,j,N){const W=F[j];return function(...ne){if(W){const ue=W.apply(y,ne.concat(d));if(ue!==bh)return ue}if(d){const ue=j.toString().match(/^(once|off|on)/i);if(ue!=null){const me=ue[0].toLowerCase(),Le=ue.input.slice(me.length),Ee=me==="off",qe=y.baseInfo.id,lt=`hook:${d}:${ee(Le)}`,xt=ne[0],br=ne[1];k[me](lt,xt);const Zr=()=>{k.off(lt,xt),k.listenerCount(lt)||y.App._uninstallPluginHook(qe,lt)};return Ee?void Zr():(y.App._installPluginHook(qe,lt,br),Zr)}}let se=j;return["git","ui","assets"].includes(d)&&(se=d+"_"+se),k.callAsync("api:call",{tag:d,method:se,args:ne})}}})}_execCallableAPIAsync(u,...d){return this._caller.callAsync("api:call",{method:u,args:d})}_execCallableAPI(u,...d){this._caller.call("api:call",{method:u,args:d})}_callWin(...u){return this._execCallableAPIAsync("_callMainWin",...u)}get App(){return this._makeUserProxy(_h,"app")}get Editor(){return this._makeUserProxy(Eh,"editor")}get DB(){return this._makeUserProxy(Ah,"db")}get Git(){return this._makeUserProxy(Sh,"git")}get UI(){return this._makeUserProxy(Ch,"ui")}get Assets(){return this._makeUserProxy(Lh,"assets")}get FileStorage(){let u=this._mFileStorage;return u||(u=this._mFileStorage=new rs(this)),u}get Request(){let u=this._mRequest;return u||(u=this._mRequest=new zo(this)),u}get Experiments(){let u=this._mExperiments;return u||(u=this._mExperiments=new Ec(this)),u}}function ks(h,u){return new Qo(h,u)}if(window.__LSP__HOST__==null){const h=new _c(null);window.logseq=ks({},h)}})(),o})())})(Rs,Rs.exports);function Yt(){}function Dh(n,t){for(const e in t)n[e]=t[e];return n}function Du(n){return n()}function Fs(){return Object.create(null)}function Wt(n){n.forEach(Du)}function Pu(n){return typeof n=="function"}function nn(n,t){return n!=n?t==t:n!==t||n&&typeof n=="object"||typeof n=="function"}function Ph(n){return Object.keys(n).length===0}function Ru(n,...t){if(n==null)return Yt;const e=n.subscribe(...t);return e.unsubscribe?()=>e.unsubscribe():e}function $r(n,t,e){n.$$.on_destroy.push(Ru(t,e))}function Rh(n,t,e,r){if(n){const i=Fu(n,t,e,r);return n[0](i)}}function Fu(n,t,e,r){return n[1]&&r?Dh(e.ctx.slice(),n[1](r(t))):e.ctx}function Fh(n,t,e,r){if(n[2]&&r){const i=n[2](r(e));if(t.dirty===void 0)return i;if(typeof i=="object"){const o=[],a=Math.max(t.dirty.length,i.length);for(let s=0;s<a;s+=1)o[s]=t.dirty[s]|i[s];return o}return t.dirty|i}return t.dirty}function Ih(n,t,e,r,i,o){if(i){const a=Fu(t,e,r,o);n.p(a,i)}}function jh(n){if(n.ctx.length>32){const t=[],e=n.ctx.length/32;for(let r=0;r<e;r++)t[r]=-1;return t}return-1}function Mt(n,t,e){return n.set(e),t}function H(n,t){n.appendChild(t)}function st(n,t,e){n.insertBefore(t,e||null)}function nt(n){n.parentNode.removeChild(n)}function Gh(n,t){for(let e=0;e<n.length;e+=1)n[e]&&n[e].d(t)}function oe(n){return document.createElement(n)}function Ea(n){return document.createTextNode(n)}function Se(){return Ea(" ")}function Aa(){return Ea("")}function ze(n,t,e,r){return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e,r)}function z(n,t,e){e==null?n.removeAttribute(t):n.getAttribute(t)!==e&&n.setAttribute(t,e)}function Xr(n){return n===""?null:+n}function $h(n){return Array.from(n.childNodes)}function Xe(n,t){n.value=t==null?"":t}function eo(n,t){for(let e=0;e<n.options.length;e+=1){const r=n.options[e];if(r.__value===t){r.selected=!0;return}}n.selectedIndex=-1}function Is(n){const t=n.querySelector(":checked")||n.options[0];return t&&t.__value}function Uh(n,t,{bubbles:e=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(n,e,r,t),i}let wi;function yi(n){wi=n}function kn(){if(!wi)throw new Error("Function called outside component initialization");return wi}function bo(n){kn().$$.on_mount.push(n)}function Iu(n){kn().$$.after_update.push(n)}function wo(n){kn().$$.on_destroy.push(n)}function ju(){const n=kn();return(t,e,{cancelable:r=!1}={})=>{const i=n.$$.callbacks[t];if(i){const o=Uh(t,e,{cancelable:r});return i.slice().forEach(a=>{a.call(n,o)}),!o.defaultPrevented}return!0}}function Nh(n,t){return kn().$$.context.set(n,t),t}function Gu(n){return kn().$$.context.get(n)}const gi=[],ua=[],lo=[],js=[],Mh=Promise.resolve();let la=!1;function zh(){la||(la=!0,Mh.then($u))}function _i(n){lo.push(n)}const ea=new Set;let to=0;function $u(){const n=wi;do{for(;to<gi.length;){const t=gi[to];to++,yi(t),Bh(t.$$)}for(yi(null),gi.length=0,to=0;ua.length;)ua.pop()();for(let t=0;t<lo.length;t+=1){const e=lo[t];ea.has(e)||(ea.add(e),e())}lo.length=0}while(gi.length);for(;js.length;)js.pop()();la=!1,ea.clear(),yi(n)}function Bh(n){if(n.fragment!==null){n.update(),Wt(n.before_update);const t=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,t),n.after_update.forEach(_i)}}const co=new Set;let en;function ca(){en={r:0,c:[],p:en}}function ha(){en.r||Wt(en.c),en=en.p}function rr(n,t){n&&n.i&&(co.delete(n),n.i(t))}function fr(n,t,e,r){if(n&&n.o){if(co.has(n))return;co.add(n),en.c.push(()=>{co.delete(n),r&&(e&&n.d(1),r())}),n.o(t)}}function da(n,t){fr(n,1,1,()=>{t.delete(n.key)})}function fa(n,t,e,r,i,o,a,s,c,l,f,p){let g=n.length,v=o.length,m=g;const E={};for(;m--;)E[n[m].key]=m;const S=[],C=new Map,L=new Map;for(m=v;m--;){const R=p(i,o,m),b=e(R);let _=a.get(b);_?r&&_.p(R,t):(_=l(b,R),_.c()),C.set(b,S[m]=_),b in E&&L.set(b,Math.abs(m-E[b]))}const O=new Set,x=new Set;function A(R){rr(R,1),R.m(s,f),a.set(R.key,R),f=R.first,v--}for(;g&&v;){const R=S[v-1],b=n[g-1],_=R.key,w=b.key;R===b?(f=R.first,g--,v--):C.has(w)?!a.has(_)||O.has(_)?A(R):x.has(w)?g--:L.get(_)>L.get(w)?(x.add(_),A(R)):(O.add(w),g--):(c(b,a),g--)}for(;g--;){const R=n[g];C.has(R.key)||c(R,a)}for(;v;)A(S[v-1]);return S}function Ei(n){n&&n.c()}function _n(n,t,e,r){const{fragment:i,on_mount:o,on_destroy:a,after_update:s}=n.$$;i&&i.m(t,e),r||_i(()=>{const c=o.map(Du).filter(Pu);a?a.push(...c):Wt(c),n.$$.on_mount=[]}),s.forEach(_i)}function En(n,t){const e=n.$$;e.fragment!==null&&(Wt(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function Wh(n,t){n.$$.dirty[0]===-1&&(gi.push(n),zh(),n.$$.dirty.fill(0)),n.$$.dirty[t/31|0]|=1<<t%31}function xn(n,t,e,r,i,o,a,s=[-1]){const c=wi;yi(n);const l=n.$$={fragment:null,ctx:null,props:o,update:Yt,not_equal:i,bound:Fs(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Fs(),dirty:s,skip_bound:!1,root:t.target||c.$$.root};a&&a(l.root);let f=!1;if(l.ctx=e?e(n,t.props||{},(p,g,...v)=>{const m=v.length?v[0]:g;return l.ctx&&i(l.ctx[p],l.ctx[p]=m)&&(!l.skip_bound&&l.bound[p]&&l.bound[p](m),f&&Wh(n,p)),g}):[],l.update(),f=!0,Wt(l.before_update),l.fragment=r?r(l.ctx):!1,t.target){if(t.hydrate){const p=$h(t.target);l.fragment&&l.fragment.l(p),p.forEach(nt)}else l.fragment&&l.fragment.c();t.intro&&rr(n.$$.fragment),_n(n,t.target,t.anchor,t.customElement),$u()}yi(c)}class Dn{$destroy(){En(this,1),this.$destroy=Yt}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const i=r.indexOf(e);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!Ph(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var _o={exports:{}},bn=typeof Reflect=="object"?Reflect:null,Gs=bn&&typeof bn.apply=="function"?bn.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},ho;bn&&typeof bn.ownKeys=="function"?ho=bn.ownKeys:Object.getOwnPropertySymbols?ho=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:ho=function(t){return Object.getOwnPropertyNames(t)};function qh(n){console&&console.warn&&console.warn(n)}var Uu=Number.isNaN||function(t){return t!==t};function Ye(){Ye.init.call(this)}_o.exports=Ye;_o.exports.once=Kh;Ye.EventEmitter=Ye;Ye.prototype._events=void 0;Ye.prototype._eventsCount=0;Ye.prototype._maxListeners=void 0;var $s=10;function Eo(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Ye,"defaultMaxListeners",{enumerable:!0,get:function(){return $s},set:function(n){if(typeof n!="number"||n<0||Uu(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");$s=n}});Ye.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ye.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Uu(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Nu(n){return n._maxListeners===void 0?Ye.defaultMaxListeners:n._maxListeners}Ye.prototype.getMaxListeners=function(){return Nu(this)};Ye.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[t];if(c===void 0)return!1;if(typeof c=="function")Gs(c,this,e);else for(var l=c.length,f=qu(c,l),r=0;r<l;++r)Gs(f[r],this,e);return!0};function Mu(n,t,e,r){var i,o,a;if(Eo(e),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",t,e.listener?e.listener:e),o=n._events),a=o[t]),a===void 0)a=o[t]=e,++n._eventsCount;else if(typeof a=="function"?a=o[t]=r?[e,a]:[a,e]:r?a.unshift(e):a.push(e),i=Nu(n),i>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=n,s.type=t,s.count=a.length,qh(s)}return n}Ye.prototype.addListener=function(t,e){return Mu(this,t,e,!1)};Ye.prototype.on=Ye.prototype.addListener;Ye.prototype.prependListener=function(t,e){return Mu(this,t,e,!0)};function Hh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function zu(n,t,e){var r={fired:!1,wrapFn:void 0,target:n,type:t,listener:e},i=Hh.bind(r);return i.listener=e,r.wrapFn=i,i}Ye.prototype.once=function(t,e){return Eo(e),this.on(t,zu(this,t,e)),this};Ye.prototype.prependOnceListener=function(t,e){return Eo(e),this.prependListener(t,zu(this,t,e)),this};Ye.prototype.removeListener=function(t,e){var r,i,o,a,s;if(Eo(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(o=-1,a=r.length-1;a>=0;a--)if(r[a]===e||r[a].listener===e){s=r[a].listener,o=a;break}if(o<0)return this;o===0?r.shift():Vh(r,o),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,s||e)}return this};Ye.prototype.off=Ye.prototype.removeListener;Ye.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var o=Object.keys(r),a;for(i=0;i<o.length;++i)a=o[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function Bu(n,t,e){var r=n._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?Yh(i):qu(i,i.length)}Ye.prototype.listeners=function(t){return Bu(this,t,!0)};Ye.prototype.rawListeners=function(t){return Bu(this,t,!1)};Ye.listenerCount=function(n,t){return typeof n.listenerCount=="function"?n.listenerCount(t):Wu.call(n,t)};Ye.prototype.listenerCount=Wu;function Wu(n){var t=this._events;if(t!==void 0){var e=t[n];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}Ye.prototype.eventNames=function(){return this._eventsCount>0?ho(this._events):[]};function qu(n,t){for(var e=new Array(t),r=0;r<t;++r)e[r]=n[r];return e}function Vh(n,t){for(;t+1<n.length;t++)n[t]=n[t+1];n.pop()}function Yh(n){for(var t=new Array(n.length),e=0;e<t.length;++e)t[e]=n[e].listener||n[e];return t}function Kh(n,t){return new Promise(function(e,r){function i(a){n.removeListener(t,o),r(a)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",i),e([].slice.call(arguments))}Hu(n,t,o,{once:!0}),t!=="error"&&Zh(n,i,{once:!0})})}function Zh(n,t,e){typeof n.on=="function"&&Hu(n,"error",t,e)}function Hu(n,t,e,r){if(typeof n.on=="function")r.once?n.once(t,e):n.on(t,e);else if(typeof n.addEventListener=="function")n.addEventListener(t,function i(o){r.once&&n.removeEventListener(t,i),e(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}function pr(n){if(typeof n!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=n}typeof Symbol!="undefined"&&(pr.prototype[Symbol.iterator]=function(){return this});pr.of=function(){var n=arguments,t=n.length,e=0;return new pr(function(){return e>=t?{done:!0}:{done:!1,value:n[e++]}})};pr.empty=function(){var n=new pr(function(){return{done:!0}});return n};pr.fromSequence=function(n){var t=0,e=n.length;return new pr(function(){return t>=e?{done:!0}:{done:!1,value:n[t++]}})};pr.is=function(n){return n instanceof pr?!0:typeof n=="object"&&n!==null&&typeof n.next=="function"};var Gt=pr,Ao={};Ao.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer!="undefined";Ao.SYMBOL_SUPPORT=typeof Symbol!="undefined";var Xh=Gt,Vu=Ao,Qh=Vu.ARRAY_BUFFER_SUPPORT,Jh=Vu.SYMBOL_SUPPORT;function ed(n){return typeof n=="string"||Array.isArray(n)||Qh&&ArrayBuffer.isView(n)?Xh.fromSequence(n):typeof n!="object"||n===null?null:Jh&&typeof n[Symbol.iterator]=="function"?n[Symbol.iterator]():typeof n.next=="function"?n:null}var Yu=function(t){var e=ed(t);if(!e)throw new Error("obliterator: target is not iterable nor a valid iterator.");return e},td=Yu,Ku=function(t,e){for(var r=arguments.length>1?e:1/0,i=r!==1/0?new Array(r):[],o,a=0,s=td(t);;){if(a===r)return i;if(o=s.next(),o.done)return a!==e&&(i.length=a),i;i[a++]=o.value}},rd=Gt,nd=Yu,Cr=function(){var t=arguments,e=null,r=-1;return new rd(function(){var o=null;do{if(e===null){if(r++,r>=t.length)return{done:!0};e=nd(t[r])}if(o=e.next(),o.done===!0){e=null;continue}break}while(!0);return o})};function id(){const n=arguments[0];for(let t=1,e=arguments.length;t<e;t++)if(!!arguments[t])for(const r in arguments[t])n[r]=arguments[t][r];return n}let _t=id;typeof Object.assign=="function"&&(_t=Object.assign);function Kt(n,t,e,r){const i=n._nodes.get(t);let o=null;return i&&(r==="mixed"?o=i.out&&i.out[e]||i.undirected&&i.undirected[e]:r==="directed"?o=i.out&&i.out[e]:o=i.undirected&&i.undirected[e]),o}function Lt(n){return typeof n=="object"&&n!==null&&n.constructor===Object}function Zu(n){let t;for(t in n)return!1;return!0}function qt(n,t,e){Object.defineProperty(n,t,{enumerable:!1,configurable:!1,writable:!0,value:e})}function er(n,t,e){const r={enumerable:!0,configurable:!0};typeof e=="function"?r.get=e:(r.value=e,r.writable=!1),Object.defineProperty(n,t,r)}function Us(n){return!(!Lt(n)||n.attributes&&!Array.isArray(n.attributes))}function od(){let n=Math.floor(Math.random()*256)&255;return()=>n++}class Sa extends Error{constructor(t){super(),this.name="GraphError",this.message=t}}class te extends Sa{constructor(t){super(t),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,te.prototype.constructor)}}class Z extends Sa{constructor(t){super(t),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Z.prototype.constructor)}}class ve extends Sa{constructor(t){super(t),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ve.prototype.constructor)}}function Xu(n,t){this.key=n,this.attributes=t,this.clear()}Xu.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Qu(n,t){this.key=n,this.attributes=t,this.clear()}Qu.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function Ju(n,t){this.key=n,this.attributes=t,this.clear()}Ju.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Pn(n,t,e,r,i){this.key=t,this.attributes=i,this.undirected=n,this.source=e,this.target=r}Pn.prototype.attach=function(){let n="out",t="in";this.undirected&&(n=t="undirected");const e=this.source.key,r=this.target.key;this.source[n][r]=this,!(this.undirected&&e===r)&&(this.target[t][e]=this)};Pn.prototype.attachMulti=function(){let n="out",t="in";const e=this.source.key,r=this.target.key;this.undirected&&(n=t="undirected");const i=this.source[n],o=i[r];if(typeof o=="undefined"){i[r]=this,this.undirected&&e===r||(this.target[t][e]=this);return}o.previous=this,this.next=o,i[r]=this,this.target[t][e]=this};Pn.prototype.detach=function(){const n=this.source.key,t=this.target.key;let e="out",r="in";this.undirected&&(e=r="undirected"),delete this.source[e][t],delete this.target[r][n]};Pn.prototype.detachMulti=function(){const n=this.source.key,t=this.target.key;let e="out",r="in";this.undirected&&(e=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[e][t],delete this.target[r][n]):(this.next.previous=void 0,this.source[e][t]=this.next,this.target[r][n]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const el=0,tl=1,ad=2,rl=3;function Tr(n,t,e,r,i,o,a){let s,c,l,f;if(r=""+r,e===el){if(s=n._nodes.get(r),!s)throw new Z(`Graph.${t}: could not find the "${r}" node in the graph.`);l=i,f=o}else if(e===rl){if(i=""+i,c=n._edges.get(i),!c)throw new Z(`Graph.${t}: could not find the "${i}" edge in the graph.`);const p=c.source.key,g=c.target.key;if(r===p)s=c.target;else if(r===g)s=c.source;else throw new Z(`Graph.${t}: the "${r}" node is not attached to the "${i}" edge (${p}, ${g}).`);l=o,f=a}else{if(c=n._edges.get(r),!c)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`);e===tl?s=c.source:s=c.target,l=i,f=o}return[s,l,f]}function sd(n,t,e){n.prototype[t]=function(r,i,o){const[a,s]=Tr(this,t,e,r,i,o);return a.attributes[s]}}function ud(n,t,e){n.prototype[t]=function(r,i){const[o]=Tr(this,t,e,r,i);return o.attributes}}function ld(n,t,e){n.prototype[t]=function(r,i,o){const[a,s]=Tr(this,t,e,r,i,o);return a.attributes.hasOwnProperty(s)}}function cd(n,t,e){n.prototype[t]=function(r,i,o,a){const[s,c,l]=Tr(this,t,e,r,i,o,a);return s.attributes[c]=l,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:c}),this}}function hd(n,t,e){n.prototype[t]=function(r,i,o,a){const[s,c,l]=Tr(this,t,e,r,i,o,a);if(typeof l!="function")throw new te(`Graph.${t}: updater should be a function.`);const f=s.attributes,p=l(f[c]);return f[c]=p,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:c}),this}}function dd(n,t,e){n.prototype[t]=function(r,i,o){const[a,s]=Tr(this,t,e,r,i,o);return delete a.attributes[s],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:s}),this}}function fd(n,t,e){n.prototype[t]=function(r,i,o){const[a,s]=Tr(this,t,e,r,i,o);if(!Lt(s))throw new te(`Graph.${t}: provided attributes are not a plain object.`);return a.attributes=s,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function pd(n,t,e){n.prototype[t]=function(r,i,o){const[a,s]=Tr(this,t,e,r,i,o);if(!Lt(s))throw new te(`Graph.${t}: provided attributes are not a plain object.`);return _t(a.attributes,s),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:s}),this}}function gd(n,t,e){n.prototype[t]=function(r,i,o){const[a,s]=Tr(this,t,e,r,i,o);if(typeof s!="function")throw new te(`Graph.${t}: provided updater is not a function.`);return a.attributes=s(a.attributes),this.emit("nodeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const vd=[{name:n=>`get${n}Attribute`,attacher:sd},{name:n=>`get${n}Attributes`,attacher:ud},{name:n=>`has${n}Attribute`,attacher:ld},{name:n=>`set${n}Attribute`,attacher:cd},{name:n=>`update${n}Attribute`,attacher:hd},{name:n=>`remove${n}Attribute`,attacher:dd},{name:n=>`replace${n}Attributes`,attacher:fd},{name:n=>`merge${n}Attributes`,attacher:pd},{name:n=>`update${n}Attributes`,attacher:gd}];function md(n){vd.forEach(function({name:t,attacher:e}){e(n,t("Node"),el),e(n,t("Source"),tl),e(n,t("Target"),ad),e(n,t("Opposite"),rl)})}function yd(n,t,e){n.prototype[t]=function(r,i){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+i;if(i=arguments[2],o=Kt(this,a,s,e),!o)throw new Z(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return o.attributes[i]}}function bd(n,t,e){n.prototype[t]=function(r){let i;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,a=""+arguments[1];if(i=Kt(this,o,a,e),!i)throw new Z(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,i=this._edges.get(r),!i)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return i.attributes}}function wd(n,t,e){n.prototype[t]=function(r,i){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+i;if(i=arguments[2],o=Kt(this,a,s,e),!o)throw new Z(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return o.attributes.hasOwnProperty(i)}}function _d(n,t,e){n.prototype[t]=function(r,i,o){let a;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,c=""+i;if(i=arguments[2],o=arguments[3],a=Kt(this,s,c,e),!a)throw new Z(`Graph.${t}: could not find an edge for the given path ("${s}" - "${c}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return a.attributes[i]=o,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function Ed(n,t,e){n.prototype[t]=function(r,i,o){let a;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,c=""+i;if(i=arguments[2],o=arguments[3],a=Kt(this,s,c,e),!a)throw new Z(`Graph.${t}: could not find an edge for the given path ("${s}" - "${c}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(typeof o!="function")throw new te(`Graph.${t}: updater should be a function.`);return a.attributes[i]=o(a.attributes[i]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function Ad(n,t,e){n.prototype[t]=function(r,i){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+i;if(i=arguments[2],o=Kt(this,a,s,e),!o)throw new Z(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return delete o.attributes[i],this.emit("edgeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:i}),this}}function Sd(n,t,e){n.prototype[t]=function(r,i){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+i;if(i=arguments[2],o=Kt(this,a,s,e),!o)throw new Z(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(!Lt(i))throw new te(`Graph.${t}: provided attributes are not a plain object.`);return o.attributes=i,this.emit("edgeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function Cd(n,t,e){n.prototype[t]=function(r,i){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+i;if(i=arguments[2],o=Kt(this,a,s,e),!o)throw new Z(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(!Lt(i))throw new te(`Graph.${t}: provided attributes are not a plain object.`);return _t(o.attributes,i),this.emit("edgeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:i}),this}}function Ld(n,t,e){n.prototype[t]=function(r,i){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new ve(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+i;if(i=arguments[2],o=Kt(this,a,s,e),!o)throw new Z(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new ve(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new Z(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(typeof i!="function")throw new te(`Graph.${t}: provided updater is not a function.`);return o.attributes=i(o.attributes),this.emit("edgeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const Td=[{name:n=>`get${n}Attribute`,attacher:yd},{name:n=>`get${n}Attributes`,attacher:bd},{name:n=>`has${n}Attribute`,attacher:wd},{name:n=>`set${n}Attribute`,attacher:_d},{name:n=>`update${n}Attribute`,attacher:Ed},{name:n=>`remove${n}Attribute`,attacher:Ad},{name:n=>`replace${n}Attributes`,attacher:Sd},{name:n=>`merge${n}Attributes`,attacher:Cd},{name:n=>`update${n}Attributes`,attacher:Ld}];function Od(n){Td.forEach(function({name:t,attacher:e}){e(n,t("Edge"),"mixed"),e(n,t("DirectedEdge"),"directed"),e(n,t("UndirectedEdge"),"undirected")})}const kd=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function xd(n,t,e,r){let i=!1;for(const o in t){if(o===r)continue;const a=t[o];if(i=e(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),n&&i)return a.key}}function Dd(n,t,e,r){let i,o,a,s=!1;for(const c in t)if(c!==r){i=t[c];do{if(o=i.source,a=i.target,s=e(i.key,i.attributes,o.key,a.key,o.attributes,a.attributes,i.undirected),n&&s)return i.key;i=i.next}while(i!==void 0)}}function ta(n,t){const e=Object.keys(n),r=e.length;let i,o=0;return new Gt(function(){do if(i)i=i.next;else{if(o>=r)return{done:!0};const s=e[o++];if(s===t){i=void 0;continue}i=n[s]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}})}function Pd(n,t,e,r){const i=t[e];if(!i)return;const o=i.source,a=i.target;if(r(i.key,i.attributes,o.key,a.key,o.attributes,a.attributes,i.undirected)&&n)return i.key}function Rd(n,t,e,r){let i=t[e];if(!i)return;let o=!1;do{if(o=r(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),n&&o)return i.key;i=i.next}while(i!==void 0)}function ra(n,t){let e=n[t];return e.next!==void 0?new Gt(function(){if(!e)return{done:!0};const r={edge:e.key,attributes:e.attributes,source:e.source.key,target:e.target.key,sourceAttributes:e.source.attributes,targetAttributes:e.target.attributes,undirected:e.undirected};return e=e.next,{done:!1,value:r}}):Gt.of({edge:e.key,attributes:e.attributes,source:e.source.key,target:e.target.key,sourceAttributes:e.source.attributes,targetAttributes:e.target.attributes,undirected:e.undirected})}function Fd(n,t){if(n.size===0)return[];if(t==="mixed"||t===n.type)return typeof Array.from=="function"?Array.from(n._edges.keys()):Ku(n._edges.keys(),n._edges.size);const e=t==="undirected"?n.undirectedSize:n.directedSize,r=new Array(e),i=t==="undirected",o=n._edges.values();let a=0,s,c;for(;s=o.next(),s.done!==!0;)c=s.value,c.undirected===i&&(r[a++]=c.key);return r}function nl(n,t,e,r){if(t.size===0)return;const i=e!=="mixed"&&e!==t.type,o=e==="undirected";let a,s,c=!1;const l=t._edges.values();for(;a=l.next(),a.done!==!0;){if(s=a.value,i&&s.undirected!==o)continue;const{key:f,attributes:p,source:g,target:v}=s;if(c=r(f,p,g.key,v.key,g.attributes,v.attributes,s.undirected),n&&c)return f}}function Id(n,t){if(n.size===0)return Gt.empty();const e=t!=="mixed"&&t!==n.type,r=t==="undirected",i=n._edges.values();return new Gt(function(){let a,s;for(;;){if(a=i.next(),a.done)return a;if(s=a.value,!(e&&s.undirected!==r))break}return{value:{edge:s.key,attributes:s.attributes,source:s.source.key,target:s.target.key,sourceAttributes:s.source.attributes,targetAttributes:s.target.attributes,undirected:s.undirected},done:!1}})}function Ca(n,t,e,r,i,o){const a=t?Dd:xd;let s;if(e!=="undirected"&&(r!=="out"&&(s=a(n,i.in,o),n&&s)||r!=="in"&&(s=a(n,i.out,o,r?void 0:i.key),n&&s))||e!=="directed"&&(s=a(n,i.undirected,o),n&&s))return s}function jd(n,t,e,r){const i=[];return Ca(!1,n,t,e,r,function(o){i.push(o)}),i}function Gd(n,t,e){let r=Gt.empty();return n!=="undirected"&&(t!=="out"&&typeof e.in!="undefined"&&(r=Cr(r,ta(e.in))),t!=="in"&&typeof e.out!="undefined"&&(r=Cr(r,ta(e.out,t?void 0:e.key)))),n!=="directed"&&typeof e.undirected!="undefined"&&(r=Cr(r,ta(e.undirected))),r}function La(n,t,e,r,i,o,a){const s=e?Rd:Pd;let c;if(t!=="undirected"&&(typeof i.in!="undefined"&&r!=="out"&&(c=s(n,i.in,o,a),n&&c)||typeof i.out!="undefined"&&r!=="in"&&(r||i.key!==o)&&(c=s(n,i.out,o,a),n&&c))||t!=="directed"&&typeof i.undirected!="undefined"&&(c=s(n,i.undirected,o,a),n&&c))return c}function $d(n,t,e,r,i){const o=[];return La(!1,n,t,e,r,i,function(a){o.push(a)}),o}function Ud(n,t,e,r){let i=Gt.empty();return n!=="undirected"&&(typeof e.in!="undefined"&&t!=="out"&&r in e.in&&(i=Cr(i,ra(e.in,r))),typeof e.out!="undefined"&&t!=="in"&&r in e.out&&(t||e.key!==r)&&(i=Cr(i,ra(e.out,r)))),n!=="directed"&&typeof e.undirected!="undefined"&&r in e.undirected&&(i=Cr(i,ra(e.undirected,r))),i}function Nd(n,t){const{name:e,type:r,direction:i}=t;n.prototype[e]=function(o,a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return Fd(this,r);if(arguments.length===1){o=""+o;const s=this._nodes.get(o);if(typeof s=="undefined")throw new Z(`Graph.${e}: could not find the "${o}" node in the graph.`);return jd(this.multi,r==="mixed"?this.type:r,i,s)}if(arguments.length===2){o=""+o,a=""+a;const s=this._nodes.get(o);if(!s)throw new Z(`Graph.${e}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new Z(`Graph.${e}:  could not find the "${a}" target node in the graph.`);return $d(r,this.multi,i,s,a)}throw new te(`Graph.${e}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Md(n,t){const{name:e,type:r,direction:i}=t,o="forEach"+e[0].toUpperCase()+e.slice(1,-1);n.prototype[o]=function(l,f,p){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return p=l,nl(!1,this,r,p);if(arguments.length===2){l=""+l,p=f;const g=this._nodes.get(l);if(typeof g=="undefined")throw new Z(`Graph.${o}: could not find the "${l}" node in the graph.`);return Ca(!1,this.multi,r==="mixed"?this.type:r,i,g,p)}if(arguments.length===3){l=""+l,f=""+f;const g=this._nodes.get(l);if(!g)throw new Z(`Graph.${o}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(f))throw new Z(`Graph.${o}:  could not find the "${f}" target node in the graph.`);return La(!1,r,this.multi,i,g,f,p)}throw new te(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+e[0].toUpperCase()+e.slice(1);n.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),f=l.pop();let p;if(l.length===0){let g=0;r!=="directed"&&(g+=this.undirectedSize),r!=="undirected"&&(g+=this.directedSize),p=new Array(g);let v=0;l.push((m,E,S,C,L,O,x)=>{p[v++]=f(m,E,S,C,L,O,x)})}else p=[],l.push((g,v,m,E,S,C,L)=>{p.push(f(g,v,m,E,S,C,L))});return this[o].apply(this,l),p};const s="filter"+e[0].toUpperCase()+e.slice(1);n.prototype[s]=function(){const l=Array.prototype.slice.call(arguments),f=l.pop(),p=[];return l.push((g,v,m,E,S,C,L)=>{f(g,v,m,E,S,C,L)&&p.push(g)}),this[o].apply(this,l),p};const c="reduce"+e[0].toUpperCase()+e.slice(1);n.prototype[c]=function(){let l=Array.prototype.slice.call(arguments);if(l.length<2||l.length>4)throw new te(`Graph.${c}: invalid number of arguments (expecting 2, 3 or 4 and got ${l.length}).`);if(typeof l[l.length-1]=="function"&&typeof l[l.length-2]!="function")throw new te(`Graph.${c}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let f,p;l.length===2?(f=l[0],p=l[1],l=[]):l.length===3?(f=l[1],p=l[2],l=[l[0]]):l.length===4&&(f=l[2],p=l[3],l=[l[0],l[1]]);let g=p;return l.push((v,m,E,S,C,L,O)=>{g=f(g,v,m,E,S,C,L,O)}),this[o].apply(this,l),g}}function zd(n,t){const{name:e,type:r,direction:i}=t,o="find"+e[0].toUpperCase()+e.slice(1,-1);n.prototype[o]=function(c,l,f){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return f=c,nl(!0,this,r,f);if(arguments.length===2){c=""+c,f=l;const p=this._nodes.get(c);if(typeof p=="undefined")throw new Z(`Graph.${o}: could not find the "${c}" node in the graph.`);return Ca(!0,this.multi,r==="mixed"?this.type:r,i,p,f)}if(arguments.length===3){c=""+c,l=""+l;const p=this._nodes.get(c);if(!p)throw new Z(`Graph.${o}:  could not find the "${c}" source node in the graph.`);if(!this._nodes.has(l))throw new Z(`Graph.${o}:  could not find the "${l}" target node in the graph.`);return La(!0,r,this.multi,i,p,l,f)}throw new te(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+e[0].toUpperCase()+e.slice(1,-1);n.prototype[a]=function(){const c=Array.prototype.slice.call(arguments),l=c.pop();return c.push((p,g,v,m,E,S,C)=>l(p,g,v,m,E,S,C)),!!this[o].apply(this,c)};const s="every"+e[0].toUpperCase()+e.slice(1,-1);n.prototype[s]=function(){const c=Array.prototype.slice.call(arguments),l=c.pop();return c.push((p,g,v,m,E,S,C)=>!l(p,g,v,m,E,S,C)),!this[o].apply(this,c)}}function Bd(n,t){const{name:e,type:r,direction:i}=t,o=e.slice(0,-1)+"Entries";n.prototype[o]=function(a,s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Gt.empty();if(!arguments.length)return Id(this,r);if(arguments.length===1){a=""+a;const c=this._nodes.get(a);if(!c)throw new Z(`Graph.${o}: could not find the "${a}" node in the graph.`);return Gd(r,i,c)}if(arguments.length===2){a=""+a,s=""+s;const c=this._nodes.get(a);if(!c)throw new Z(`Graph.${o}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new Z(`Graph.${o}:  could not find the "${s}" target node in the graph.`);return Ud(r,i,c,s)}throw new te(`Graph.${o}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Wd(n){kd.forEach(t=>{Nd(n,t),Md(n,t),zd(n,t),Bd(n,t)})}const qd=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function So(){this.A=null,this.B=null}So.prototype.wrap=function(n){this.A===null?this.A=n:this.B===null&&(this.B=n)};So.prototype.has=function(n){return this.A!==null&&n in this.A||this.B!==null&&n in this.B};function hi(n,t,e,r,i){for(const o in r){const a=r[o],s=a.source,c=a.target,l=s===e?c:s;if(t&&t.has(l.key))continue;const f=i(l.key,l.attributes);if(n&&f)return l.key}}function Ta(n,t,e,r,i){if(t!=="mixed"){if(t==="undirected")return hi(n,null,r,r.undirected,i);if(typeof e=="string")return hi(n,null,r,r[e],i)}const o=new So;let a;if(t!=="undirected"){if(e!=="out"){if(a=hi(n,null,r,r.in,i),n&&a)return a;o.wrap(r.in)}if(e!=="in"){if(a=hi(n,o,r,r.out,i),n&&a)return a;o.wrap(r.out)}}if(t!=="directed"&&(a=hi(n,o,r,r.undirected,i),n&&a))return a}function Hd(n,t,e){if(n!=="mixed"){if(n==="undirected")return Object.keys(e.undirected);if(typeof t=="string")return Object.keys(e[t])}const r=[];return Ta(!1,n,t,e,function(i){r.push(i)}),r}function di(n,t,e){const r=Object.keys(e),i=r.length;let o=0;return new Gt(function(){let s=null;do{if(o>=i)return n&&n.wrap(e),{done:!0};const c=e[r[o++]],l=c.source,f=c.target;if(s=l===t?f:l,n&&n.has(s.key)){s=null;continue}}while(s===null);return{done:!1,value:{neighbor:s.key,attributes:s.attributes}}})}function Vd(n,t,e){if(n!=="mixed"){if(n==="undirected")return di(null,e,e.undirected);if(typeof t=="string")return di(null,e,e[t])}let r=Gt.empty();const i=new So;return n!=="undirected"&&(t!=="out"&&(r=Cr(r,di(i,e,e.in))),t!=="in"&&(r=Cr(r,di(i,e,e.out)))),n!=="directed"&&(r=Cr(r,di(i,e,e.undirected))),r}function Yd(n,t){const{name:e,type:r,direction:i}=t;n.prototype[e]=function(o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];o=""+o;const a=this._nodes.get(o);if(typeof a=="undefined")throw new Z(`Graph.${e}: could not find the "${o}" node in the graph.`);return Hd(r==="mixed"?this.type:r,i,a)}}function Kd(n,t){const{name:e,type:r,direction:i}=t,o="forEach"+e[0].toUpperCase()+e.slice(1,-1);n.prototype[o]=function(l,f){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;l=""+l;const p=this._nodes.get(l);if(typeof p=="undefined")throw new Z(`Graph.${o}: could not find the "${l}" node in the graph.`);Ta(!1,r==="mixed"?this.type:r,i,p,f)};const a="map"+e[0].toUpperCase()+e.slice(1);n.prototype[a]=function(l,f){const p=[];return this[o](l,(g,v)=>{p.push(f(g,v))}),p};const s="filter"+e[0].toUpperCase()+e.slice(1);n.prototype[s]=function(l,f){const p=[];return this[o](l,(g,v)=>{f(g,v)&&p.push(g)}),p};const c="reduce"+e[0].toUpperCase()+e.slice(1);n.prototype[c]=function(l,f,p){if(arguments.length<3)throw new te(`Graph.${c}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let g=p;return this[o](l,(v,m)=>{g=f(g,v,m)}),g}}function Zd(n,t){const{name:e,type:r,direction:i}=t,o=e[0].toUpperCase()+e.slice(1,-1),a="find"+o;n.prototype[a]=function(l,f){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;l=""+l;const p=this._nodes.get(l);if(typeof p=="undefined")throw new Z(`Graph.${a}: could not find the "${l}" node in the graph.`);return Ta(!0,r==="mixed"?this.type:r,i,p,f)};const s="some"+o;n.prototype[s]=function(l,f){return!!this[a](l,f)};const c="every"+o;n.prototype[c]=function(l,f){return!this[a](l,(g,v)=>!f(g,v))}}function Xd(n,t){const{name:e,type:r,direction:i}=t,o=e.slice(0,-1)+"Entries";n.prototype[o]=function(a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Gt.empty();a=""+a;const s=this._nodes.get(a);if(typeof s=="undefined")throw new Z(`Graph.${o}: could not find the "${a}" node in the graph.`);return Vd(r==="mixed"?this.type:r,i,s)}}function Qd(n){qd.forEach(t=>{Yd(n,t),Kd(n,t),Zd(n,t),Xd(n,t)})}function ro(n,t,e,r,i){const o=r._nodes.values(),a=r.type;let s,c,l,f,p,g,v;for(;s=o.next(),s.done!==!0;){let m=!1;if(c=s.value,a!=="undirected"){f=c.out;for(l in f){p=f[l];do{if(g=p.target,m=!0,v=i(c.key,g.key,c.attributes,g.attributes,p.key,p.attributes,p.undirected),n&&v)return p;p=p.next}while(p)}}if(a!=="directed"){f=c.undirected;for(l in f)if(!(t&&c.key>l)){p=f[l];do{if(g=p.target,g.key!==l&&(g=p.source),m=!0,v=i(c.key,g.key,c.attributes,g.attributes,p.key,p.attributes,p.undirected),n&&v)return p;p=p.next}while(p)}}if(e&&!m&&(v=i(c.key,null,c.attributes,null,null,null,null),n&&v))return null}}function Jd(n,t){const e={key:n};return Zu(t.attributes)||(e.attributes=_t({},t.attributes)),e}function ef(n,t,e){const r={key:t,source:e.source.key,target:e.target.key};return Zu(e.attributes)||(r.attributes=_t({},e.attributes)),n==="mixed"&&e.undirected&&(r.undirected=!0),r}function tf(n){if(!Lt(n))throw new te('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in n))throw new te("Graph.import: serialized node is missing its key.");if("attributes"in n&&(!Lt(n.attributes)||n.attributes===null))throw new te("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function rf(n){if(!Lt(n))throw new te('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in n))throw new te("Graph.import: serialized edge is missing its source.");if(!("target"in n))throw new te("Graph.import: serialized edge is missing its target.");if("attributes"in n&&(!Lt(n.attributes)||n.attributes===null))throw new te("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in n&&typeof n.undirected!="boolean")throw new te("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const nf=od(),of=new Set(["directed","undirected","mixed"]),Ns=new Set(["domain","_events","_eventsCount","_maxListeners"]),af=[{name:n=>`${n}Edge`,generateKey:!0},{name:n=>`${n}DirectedEdge`,generateKey:!0,type:"directed"},{name:n=>`${n}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:n=>`${n}EdgeWithKey`},{name:n=>`${n}DirectedEdgeWithKey`,type:"directed"},{name:n=>`${n}UndirectedEdgeWithKey`,type:"undirected"}],sf={allowSelfLoops:!0,multi:!1,type:"mixed"};function uf(n,t,e){if(e&&!Lt(e))throw new te(`Graph.addNode: invalid attributes. Expecting an object but got "${e}"`);if(t=""+t,e=e||{},n._nodes.has(t))throw new ve(`Graph.addNode: the "${t}" node already exist in the graph.`);const r=new n.NodeDataClass(t,e);return n._nodes.set(t,r),n.emit("nodeAdded",{key:t,attributes:e}),r}function Ms(n,t,e){const r=new n.NodeDataClass(t,e);return n._nodes.set(t,r),n.emit("nodeAdded",{key:t,attributes:e}),r}function il(n,t,e,r,i,o,a,s){if(!r&&n.type==="undirected")throw new ve(`Graph.${t}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&n.type==="directed")throw new ve(`Graph.${t}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!Lt(s))throw new te(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`);if(o=""+o,a=""+a,s=s||{},!n.allowSelfLoops&&o===a)throw new ve(`Graph.${t}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const c=n._nodes.get(o),l=n._nodes.get(a);if(!c)throw new Z(`Graph.${t}: source node "${o}" not found.`);if(!l)throw new Z(`Graph.${t}: target node "${a}" not found.`);const f={key:null,undirected:r,source:o,target:a,attributes:s};if(e)i=n._edgeKeyGenerator();else if(i=""+i,n._edges.has(i))throw new ve(`Graph.${t}: the "${i}" edge already exists in the graph.`);if(!n.multi&&(r?typeof c.undirected[a]!="undefined":typeof c.out[a]!="undefined"))throw new ve(`Graph.${t}: an edge linking "${o}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const p=new Pn(r,i,c,l,s);n._edges.set(i,p);const g=o===a;return r?(c.undirectedDegree++,l.undirectedDegree++,g&&(c.undirectedLoops++,n._undirectedSelfLoopCount++)):(c.outDegree++,l.inDegree++,g&&(c.directedLoops++,n._directedSelfLoopCount++)),n.multi?p.attachMulti():p.attach(),r?n._undirectedSize++:n._directedSize++,f.key=i,n.emit("edgeAdded",f),i}function lf(n,t,e,r,i,o,a,s,c){if(!r&&n.type==="undirected")throw new ve(`Graph.${t}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&n.type==="directed")throw new ve(`Graph.${t}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(c){if(typeof s!="function")throw new te(`Graph.${t}: invalid updater function. Expecting a function but got "${s}"`)}else if(!Lt(s))throw new te(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`)}o=""+o,a=""+a;let l;if(c&&(l=s,s=void 0),!n.allowSelfLoops&&o===a)throw new ve(`Graph.${t}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let f=n._nodes.get(o),p=n._nodes.get(a),g,v;if(!e&&(g=n._edges.get(i),g)){if((g.source.key!==o||g.target.key!==a)&&(!r||g.source.key!==a||g.target.key!==o))throw new ve(`Graph.${t}: inconsistency detected when attempting to merge the "${i}" edge with "${o}" source & "${a}" target vs. ("${g.source.key}", "${g.target.key}").`);v=g}if(!v&&!n.multi&&f&&(v=r?f.undirected[a]:f.out[a]),v){const L=[v.key,!1,!1,!1];if(c?!l:!s)return L;if(c){const O=v.attributes;v.attributes=l(O),n.emit("edgeAttributesUpdated",{type:"replace",key:v.key,attributes:v.attributes})}else _t(v.attributes,s),n.emit("edgeAttributesUpdated",{type:"merge",key:v.key,attributes:v.attributes,data:s});return L}s=s||{},c&&l&&(s=l(s));const m={key:null,undirected:r,source:o,target:a,attributes:s};if(e)i=n._edgeKeyGenerator();else if(i=""+i,n._edges.has(i))throw new ve(`Graph.${t}: the "${i}" edge already exists in the graph.`);let E=!1,S=!1;f||(f=Ms(n,o,{}),E=!0,o===a&&(p=f,S=!0)),p||(p=Ms(n,a,{}),S=!0),g=new Pn(r,i,f,p,s),n._edges.set(i,g);const C=o===a;return r?(f.undirectedDegree++,p.undirectedDegree++,C&&(f.undirectedLoops++,n._undirectedSelfLoopCount++)):(f.outDegree++,p.inDegree++,C&&(f.directedLoops++,n._directedSelfLoopCount++)),n.multi?g.attachMulti():g.attach(),r?n._undirectedSize++:n._directedSize++,m.key=i,n.emit("edgeAdded",m),[i,!0,E,S]}function gn(n,t){n._edges.delete(t.key);const{source:e,target:r,attributes:i}=t,o=t.undirected,a=e===r;o?(e.undirectedDegree--,r.undirectedDegree--,a&&(e.undirectedLoops--,n._undirectedSelfLoopCount--)):(e.outDegree--,r.inDegree--,a&&(e.directedLoops--,n._directedSelfLoopCount--)),n.multi?t.detachMulti():t.detach(),o?n._undirectedSize--:n._directedSize--,n.emit("edgeDropped",{key:t.key,attributes:i,source:e.key,target:r.key,undirected:o})}class ke extends _o.exports.EventEmitter{constructor(t){if(super(),t=_t({},sf,t),typeof t.multi!="boolean")throw new te(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${t.multi}".`);if(!of.has(t.type))throw new te(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${t.type}".`);if(typeof t.allowSelfLoops!="boolean")throw new te(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${t.allowSelfLoops}".`);const e=t.type==="mixed"?Xu:t.type==="directed"?Qu:Ju;qt(this,"NodeDataClass",e);const r="geid_"+nf()+"_";let i=0;const o=()=>{let a;do a=r+i++;while(this._edges.has(a));return a};qt(this,"_attributes",{}),qt(this,"_nodes",new Map),qt(this,"_edges",new Map),qt(this,"_directedSize",0),qt(this,"_undirectedSize",0),qt(this,"_directedSelfLoopCount",0),qt(this,"_undirectedSelfLoopCount",0),qt(this,"_edgeKeyGenerator",o),qt(this,"_options",t),Ns.forEach(a=>qt(this,a,this[a])),er(this,"order",()=>this._nodes.size),er(this,"size",()=>this._edges.size),er(this,"directedSize",()=>this._directedSize),er(this,"undirectedSize",()=>this._undirectedSize),er(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),er(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),er(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),er(this,"multi",this._options.multi),er(this,"type",this._options.type),er(this,"allowSelfLoops",this._options.allowSelfLoops),er(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(t){return this._nodes.has(""+t)}hasDirectedEdge(t,e){if(this.type==="undirected")return!1;if(arguments.length===1){const r=""+t,i=this._edges.get(r);return!!i&&!i.undirected}else if(arguments.length===2){t=""+t,e=""+e;const r=this._nodes.get(t);return r?r.out.hasOwnProperty(e):!1}throw new te(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(t,e){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+t,i=this._edges.get(r);return!!i&&i.undirected}else if(arguments.length===2){t=""+t,e=""+e;const r=this._nodes.get(t);return r?r.undirected.hasOwnProperty(e):!1}throw new te(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(t,e){if(arguments.length===1){const r=""+t;return this._edges.has(r)}else if(arguments.length===2){t=""+t,e=""+e;const r=this._nodes.get(t);return r?typeof r.out!="undefined"&&r.out.hasOwnProperty(e)||typeof r.undirected!="undefined"&&r.undirected.hasOwnProperty(e):!1}throw new te(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(t,e){if(this.type==="undirected")return;if(t=""+t,e=""+e,this.multi)throw new ve("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const r=this._nodes.get(t);if(!r)throw new Z(`Graph.directedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new Z(`Graph.directedEdge: could not find the "${e}" target node in the graph.`);const i=r.out&&r.out[e]||void 0;if(i)return i.key}undirectedEdge(t,e){if(this.type==="directed")return;if(t=""+t,e=""+e,this.multi)throw new ve("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(t);if(!r)throw new Z(`Graph.undirectedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new Z(`Graph.undirectedEdge: could not find the "${e}" target node in the graph.`);const i=r.undirected&&r.undirected[e]||void 0;if(i)return i.key}edge(t,e){if(this.multi)throw new ve("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new Z(`Graph.edge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new Z(`Graph.edge: could not find the "${e}" target node in the graph.`);const i=r.out&&r.out[e]||r.undirected&&r.undirected[e]||void 0;if(i)return i.key}areDirectedNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new Z(`Graph.areDirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in r.in||e in r.out}areOutNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new Z(`Graph.areOutNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in r.out}areInNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new Z(`Graph.areInNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in r.in}areUndirectedNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new Z(`Graph.areUndirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="directed"?!1:e in r.undirected}areNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new Z(`Graph.areNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&(e in r.in||e in r.out)||this.type!=="directed"&&e in r.undirected}areInboundNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new Z(`Graph.areInboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&e in r.in||this.type!=="directed"&&e in r.undirected}areOutboundNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new Z(`Graph.areOutboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&e in r.out||this.type!=="directed"&&e in r.undirected}inDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.inDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree}outDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.outDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.outDegree}directedDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.directedDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree+e.outDegree}undirectedDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.undirectedDegree: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:e.undirectedDegree}inboundDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.inboundDegree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=e.undirectedDegree),this.type!=="undirected"&&(r+=e.inDegree),r}outboundDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.outboundDegree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=e.undirectedDegree),this.type!=="undirected"&&(r+=e.outDegree),r}degree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.degree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=e.undirectedDegree),this.type!=="undirected"&&(r+=e.inDegree+e.outDegree),r}inDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.inDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree-e.directedLoops}outDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.outDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.outDegree-e.directedLoops}directedDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.directedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree+e.outDegree-e.directedLoops*2}undirectedDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:e.undirectedDegree-e.undirectedLoops*2}inboundDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=e.undirectedDegree,i+=e.undirectedLoops*2),this.type!=="undirected"&&(r+=e.inDegree,i+=e.directedLoops),r-i}outboundDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=e.undirectedDegree,i+=e.undirectedLoops*2),this.type!=="undirected"&&(r+=e.outDegree,i+=e.directedLoops),r-i}degreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.degreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=e.undirectedDegree,i+=e.undirectedLoops*2),this.type!=="undirected"&&(r+=e.inDegree+e.outDegree,i+=e.directedLoops*2),r-i}source(t){t=""+t;const e=this._edges.get(t);if(!e)throw new Z(`Graph.source: could not find the "${t}" edge in the graph.`);return e.source.key}target(t){t=""+t;const e=this._edges.get(t);if(!e)throw new Z(`Graph.target: could not find the "${t}" edge in the graph.`);return e.target.key}extremities(t){t=""+t;const e=this._edges.get(t);if(!e)throw new Z(`Graph.extremities: could not find the "${t}" edge in the graph.`);return[e.source.key,e.target.key]}opposite(t,e){t=""+t,e=""+e;const r=this._edges.get(e);if(!r)throw new Z(`Graph.opposite: could not find the "${e}" edge in the graph.`);const i=r.source.key,o=r.target.key;if(t===i)return o;if(t===o)return i;throw new Z(`Graph.opposite: the "${t}" node is not attached to the "${e}" edge (${i}, ${o}).`)}hasExtremity(t,e){t=""+t,e=""+e;const r=this._edges.get(t);if(!r)throw new Z(`Graph.hasExtremity: could not find the "${t}" edge in the graph.`);return r.source.key===e||r.target.key===e}isUndirected(t){t=""+t;const e=this._edges.get(t);if(!e)throw new Z(`Graph.isUndirected: could not find the "${t}" edge in the graph.`);return e.undirected}isDirected(t){t=""+t;const e=this._edges.get(t);if(!e)throw new Z(`Graph.isDirected: could not find the "${t}" edge in the graph.`);return!e.undirected}isSelfLoop(t){t=""+t;const e=this._edges.get(t);if(!e)throw new Z(`Graph.isSelfLoop: could not find the "${t}" edge in the graph.`);return e.source===e.target}addNode(t,e){return uf(this,t,e).key}mergeNode(t,e){if(e&&!Lt(e))throw new te(`Graph.mergeNode: invalid attributes. Expecting an object but got "${e}"`);t=""+t,e=e||{};let r=this._nodes.get(t);return r?(e&&(_t(r.attributes,e),this.emit("nodeAttributesUpdated",{type:"merge",key:t,attributes:r.attributes,data:e})),[t,!1]):(r=new this.NodeDataClass(t,e),this._nodes.set(t,r),this.emit("nodeAdded",{key:t,attributes:e}),[t,!0])}updateNode(t,e){if(e&&typeof e!="function")throw new te(`Graph.updateNode: invalid updater function. Expecting a function but got "${e}"`);t=""+t;let r=this._nodes.get(t);if(r){if(e){const o=r.attributes;r.attributes=e(o),this.emit("nodeAttributesUpdated",{type:"replace",key:t,attributes:r.attributes})}return[t,!1]}const i=e?e({}):{};return r=new this.NodeDataClass(t,i),this._nodes.set(t,r),this.emit("nodeAdded",{key:t,attributes:i}),[t,!0]}dropNode(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new Z(`Graph.dropNode: could not find the "${t}" node in the graph.`);let r;if(this.type!=="undirected"){for(const i in e.out){r=e.out[i];do gn(this,r),r=r.next;while(r)}for(const i in e.in){r=e.in[i];do gn(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const i in e.undirected){r=e.undirected[i];do gn(this,r),r=r.next;while(r)}this._nodes.delete(t),this.emit("nodeDropped",{key:t,attributes:e.attributes})}dropEdge(t){let e;if(arguments.length>1){const r=""+arguments[0],i=""+arguments[1];if(e=Kt(this,r,i,this.type),!e)throw new Z(`Graph.dropEdge: could not find the "${r}" -> "${i}" edge in the graph.`)}else if(t=""+t,e=this._edges.get(t),!e)throw new Z(`Graph.dropEdge: could not find the "${t}" edge in the graph.`);return gn(this,e),this}dropDirectedEdge(t,e){if(arguments.length<2)throw new ve("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new ve("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");t=""+t,e=""+e;const r=Kt(this,t,e,"directed");if(!r)throw new Z(`Graph.dropDirectedEdge: could not find a "${t}" -> "${e}" edge in the graph.`);return gn(this,r),this}dropUndirectedEdge(t,e){if(arguments.length<2)throw new ve("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new ve("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=Kt(this,t,e,"undirected");if(!r)throw new Z(`Graph.dropUndirectedEdge: could not find a "${t}" -> "${e}" edge in the graph.`);return gn(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const t=this._nodes.values();let e;for(;e=t.next(),e.done!==!0;)e.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(t){return this._attributes[t]}getAttributes(){return this._attributes}hasAttribute(t){return this._attributes.hasOwnProperty(t)}setAttribute(t,e){return this._attributes[t]=e,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}updateAttribute(t,e){if(typeof e!="function")throw new te("Graph.updateAttribute: updater should be a function.");const r=this._attributes[t];return this._attributes[t]=e(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}removeAttribute(t){return delete this._attributes[t],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:t}),this}replaceAttributes(t){if(!Lt(t))throw new te("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=t,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(t){if(!Lt(t))throw new te("Graph.mergeAttributes: provided attributes are not a plain object.");return _t(this._attributes,t),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:t}),this}updateAttributes(t){if(typeof t!="function")throw new te("Graph.updateAttributes: provided updater is not a function.");return this._attributes=t(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(t,e){if(typeof t!="function")throw new te("Graph.updateEachNodeAttributes: expecting an updater function.");if(e&&!Us(e))throw new te("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.values();let i,o;for(;i=r.next(),i.done!==!0;)o=i.value,o.attributes=t(o.key,o.attributes);this.emit("eachNodeAttributesUpdated",{hints:e||null})}updateEachEdgeAttributes(t,e){if(typeof t!="function")throw new te("Graph.updateEachEdgeAttributes: expecting an updater function.");if(e&&!Us(e))throw new te("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let i,o,a,s;for(;i=r.next(),i.done!==!0;)o=i.value,a=o.source,s=o.target,o.attributes=t(o.key,o.attributes,a.key,s.key,a.attributes,s.attributes,o.undirected);this.emit("eachEdgeAttributesUpdated",{hints:e||null})}forEachAdjacencyEntry(t){if(typeof t!="function")throw new te("Graph.forEachAdjacencyEntry: expecting a callback.");ro(!1,!1,!1,this,t)}forEachAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new te("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");ro(!1,!1,!0,this,t)}forEachAssymetricAdjacencyEntry(t){if(typeof t!="function")throw new te("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");ro(!1,!0,!1,this,t)}forEachAssymetricAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new te("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");ro(!1,!0,!0,this,t)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):Ku(this._nodes.keys(),this._nodes.size)}forEachNode(t){if(typeof t!="function")throw new te("Graph.forEachNode: expecting a callback.");const e=this._nodes.values();let r,i;for(;r=e.next(),r.done!==!0;)i=r.value,t(i.key,i.attributes)}findNode(t){if(typeof t!="function")throw new te("Graph.findNode: expecting a callback.");const e=this._nodes.values();let r,i;for(;r=e.next(),r.done!==!0;)if(i=r.value,t(i.key,i.attributes))return i.key}mapNodes(t){if(typeof t!="function")throw new te("Graph.mapNode: expecting a callback.");const e=this._nodes.values();let r,i;const o=new Array(this.order);let a=0;for(;r=e.next(),r.done!==!0;)i=r.value,o[a++]=t(i.key,i.attributes);return o}someNode(t){if(typeof t!="function")throw new te("Graph.someNode: expecting a callback.");const e=this._nodes.values();let r,i;for(;r=e.next(),r.done!==!0;)if(i=r.value,t(i.key,i.attributes))return!0;return!1}everyNode(t){if(typeof t!="function")throw new te("Graph.everyNode: expecting a callback.");const e=this._nodes.values();let r,i;for(;r=e.next(),r.done!==!0;)if(i=r.value,!t(i.key,i.attributes))return!1;return!0}filterNodes(t){if(typeof t!="function")throw new te("Graph.filterNodes: expecting a callback.");const e=this._nodes.values();let r,i;const o=[];for(;r=e.next(),r.done!==!0;)i=r.value,t(i.key,i.attributes)&&o.push(i.key);return o}reduceNodes(t,e){if(typeof t!="function")throw new te("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new te("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let r=e;const i=this._nodes.values();let o,a;for(;o=i.next(),o.done!==!0;)a=o.value,r=t(r,a.key,a.attributes);return r}nodeEntries(){const t=this._nodes.values();return new Gt(()=>{const e=t.next();if(e.done)return e;const r=e.value;return{value:{node:r.key,attributes:r.attributes},done:!1}})}export(){const t=new Array(this._nodes.size);let e=0;this._nodes.forEach((i,o)=>{t[e++]=Jd(o,i)});const r=new Array(this._edges.size);return e=0,this._edges.forEach((i,o)=>{r[e++]=ef(this.type,o,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:t,edges:r}}import(t,e=!1){if(t instanceof ke)return t.forEachNode((c,l)=>{e?this.mergeNode(c,l):this.addNode(c,l)}),t.forEachEdge((c,l,f,p,g,v,m)=>{e?m?this.mergeUndirectedEdgeWithKey(c,f,p,l):this.mergeDirectedEdgeWithKey(c,f,p,l):m?this.addUndirectedEdgeWithKey(c,f,p,l):this.addDirectedEdgeWithKey(c,f,p,l)}),this;if(!Lt(t))throw new te("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(t.attributes){if(!Lt(t.attributes))throw new te("Graph.import: invalid attributes. Expecting a plain object.");e?this.mergeAttributes(t.attributes):this.replaceAttributes(t.attributes)}let r,i,o,a,s;if(t.nodes){if(o=t.nodes,!Array.isArray(o))throw new te("Graph.import: invalid nodes. Expecting an array.");for(r=0,i=o.length;r<i;r++){a=o[r],tf(a);const{key:c,attributes:l}=a;e?this.mergeNode(c,l):this.addNode(c,l)}}if(t.edges){let c=!1;if(this.type==="undirected"&&(c=!0),o=t.edges,!Array.isArray(o))throw new te("Graph.import: invalid edges. Expecting an array.");for(r=0,i=o.length;r<i;r++){s=o[r],rf(s);const{source:l,target:f,attributes:p,undirected:g=c}=s;let v;"key"in s?(v=e?g?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:g?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,v.call(this,s.key,l,f,p)):(v=e?g?this.mergeUndirectedEdge:this.mergeDirectedEdge:g?this.addUndirectedEdge:this.addDirectedEdge,v.call(this,l,f,p))}}return this}nullCopy(t){const e=new ke(_t({},this._options,t));return e.replaceAttributes(_t({},this.getAttributes())),e}emptyCopy(t){const e=this.nullCopy(t);return this._nodes.forEach((r,i)=>{const o=_t({},r.attributes);r=new e.NodeDataClass(i,o),e._nodes.set(i,r)}),e}copy(t){if(t=t||{},typeof t.type=="string"&&t.type!==this.type&&t.type!=="mixed")throw new ve(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${t.type}" because this would mean losing information about the current graph.`);if(typeof t.multi=="boolean"&&t.multi!==this.multi&&t.multi!==!0)throw new ve("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof t.allowSelfLoops=="boolean"&&t.allowSelfLoops!==this.allowSelfLoops&&t.allowSelfLoops!==!0)throw new ve("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const e=this.emptyCopy(t),r=this._edges.values();let i,o;for(;i=r.next(),i.done!==!0;)o=i.value,il(e,"copy",!1,o.undirected,o.key,o.source.key,o.target.key,_t({},o.attributes));return e}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const t={};this._nodes.forEach((o,a)=>{t[a]=o.attributes});const e={},r={};this._edges.forEach((o,a)=>{const s=o.undirected?"--":"->";let c="",l=o.source.key,f=o.target.key,p;o.undirected&&l>f&&(p=l,l=f,f=p);const g=`(${l})${s}(${f})`;a.startsWith("geid_")?this.multi&&(typeof r[g]=="undefined"?r[g]=0:r[g]++,c+=`${r[g]}. `):c+=`[${a}]: `,c+=g,e[c]=o.attributes});const i={};for(const o in this)this.hasOwnProperty(o)&&!Ns.has(o)&&typeof this[o]!="function"&&typeof o!="symbol"&&(i[o]=this[o]);return i.attributes=this._attributes,i.nodes=t,i.edges=e,qt(i,"constructor",this.constructor),i}}typeof Symbol!="undefined"&&(ke.prototype[Symbol.for("nodejs.util.inspect.custom")]=ke.prototype.inspect);af.forEach(n=>{["add","merge","update"].forEach(t=>{const e=n.name(t),r=t==="add"?il:lf;n.generateKey?ke.prototype[e]=function(i,o,a){return r(this,e,!0,(n.type||this.type)==="undirected",null,i,o,a,t==="update")}:ke.prototype[e]=function(i,o,a,s){return r(this,e,!1,(n.type||this.type)==="undirected",i,o,a,s,t==="update")}})});md(ke);Od(ke);Wd(ke);Qd(ke);class ol extends ke{constructor(t){const e=_t({type:"directed"},t);if("multi"in e&&e.multi!==!1)throw new te("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(e.type!=="directed")throw new te('DirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class al extends ke{constructor(t){const e=_t({type:"undirected"},t);if("multi"in e&&e.multi!==!1)throw new te("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(e.type!=="undirected")throw new te('UndirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class sl extends ke{constructor(t){const e=_t({multi:!0},t);if("multi"in e&&e.multi!==!0)throw new te("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(e)}}class ul extends ke{constructor(t){const e=_t({type:"directed",multi:!0},t);if("multi"in e&&e.multi!==!0)throw new te("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(e.type!=="directed")throw new te('MultiDirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class ll extends ke{constructor(t){const e=_t({type:"undirected",multi:!0},t);if("multi"in e&&e.multi!==!0)throw new te("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(e.type!=="undirected")throw new te('MultiUndirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}function Rn(n){n.from=function(t,e){const r=_t({},t.options,e),i=new n(r);return i.import(t),i}}Rn(ke);Rn(ol);Rn(al);Rn(sl);Rn(ul);Rn(ll);ke.Graph=ke;ke.DirectedGraph=ol;ke.UndirectedGraph=al;ke.MultiGraph=sl;ke.MultiDirectedGraph=ul;ke.MultiUndirectedGraph=ll;ke.InvalidArgumentsGraphError=te;ke.NotFoundGraphError=Z;ke.UsageGraphError=ve;function cf(n){return!n||typeof n!="object"||typeof n=="function"||Array.isArray(n)||n instanceof Set||n instanceof Map||n instanceof RegExp||n instanceof Date}function cl(n,t){n=n||{};var e={};for(var r in t){var i=n[r],o=t[r];if(!cf(o)){e[r]=cl(i,o);continue}i===void 0?e[r]=o:e[r]=i}return e}var hf=cl,on=function(t){return t!==null&&typeof t=="object"&&typeof t.addUndirectedEdgeWithKey=="function"&&typeof t.dropNode=="function"&&typeof t.multi=="boolean"},df=hf,ff=on,pf={dimensions:["x","y"],center:.5,rng:Math.random,scale:1};function hl(n,t,e){if(!ff(t))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");e=df(e,pf);var r=e.dimensions;if(!Array.isArray(r)||r.length<1)throw new Error("graphology-layout/random: given dimensions are invalid.");var i=r.length,o=e.center,a=e.rng,s=e.scale,c=(o-.5)*s;function l(p){for(var g=0;g<i;g++)p[r[g]]=a()*s+c;return p}if(!n){var f={};return t.forEachNode(function(p){f[p]=l({})}),f}t.updateEachNodeAttributes(function(p,g){return l(g),g},{attributes:r})}var dl=hl.bind(null,!1);dl.assign=hl.bind(null,!0);var gf=dl,Fn={},fl=Ao,vf=fl.ARRAY_BUFFER_SUPPORT,mf=fl.SYMBOL_SUPPORT,Oa=function(t,e){var r,i,o,a,s;if(!t)throw new Error("obliterator/forEach: invalid iterable.");if(typeof e!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(t)||vf&&ArrayBuffer.isView(t)||typeof t=="string"||t.toString()==="[object Arguments]"){for(o=0,a=t.length;o<a;o++)e(t[o],o);return}if(typeof t.forEach=="function"){t.forEach(e);return}if(mf&&Symbol.iterator in t&&typeof t.next!="function"&&(t=t[Symbol.iterator]()),typeof t.next=="function"){for(r=t,o=0;s=r.next(),s.done!==!0;)e(s.value,o),o++;return}for(i in t)t.hasOwnProperty(i)&&e(t[i],i)},pl=Gt,yf=Oa;function dt(){this.clear()}dt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};dt.prototype.enqueue=function(n){return this.items.push(n),++this.size};dt.prototype.dequeue=function(){if(!!this.size){var n=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,n}};dt.prototype.peek=function(){if(!!this.size)return this.items[this.offset]};dt.prototype.forEach=function(n,t){t=arguments.length>1?t:this;for(var e=this.offset,r=0,i=this.items.length;e<i;e++,r++)n.call(t,this.items[e],r,this)};dt.prototype.toArray=function(){return this.items.slice(this.offset)};dt.prototype.values=function(){var n=this.items,t=this.offset;return new pl(function(){if(t>=n.length)return{done:!0};var e=n[t];return t++,{value:e,done:!1}})};dt.prototype.entries=function(){var n=this.items,t=this.offset,e=0;return new pl(function(){if(t>=n.length)return{done:!0};var r=n[t];return t++,{value:[e++,r],done:!1}})};typeof Symbol!="undefined"&&(dt.prototype[Symbol.iterator]=dt.prototype.values);dt.prototype.toString=function(){return this.toArray().join(",")};dt.prototype.toJSON=function(){return this.toArray()};dt.prototype.inspect=function(){var n=this.toArray();return Object.defineProperty(n,"constructor",{value:dt,enumerable:!1}),n};typeof Symbol!="undefined"&&(dt.prototype[Symbol.for("nodejs.util.inspect.custom")]=dt.prototype.inspect);dt.from=function(n){var t=new dt;return yf(n,function(e){t.enqueue(e)}),t};dt.of=function(){return dt.from(arguments)};var bf=dt,gl=function(t,e){var r=e.length;if(r!==0){var i=t.length;t.length+=r;for(var o=0;o<r;o++)t[i+o]=e[o]}},ka=on,wf=bf,_f=gl;function Ef(n,t,e){if(!ka(n))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!n.hasNode(t))throw new Error('graphology-shortest-path: the "'+t+'" source node does not exist in the given graph.');if(!n.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" target node does not exist in the given graph.');if(t=""+t,e=""+e,t===e)return[t];var r=n.inboundNeighbors.bind(n),i=n.outboundNeighbors.bind(n),o={},a={};o[t]=null,a[e]=null;var s=[t],c=[e],l,f,p,g,v,m,E,S,C=!1;e:for(;s.length&&c.length;)if(s.length<=c.length){for(l=s,s=[],v=0,E=l.length;v<E;v++)for(f=l[v],p=i(f),m=0,S=p.length;m<S;m++)if(g=p[m],g in o||(s.push(g),o[g]=f),g in a){C=!0;break e}}else for(l=c,c=[],v=0,E=l.length;v<E;v++)for(f=l[v],p=r(f),m=0,S=p.length;m<S;m++)if(g=p[m],g in a||(c.push(g),a[g]=f),g in o){C=!0;break e}if(!C)return null;for(var L=[];g;)L.unshift(g),g=o[g];for(g=a[L[L.length-1]];g;)L.push(g),g=a[g];return L.length?L:null}function Af(n,t){if(!ka(n))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!n.hasNode(t))throw new Error('graphology-shortest-path: the "'+t+'" source node does not exist in the given graph.');t=""+t;var e={},r={},i,o,a,s,c,l;for(e[t]=!0,r[t]=[t];Object.keys(e).length;){i=e,e={};for(a in i)for(o=n.outboundNeighbors(a),c=0,l=o.length;c<l;c++)s=o[c],r[s]||(r[s]=r[a].concat(s),e[s]=!0)}return r}function vl(n,t,e){if(!ka(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');e=""+e;var r=new Set,i={},o=0;i[e]=0;for(var a=[e],s,c,l;a.length!==0;){var f=[];for(s=0,c=a.length;s<c;s++)l=a[s],!r.has(l)&&(r.add(l),_f(f,t[n](l)),i[l]=o);o++,a=f}return i}var Sf=vl.bind(null,"outboundNeighbors"),Cf=vl.bind(null,"neighbors");function Lf(n,t){t=""+t;var e=[],r={},i={},o=n.nodes(),a,s,c,l,f,p,g,v,m;for(p=0,v=o.length;p<v;p++)l=o[p],r[l]=[],i[l]=0;var E={};i[t]=1,E[t]=0;for(var S=wf.of(t);S.size;)for(l=S.dequeue(),e.push(l),a=E[l],s=i[l],c=n.outboundNeighbors(l),g=0,m=c.length;g<m;g++)f=c[g],f in E||(S.enqueue(f),E[f]=a+1),E[f]===a+1&&(i[f]+=s,r[f].push(l));return[e,r,i]}Fn.bidirectional=Ef;Fn.singleSource=Af;Fn.singleSourceLength=Sf;Fn.undirectedSingleSourceLength=Cf;Fn.brandes=Lf;var ml={},zs=function(){return!0};ml.edgePathFromNodePath=function(n,t){var e=t.length,r,i,o,a;if(e<2)return i=t[0],a=n.multi?n.findEdge(i,i,zs):n.edge(i,i),a?[a]:[];e--;var s=new Array(e);for(r=0;r<e;r++){if(i=t[r],o=t[r+1],a=n.multi?n.findOutboundEdge(i,o,zs):n.edge(i,o),a===void 0)throw new Error("graphology-shortest-path: given path is impossible in given graph.");s[r]=a}return s};var Co={},In={};function Tf(n){return typeof n!="number"||isNaN(n)?1:n}function Of(n,t){var e={},r=function(a){return typeof a=="undefined"?t:a};typeof t=="function"&&(r=t);var i=function(a){return r(a[n])},o=function(){return r(void 0)};return typeof n=="string"?(e.fromAttributes=i,e.fromGraph=function(a,s){return i(a.getNodeAttributes(s))},e.fromEntry=function(a,s){return i(s)}):typeof n=="function"?(e.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},e.fromGraph=function(a,s){return r(n(s,a.getNodeAttributes(s)))},e.fromEntry=function(a,s){return r(n(a,s))}):(e.fromAttributes=o,e.fromGraph=o,e.fromEntry=o),e}function yl(n,t){var e={},r=function(a){return typeof a=="undefined"?t:a};typeof t=="function"&&(r=t);var i=function(a){return r(a[n])},o=function(){return r(void 0)};return typeof n=="string"?(e.fromAttributes=i,e.fromGraph=function(a,s){return i(a.getEdgeAttributes(s))},e.fromEntry=function(a,s){return i(s)},e.fromPartialEntry=e.fromEntry,e.fromMinimalEntry=e.fromEntry):typeof n=="function"?(e.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},e.fromGraph=function(a,s){var c=a.extremities(s);return r(n(s,a.getEdgeAttributes(s),c[0],c[1],a.getNodeAttributes(c[0]),a.getNodeAttributes(c[1]),a.isUndirected(s)))},e.fromEntry=function(a,s,c,l,f,p,g){return r(n(a,s,c,l,f,p,g))},e.fromPartialEntry=function(a,s,c,l){return r(n(a,s,c,l))},e.fromMinimalEntry=function(a,s){return r(n(a,s))}):(e.fromAttributes=o,e.fromGraph=o,e.fromEntry=o,e.fromMinimalEntry=o),e}In.createNodeValueGetter=Of;In.createEdgeValueGetter=yl;In.createEdgeWeightGetter=function(n){return yl(n,Tf)};var Ci={},kf=function(n,t){return n<t?-1:n>t?1:0},xf=function(n,t){return n<t?1:n>t?-1:0};function Df(n){return function(t,e){return n(e,t)}}function Pf(n){return n===2?function(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:t[1]<e[1]?-1:t[1]>e[1]?1:0}:function(t,e){for(var r=0;r<n;){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1;r++}return 0}}Ci.DEFAULT_COMPARATOR=kf;Ci.DEFAULT_REVERSE_COMPARATOR=xf;Ci.reverseComparator=Df;Ci.createTupleComparator=Pf;var Li={},bl={};(function(n){var t=Math.pow(2,8)-1,e=Math.pow(2,16)-1,r=Math.pow(2,32)-1,i=Math.pow(2,7)-1,o=Math.pow(2,15)-1,a=Math.pow(2,31)-1;n.getPointerArray=function(c){var l=c-1;if(l<=t)return Uint8Array;if(l<=e)return Uint16Array;if(l<=r)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")},n.getSignedPointerArray=function(c){var l=c-1;return l<=i?Int8Array:l<=o?Int16Array:l<=a?Int32Array:Float64Array},n.getNumberType=function(c){return c===(c|0)?Math.sign(c)===-1?c<=127&&c>=-128?Int8Array:c<=32767&&c>=-32768?Int16Array:Int32Array:c<=255?Uint8Array:c<=65535?Uint16Array:Uint32Array:Float64Array};var s={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};n.getMinimalRepresentation=function(c,l){var f=null,p=0,g,v,m,E,S;for(E=0,S=c.length;E<S;E++)m=l?l(c[E]):c[E],v=n.getNumberType(m),g=s[v.name],g>p&&(p=g,f=v);return f},n.isTypedArray=function(c){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView(c)},n.concat=function(){var c=0,l,f,p;for(l=0,p=arguments.length;l<p;l++)c+=arguments[l].length;var g=new arguments[0].constructor(c);for(l=0,f=0;l<p;l++)g.set(arguments[l],f),f+=arguments[l].length;return g},n.indices=function(c){for(var l=n.getPointerArray(c),f=new l(c),p=0;p<c;p++)f[p]=p;return f}})(bl);var wl=Oa,_l=bl;function Rf(n){return Array.isArray(n)||_l.isTypedArray(n)}function xa(n){if(typeof n.length=="number")return n.length;if(typeof n.size=="number")return n.size}function Ff(n){var t=xa(n),e=typeof t=="number"?new Array(t):[],r=0;return wl(n,function(i){e[r++]=i}),e}function If(n){var t=xa(n),e=typeof t=="number"?_l.getPointerArray(t):Array,r=typeof t=="number"?new Array(t):[],i=typeof t=="number"?new e(t):[],o=0;return wl(n,function(a){r[o]=a,i[o]=o++}),[r,i]}Li.isArrayLike=Rf;Li.guessLength=xa;Li.toArray=Ff;Li.toArrayWithIndices=If;var go=Oa,El=Ci,dr=Li,Lo=El.DEFAULT_COMPARATOR,Da=El.reverseComparator;function Pa(n,t,e,r){for(var i=t[r],o,a;r>e;){if(o=r-1>>1,a=t[o],n(i,a)<0){t[r]=a,r=o;continue}break}t[r]=i}function Ti(n,t,e){for(var r=t.length,i=e,o=t[e],a=2*e+1,s;a<r;)s=a+1,s<r&&n(t[a],t[s])>=0&&(a=s),t[e]=t[a],e=a,a=2*e+1;t[e]=o,Pa(n,t,i,e)}function Al(n,t,e){t.push(e),Pa(n,t,0,t.length-1)}function Ra(n,t){var e=t.pop();if(t.length!==0){var r=t[0];return t[0]=e,Ti(n,t,0),r}return e}function An(n,t,e){if(t.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var r=t[0];return t[0]=e,Ti(n,t,0),r}function Sl(n,t,e){var r;return t.length!==0&&n(t[0],e)<0&&(r=t[0],t[0]=e,e=r,Ti(n,t,0)),e}function tn(n,t){for(var e=t.length,r=e>>1,i=r;--i>=0;)Ti(n,t,i)}function Fa(n,t){for(var e=t.length,r=0,i=new Array(e);r<e;)i[r++]=Ra(n,t);return i}function jf(n,t,e){arguments.length===2&&(e=t,t=n,n=Lo);var r=Da(n),i,o,a,s=1/0,c;if(t===1){if(dr.isArrayLike(e)){for(i=0,o=e.length;i<o;i++)a=e[i],(s===1/0||n(a,s)<0)&&(s=a);return c=new e.constructor(1),c[0]=s,c}return go(e,function(f){(s===1/0||n(f,s)<0)&&(s=f)}),[s]}if(dr.isArrayLike(e)){if(t>=e.length)return e.slice().sort(n);for(c=e.slice(0,t),tn(r,c),i=t,o=e.length;i<o;i++)r(e[i],c[0])>0&&An(r,c,e[i]);return c.sort(n)}var l=dr.guessLength(e);return l!==null&&l<t&&(t=l),c=new Array(t),i=0,go(e,function(f){i<t?c[i]=f:(i===t&&tn(r,c),r(f,c[0])>0&&An(r,c,f)),i++}),c.length>i&&(c.length=i),c.sort(n)}function Gf(n,t,e){arguments.length===2&&(e=t,t=n,n=Lo);var r=Da(n),i,o,a,s=-1/0,c;if(t===1){if(dr.isArrayLike(e)){for(i=0,o=e.length;i<o;i++)a=e[i],(s===-1/0||n(a,s)>0)&&(s=a);return c=new e.constructor(1),c[0]=s,c}return go(e,function(f){(s===-1/0||n(f,s)>0)&&(s=f)}),[s]}if(dr.isArrayLike(e)){if(t>=e.length)return e.slice().sort(r);for(c=e.slice(0,t),tn(n,c),i=t,o=e.length;i<o;i++)n(e[i],c[0])>0&&An(n,c,e[i]);return c.sort(r)}var l=dr.guessLength(e);return l!==null&&l<t&&(t=l),c=new Array(t),i=0,go(e,function(f){i<t?c[i]=f:(i===t&&tn(n,c),n(f,c[0])>0&&An(n,c,f)),i++}),c.length>i&&(c.length=i),c.sort(r)}function He(n){if(this.clear(),this.comparator=n||Lo,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}He.prototype.clear=function(){this.items=[],this.size=0};He.prototype.push=function(n){return Al(this.comparator,this.items,n),++this.size};He.prototype.peek=function(){return this.items[0]};He.prototype.pop=function(){return this.size!==0&&this.size--,Ra(this.comparator,this.items)};He.prototype.replace=function(n){return An(this.comparator,this.items,n)};He.prototype.pushpop=function(n){return Sl(this.comparator,this.items,n)};He.prototype.consume=function(){return this.size=0,Fa(this.comparator,this.items)};He.prototype.toArray=function(){return Fa(this.comparator,this.items.slice())};He.prototype.inspect=function(){var n=this.toArray();return Object.defineProperty(n,"constructor",{value:He,enumerable:!1}),n};typeof Symbol!="undefined"&&(He.prototype[Symbol.for("nodejs.util.inspect.custom")]=He.prototype.inspect);function vo(n){if(this.clear(),this.comparator=n||Lo,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=Da(this.comparator)}vo.prototype=He.prototype;He.from=function(n,t){var e=new He(t),r;return dr.isArrayLike(n)?r=n.slice():r=dr.toArray(n),tn(e.comparator,r),e.items=r,e.size=r.length,e};vo.from=function(n,t){var e=new vo(t),r;return dr.isArrayLike(n)?r=n.slice():r=dr.toArray(n),tn(e.comparator,r),e.items=r,e.size=r.length,e};He.siftUp=Ti;He.siftDown=Pa;He.push=Al;He.pop=Ra;He.replace=An;He.pushpop=Sl;He.heapify=tn;He.consume=Fa;He.nsmallest=jf;He.nlargest=Gf;He.MinHeap=He;He.MaxHeap=vo;var $f=He,Cl=on,Ia=In.createEdgeWeightGetter,mo=$f,ja="weight";function pa(n,t){return n[0]>t[0]?1:n[0]<t[0]?-1:n[1]>t[1]?1:n[1]<t[1]?-1:n[2]>t[2]?1:n[2]<t[2]?-1:0}function Uf(n,t){return n[0]>t[0]?1:n[0]<t[0]?-1:n[1]>t[1]?1:n[1]<t[1]?-1:n[2]>t[2]?1:n[2]<t[2]?-1:n[3]>t[3]?1:n[3]<t[3]?-1:0}function Nf(n,t,e,r){if(t=""+t,e=""+e,!Cl(n))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(t&&!n.hasNode(t))throw new Error('graphology-shortest-path/dijkstra: the "'+t+'" source node does not exist in the given graph.');if(e&&!n.hasNode(e))throw new Error('graphology-shortest-path/dijkstra: the "'+e+'" target node does not exist in the given graph.');if(r=Ia(r||ja).fromMinimalEntry,t===e)return[0,[t]];var i=[{},{}],o=[{},{}],a=[new mo(pa),new mo(pa)],s=[{},{}];o[0][t]=[t],o[1][e]=[e],s[0][t]=0,s[1][e]=0;var c=[],l=1/0,f=0,p=1,g,v,m,E,S,C,L,O,x;for(a[0].push([0,f++,t]),a[1].push([0,f++,e]);a[0].size&&a[1].size;)if(p=1-p,g=a[p].pop(),E=g[0],S=g[2],!(S in i[p])){if(i[p][S]=E,S in i[1-p])return[l,c];for(v=p===1?n.inboundEdges(S):n.outboundEdges(S),O=0,x=v.length;O<x;O++){if(L=v[O],C=n.opposite(S,L),m=i[p][S]+r(L,n.getEdgeAttributes(L)),C in i[p]&&m<i[p][C])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(C in s[p])||m<s[p][C])&&(s[p][C]=m,a[p].push([m,f++,C]),o[p][C]=o[p][S].concat(C),C in s[0]&&C in s[1]&&(E=s[0][C]+s[1][C],(c.length===0||l>E)&&(l=E,c=o[0][C].concat(o[1][C].slice(0,-1).reverse()))))}}return[1/0,null]}function Mf(n,t,e,r,i,o){if(!Cl(n))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(i&&!n.hasNode(i))throw new Error('graphology-shortest-path/dijkstra: the "'+i+'" target node does not exist in the given graph.');e=Ia(e||ja).fromMinimalEntry;var a={},s={},c=new mo(pa),l=0,f,p,g,v,m,E,S,C,L,O,x;for(C=0,O=t.length;C<O;C++)v=t[C],s[v]=0,c.push([0,l++,v]),o&&(o[v]=[v]);for(;c.size;)if(p=c.pop(),S=p[0],v=p[2],!(v in a)){if(a[v]=S,v===i)break;for(f=n.outboundEdges(v),L=0,x=f.length;L<x;L++)if(E=f[L],m=n.opposite(v,E),g=e(E,n.getEdgeAttributes(E))+a[v],!(r&&g>r)){if(m in a&&g<a[m])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(m in s)||g<s[m])&&(s[m]=g,c.push([g,l++,m]),o&&(o[m]=o[v].concat(m)))}}return a}function zf(n,t,e){var r={};return Mf(n,[t],e,0,null,r),r}function Bf(n,t,e,r){return Nf(n,t,e,r)[1]}function Wf(n,t,e){t=""+t,e=Ia(e||ja).fromMinimalEntry;var r=[],i={},o={},a=n.nodes(),s,c,l,f,p,g,v,m,E,S;for(E=0,S=a.length;E<S;E++)g=a[E],i[g]=[],o[g]=0;var C={};o[t]=1;var L={};L[t]=0;var O=0,x=new mo(Uf);for(x.push([0,O++,t,t]);x.size;)if(c=x.pop(),f=c[0],l=c[2],g=c[3],!(g in C))for(o[g]+=o[l],r.push(g),C[g]=f,s=n.outboundEdges(g),E=0,S=s.length;E<S;E++)m=s[E],v=n.opposite(g,m),p=f+e(m,n.getEdgeAttributes(m)),!(v in C)&&(!(v in L)||p<L[v])?(L[v]=p,x.push([p,O++,g,v]),o[v]=0,i[v]=[g]):p===L[v]&&(o[v]+=o[g],i[v].push(g));return[r,i,o]}Co.bidirectional=Bf;Co.singleSource=zf;Co.brandes=Wf;var qf=Fn,Hf=ml,ga=Co,Vf=qf.singleSourceLength,Yf=Hf.edgePathFromNodePath,Oi={};Oi.addEdge=function(t,e,r,i,o,a){return e?r==null?t.addUndirectedEdge(i,o,a):t.addUndirectedEdgeWithKey(r,i,o,a):r==null?t.addDirectedEdge(i,o,a):t.addDirectedEdgeWithKey(r,i,o,a)};Oi.copyEdge=function(t,e,r,i,o,a){return a=Object.assign({},a),e?r==null?t.addUndirectedEdge(i,o,a):t.addUndirectedEdgeWithKey(r,i,o,a):r==null?t.addDirectedEdge(i,o,a):t.addDirectedEdgeWithKey(r,i,o,a)};Oi.mergeEdge=function(t,e,r,i,o,a){return e?r==null?t.mergeUndirectedEdge(i,o,a):t.mergeUndirectedEdgeWithKey(r,i,o,a):r==null?t.mergeDirectedEdge(i,o,a):t.mergeDirectedEdgeWithKey(r,i,o,a)};Oi.updateEdge=function(t,e,r,i,o,a){return e?r==null?t.updateUndirectedEdge(i,o,a):t.updateUndirectedEdgeWithKey(r,i,o,a):r==null?t.updateDirectedEdge(i,o,a):t.updateDirectedEdgeWithKey(r,i,o,a)};var Kf=on,Bs=Oi.copyEdge,Zf=function(t,e){if(!Kf(t))throw new Error("graphology-operators/to-undirected: expecting a valid graphology instance.");typeof e=="function"&&(e={mergeEdge:e}),e=e||{};var r=typeof e.mergeEdge=="function"?e.mergeEdge:null;if(t.type==="undirected")return t.copy();var i=t.emptyCopy({type:"undirected"});return t.forEachUndirectedEdge(function(o,a,s,c){Bs(i,!0,o,s,c,a)}),t.forEachDirectedEdge(function(o,a,s,c){if(!t.multi){var l=i.edge(s,c);if(l){r&&i.replaceEdgeAttributes(l,r(i.getEdgeAttributes(l),a));return}}Bs(i,!0,null,s,c,a)}),i},Ll=Zf;function Xf(n,t,e){var l;const r=e.refs,i=r.map(f=>f.id);let o=[];for(const f of(l=e["path-refs"])!=null?l:[]){const p=!!t.find(g=>g.id===f.id);!n&&p||f.id!==e.page.id&&(i.includes(f.id)||o.push(f))}let a=e.page;o.length>0?a=o[o.length-1]:a=e.page;const s=r.map(f=>({source:a.id,target:f.id})),c=r.flatMap((f,p)=>[...r.slice(0,p),...r.slice(p+1)].map(g=>({source:f.id,target:g.id,undirected:!0})));return s.concat(c)}async function Qf(n,t,e,r){if(e.find(o=>o.id===r))return r;if(t.has(r))return t.get(r);const i=await n(r);if(i&&i.page){const o=i.page.id;return t.has(o)?t.get(o):o}}async function Bt(n,t,e,r){var l,f;console.log("building graph");const i=new ke;let o=await n();const a=Jf(o);o=ep(a,o);const s=o.filter(p=>p["journal?"]);for(const p of o){if(p.properties&&(p.properties.graphHide||p.properties.excludeFromGraphView)||i.hasNode(p.id)||e().journal!==!0&&p["journal?"])continue;const g=((l=p.properties)==null?void 0:l.icon)||((f=p.properties)==null?void 0:f.pageIcon);i.addNode(p.id,ci(wr({},g?{type:"image",image:`data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='1.1em' x='0.2em' font-size='70'>${g}</text></svg>`}:{type:"circle"}),{label:p.name,aliases:Ws(p,!0),rawAliases:Ws(p,!1)}))}const c=await t();return await Promise.all(c.flat().map(async p=>{if(p.refs)for(const g of Xf(e().journal===!0,s,p)){const v=await Qf(r,a,o,g.target);v&&i.hasNode(g.source)&&i.hasNode(v)&&(i.hasEdge(g.source,v)?i.updateDirectedEdgeAttribute(g.source,v,"weight",m=>m+1):i.addEdge(g.source,v,{weight:1}))}})),console.log("graph complete",i.size),i.getAttribute("isInited")||(gf.assign(i),i.setAttribute("isInited",!0)),i}function Jf(n){const t=new Map;for(const e of n)if(e.properties&&e.properties.alias){const r=Tl(e).map(i=>n.find(o=>o.name.toUpperCase()===i.toUpperCase()));for(const i of r)i&&t.set(i.id,e.id)}return t}function Tl(n){var t;return(t=n.properties)!=null&&t.alias?n.properties.alias===""?[]:typeof n.properties.alias=="string"?[n.properties.alias]:n.properties.alias:[]}function ep(n,t){return t.filter(e=>!n.has(e.id))}function Ws(n,t){return Tl(n).map(e=>t?e.toUpperCase():e)}function Ai(n,t){if(!t)return;const e=t.toUpperCase();return n.findNode((r,i)=>i.label.toUpperCase()===e||i.aliases&&i.aliases.includes(e))}function tp(n){const t=new Map;for(const e of n.nodeEntries())if(t.set(e.attributes.label.toUpperCase(),e.node),e.attributes.aliases)for(const r of e.attributes.aliases)t.set(r.toUpperCase(),e.node);return t}function rp(n,t){const e=Ll(n),r=new Map;for(const i of n.nodeEntries()){const o=i.attributes.label.toUpperCase(),a=t.toUpperCase();if(o.includes(a)){const s=Vf(e,i.node);for(const[c,l]of Object.entries(s)){const f=r.get(c);(!f||f>l)&&r.set(c,l)}}}return console.log(r),(i,o)=>{const a=r.get(i);return a===void 0?!0:o<=a}}if(yo.vitest){const{it:n,expect:t,describe:e,vi:r}=yo.vitest;e("buildGraph",()=>{function i(o){const a=o.toJSON();return a.edges.forEach(s=>{delete s.key}),a.nodes.forEach(s=>{delete s.key,delete s.attributes.x,delete s.attributes.y}),a}n("creates a graph with edges",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!1,name:"B"}],async()=>[[{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("increases the weight for multiple edges",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!1,name:"B"}],async()=>[[{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}},{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("shows journal pages when requested",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!0,name:"B"}],async()=>[[{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}}]],()=>({journal:!0}),async f=>null);t(i(l)).toMatchSnapshot()}),n("does not shows journal pages when not requested",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!0,name:"B"}],async()=>[[{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("links graphs to nested parents",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!1,name:"B"},{id:3,"journal?":!1,name:"C"}],async()=>[[{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}},{refs:[{id:3}],"path-refs":[{id:1},{id:2},{id:3}],page:{id:1}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("handles block references",async()=>{const o=async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!1,name:"B"}],a=async()=>[[{refs:[{id:3}],"path-refs":[{id:1},{id:3}],page:{id:1}}]],s=()=>({journal:!1}),c=r.fn().mockImplementationOnce(()=>({page:{id:2}})),l=await Bt(o,a,s,c);t(c).toBeCalledWith(3),t(i(l)).toMatchSnapshot()}),n("skips references to journal pages",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!0,name:"B"},{id:3,"journal?":!1,name:"C"}],async()=>[[{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}},{refs:[{id:3}],"path-refs":[{id:1},{id:2},{id:3}],page:{id:1}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("skips pages with graph-hide: true",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!1,name:"B",properties:{graphHide:!0}}],async()=>[[{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("skips pages with exclude-from-graph-view: true",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!1,name:"B",properties:{excludeFromGraphView:!0}}],async()=>[[{refs:[{id:2}],"path-refs":[{id:1},{id:2}],page:{id:1}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("merges alias nodes",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A",properties:{alias:["B"]}},{id:2,"journal?":!1,name:"B"},{id:3,"journal?":!1,name:"C"}],async()=>[[{refs:[{id:2}],"path-refs":[{id:3},{id:2}],page:{id:3}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("alias nodes empty cases shoud not fail",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A",properties:{alias:""}},{id:2,"journal?":!1,name:"B",properties:{alias:["test"]}},{id:3,"journal?":!1,name:"C"}],async()=>[[]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()}),n("links shared references in a block",async()=>{const l=await Bt(async()=>[{id:1,"journal?":!1,name:"A"},{id:2,"journal?":!1,name:"B"},{id:3,"journal?":!1,name:"C"}],async()=>[[{refs:[{id:2},{id:3}],"path-refs":[{id:1},{id:2},{id:3}],page:{id:1}}]],()=>({journal:!1}),async f=>null);t(i(l)).toMatchSnapshot()})})}function np(n,t,e){const{getGraph:r}=Gu("sigma");let{id:i}=t,{attributes:o}=t;return wo(()=>{const a=r();!a||a.hasNode(i)&&a.dropNode(i)}),Iu(()=>{const a=r();!a||(a.hasNode(i)?a.updateNodeAttributes(i,()=>o):a.addNode(i,o))}),n.$$set=a=>{"id"in a&&e(0,i=a.id),"attributes"in a&&e(1,o=a.attributes)},[i,o]}class ip extends Dn{constructor(t){super(),xn(this,t,np,null,nn,{id:0,attributes:1})}}function op(n,t,e){const{getGraph:r}=Gu("sigma");let{source:i}=t,{target:o}=t,{attributes:a}=t;return bo(()=>{var c;const s=r();s&&(s.hasNode(i)||s.addNode(i,{x:0,y:0}),s.hasNode(o)||s.addNode(o,{x:0,y:0})),(c=r())==null||c.addDirectedEdge(i,o,a)}),wo(()=>{const s=r();s&&s.hasDirectedEdge(i,o)&&s.dropDirectedEdge(i,o)}),n.$$set=s=>{"source"in s&&e(0,i=s.source),"target"in s&&e(1,o=s.target),"attributes"in s&&e(2,a=s.attributes)},[i,o,a]}class ap extends Dn{constructor(t){super(),xn(this,t,op,null,nn,{source:0,target:1,attributes:2})}}const vn=[];function sp(n,t){return{subscribe:Ga(n,t).subscribe}}function Ga(n,t=Yt){let e;const r=new Set;function i(s){if(nn(n,s)&&(n=s,e)){const c=!vn.length;for(const l of r)l[1](),vn.push(l,n);if(c){for(let l=0;l<vn.length;l+=2)vn[l][0](vn[l+1]);vn.length=0}}}function o(s){i(s(n))}function a(s,c=Yt){const l=[s,c];return r.add(l),r.size===1&&(e=t(i)||Yt),s(n),()=>{r.delete(l),r.size===0&&(e(),e=null)}}return{set:i,update:o,subscribe:a}}function Ol(n,t,e){const r=!Array.isArray(n),i=r?[n]:n,o=t.length<2;return sp(e,a=>{let s=!1;const c=[];let l=0,f=Yt;const p=()=>{if(l)return;f();const v=t(r?c[0]:c,a);o?a(v):f=Pu(v)?v:Yt},g=i.map((v,m)=>Ru(v,E=>{c[m]=E,l&=~(1<<m),s&&p()},()=>{l|=1<<m}));return s=!0,p(),function(){Wt(g),f()}})}var et=(n=>(n.Navigate="Navigate",n.ShortestPath="Shortest Path",n.AdamicAdar="Adamic Adar",n.CoCitation="CoCitation",n))(et||{});function up(){const{subscribe:n,update:t}=Ga({uiVisibile:!1,graph:new ke});return{subscribe:n,update:t,visible:e=>{t(r=>ci(wr({},r),{uiVisibile:e}))},reload:()=>{Ie.update(e=>(e.cameraState=void 0,e)),Bt(()=>logseq.Editor.getAllPages(),()=>logseq.DB.datascriptQuery("[:find (pull ?b [*]) :in $ :where [?b :block/refs]]"),()=>{var e;return{journal:((e=logseq.settings)==null?void 0:e.journal)===!0}},e=>logseq.Editor.getBlock(e)).then(e=>{t(r=>ci(wr({},r),{graph:e}))})}}}const bi=up(),kl=Ol(bi,n=>n.uiVisibile),$a=Ol(bi,n=>n.graph);var xu;const Ie=Ga({size:"in",mode:"Navigate",directed:!0,bubbleSize:5,filter:!1,filterLength:3,labelThreshold:100,nodesGravity:1,scalingRatio:1,edgeWeightInfluence:.5,filters:((xu=logseq.settings)==null?void 0:xu.filters)||[],themeMode:"dark"});async function xl(n,t){let e=[];if(n===void 0||n==="")return e;if(n.startsWith("q:"))try{const r=await logseq.DB.q(n.slice(2).toLowerCase());r&&(e=r.map(i=>i.page.id.toString()))}catch{console.log("error in query")}else e=t.filterNodes((r,i)=>{var o,a;return((o=i.label)==null?void 0:o.match(n))||((a=i.aliases)==null?void 0:a.find(s=>s.toUpperCase().match(n.toUpperCase())))});return e}function lp(n){let t,e,r,i;return{c(){t=oe("span"),e=oe("input"),z(e,"type","color"),z(e,"class","svelte-dm4o37"),z(t,"class","svelte-dm4o37")},m(o,a){st(o,t,a),H(t,e),Xe(e,n[1]),r||(i=ze(e,"input",n[8]),r=!0)},p(o,a){a&2&&Xe(e,o[1])},d(o){o&&nt(t),r=!1,i()}}}function cp(n){let t,e,r,i,o,a,s=lp(n);return{c(){t=oe("form"),e=oe("div"),r=oe("input"),i=Se(),s&&s.c(),z(r,"type","search"),z(r,"placeholder","Search"),z(r,"class","svelte-dm4o37"),z(t,"class","search-input svelte-dm4o37")},m(c,l){st(c,t,l),H(t,e),H(e,r),Xe(r,n[0]),H(t,i),s&&s.m(t,null),o||(a=[ze(r,"input",n[7]),ze(t,"input",n[2])],o=!0)},p(c,[l]){l&1&&Xe(r,c[0]),s.p(c,l)},i:Yt,o:Yt,d(c){c&&nt(t),s&&s.d(),o=!1,Wt(a)}}}function hp(n,t,e){let r;$r(n,$a,m=>e(6,r=m));const i=ju();let{id:o}=t,{searchString:a=""}=t,{searchColor:s="#000000"}=t,{searchType:c="color"}=t,{foundNodeIds:l=[]}=t;function f(){xl(a,r).then(m=>{e(3,l=m),i("search",{id:o,searchString:a,searchColor:s,searchType:c,foundNodeIds:l})})}function p(m){f()}bo(()=>{f()}),wo(()=>{i("destroyed")});function g(){a=this.value,e(0,a)}function v(){s=this.value,e(1,s)}return n.$$set=m=>{"id"in m&&e(4,o=m.id),"searchString"in m&&e(0,a=m.searchString),"searchColor"in m&&e(1,s=m.searchColor),"searchType"in m&&e(5,c=m.searchType),"foundNodeIds"in m&&e(3,l=m.foundNodeIds)},n.$$.update=()=>{n.$$.dirty&64&&r&&f()},[a,s,p,l,o,c,r,g,v]}class dp extends Dn{constructor(t){super(),xn(this,t,hp,cp,nn,{id:4,searchString:0,searchColor:1,searchType:5,foundNodeIds:3})}}function qs(n,t,e){const r=n.slice();return r[23]=t[e].id,r[24]=t[e].searchString,r[25]=t[e].searchType,r[26]=t[e].searchColor,r[27]=t[e].foundNodeIds,r}function Hs(n,t,e){const r=n.slice();return r[30]=t[e][0],r[31]=t[e][1],r}function Vs(n){let t,e,r,i,o,a;return{c(){t=oe("div"),e=oe("label"),e.textContent="n hops",r=Se(),i=oe("input"),z(e,"for","nhops"),z(e,"class","svelte-jccoww"),z(i,"type","range"),z(i,"min","1"),z(i,"step","1"),z(i,"max","10"),z(t,"class","input-row svelte-jccoww")},m(s,c){st(s,t,c),H(t,e),H(t,r),H(t,i),Xe(i,n[0].filterLength),o||(a=[ze(i,"change",n[7]),ze(i,"input",n[7])],o=!0)},p(s,c){c[0]&1&&Xe(i,s[0].filterLength)},d(s){s&&nt(t),o=!1,Wt(a)}}}function Ys(n){let t,e=n[31]+"",r,i,o;return{c(){t=oe("option"),r=Ea(e),t.__value=i=n[31],t.value=t.__value,z(t,"title",o=n[4][n[31]])},m(a,s){st(a,t,s),H(t,r)},p:Yt,d(a){a&&nt(t)}}}function Ks(n){let t,e,r,i,o,a,s,c,l,f,p,g,v,m,E,S;return{c(){t=oe("div"),e=oe("label"),e.textContent="directed?",r=Se(),i=oe("input"),o=Se(),a=oe("div"),s=oe("label"),s.textContent="path a",c=Se(),l=oe("input"),f=Se(),p=oe("div"),g=oe("label"),g.textContent="path b",v=Se(),m=oe("input"),z(e,"for","directed"),z(e,"class","svelte-jccoww"),z(i,"type","checkbox"),z(i,"class","svelte-jccoww"),z(t,"class","input-row svelte-jccoww"),z(s,"for","path"),z(s,"class","svelte-jccoww"),z(l,"type","search"),z(l,"class","svelte-jccoww"),z(a,"class","input-row svelte-jccoww"),z(g,"for","path"),z(g,"class","svelte-jccoww"),z(m,"type","search"),z(m,"class","svelte-jccoww"),z(p,"class","input-row svelte-jccoww")},m(C,L){st(C,t,L),H(t,e),H(t,r),H(t,i),i.checked=n[0].directed,st(C,o,L),st(C,a,L),H(a,s),H(a,c),H(a,l),Xe(l,n[0].pathA),st(C,f,L),st(C,p,L),H(p,g),H(p,v),H(p,m),Xe(m,n[0].pathB),E||(S=[ze(i,"change",n[9]),ze(l,"input",n[10]),ze(m,"input",n[11])],E=!0)},p(C,L){L[0]&1&&(i.checked=C[0].directed),L[0]&1&&Xe(l,C[0].pathA),L[0]&1&&Xe(m,C[0].pathB)},d(C){C&&nt(t),C&&nt(o),C&&nt(a),C&&nt(f),C&&nt(p),E=!1,Wt(S)}}}function Zs(n){let t,e,r,i,o,a,s,c,l,f,p;return{c(){t=oe("div"),e=oe("label"),e.textContent="path a",r=Se(),i=oe("input"),o=Se(),a=oe("div"),s=oe("label"),s.textContent="bubble size",c=Se(),l=oe("input"),z(e,"for","path"),z(e,"class","svelte-jccoww"),z(i,"type","search"),z(i,"class","svelte-jccoww"),z(t,"class","input-row svelte-jccoww"),z(s,"for","bubbleSize"),z(s,"class","svelte-jccoww"),z(l,"type","range"),z(l,"min","0.01"),z(l,"step","0.1"),z(l,"max","10"),z(a,"class","input-row svelte-jccoww")},m(g,v){st(g,t,v),H(t,e),H(t,r),H(t,i),Xe(i,n[0].pathA),st(g,o,v),st(g,a,v),H(a,s),H(a,c),H(a,l),Xe(l,n[0].bubbleSize),f||(p=[ze(i,"input",n[12]),ze(l,"change",n[13]),ze(l,"input",n[13])],f=!0)},p(g,v){v[0]&1&&Xe(i,g[0].pathA),v[0]&1&&Xe(l,g[0].bubbleSize)},d(g){g&&nt(t),g&&nt(o),g&&nt(a),f=!1,Wt(p)}}}function Xs(n){let t;return{c(){t=oe("p"),t.textContent="Hit plus button to add filters",z(t,"class","help-message svelte-jccoww")},m(e,r){st(e,t,r)},p:Yt,d(e){e&&nt(t)}}}function Qs(n,t){let e,r,i,o,a,s,c,l;function f(){return t[14](t[23])}r=new dp({props:{id:t[23],searchString:t[24],searchColor:t[26],searchType:t[25],foundNodeIds:t[27]}}),r.$on("search",t[1]),r.$on("destroyed",f);function p(){return t[15](t[23])}return{key:n,first:null,c(){e=oe("div"),Ei(r.$$.fragment),i=Se(),o=oe("button"),o.textContent="\u2715",a=Se(),z(o,"class","svelte-jccoww"),z(e,"class","filter svelte-jccoww"),this.first=e},m(g,v){st(g,e,v),_n(r,e,null),H(e,i),H(e,o),H(e,a),s=!0,c||(l=ze(o,"click",p),c=!0)},p(g,v){t=g;const m={};v[0]&1&&(m.id=t[23]),v[0]&1&&(m.searchString=t[24]),v[0]&1&&(m.searchColor=t[26]),v[0]&1&&(m.searchType=t[25]),v[0]&1&&(m.foundNodeIds=t[27]),r.$set(m)},i(g){s||(rr(r.$$.fragment,g),s=!0)},o(g){fr(r.$$.fragment,g),s=!1},d(g){g&&nt(e),En(r),c=!1,l()}}}function Js(n){let t,e,r,i,o,a;return{c(){t=oe("div"),e=oe("label"),e.textContent="n hops",r=Se(),i=oe("input"),z(e,"for","nhops"),z(e,"class","svelte-jccoww"),z(i,"type","range"),z(i,"min","1"),z(i,"step","1"),z(i,"max","10"),z(t,"class","input-row svelte-jccoww")},m(s,c){st(s,t,c),H(t,e),H(t,r),H(t,i),Xe(i,n[0].filterLength),o||(a=[ze(i,"change",n[20]),ze(i,"input",n[20])],o=!0)},p(s,c){c[0]&1&&Xe(i,s[0].filterLength)},d(s){s&&nt(t),o=!1,Wt(a)}}}function fp(n){let t,e,r,i,o,a,s,c,l,f,p,g,v,m,E,S,C,L,O,x,A,R,b,_,w,$,M=[],Q=new Map,pe,J,Te,Ve,le,D,U,B,I,P,fe,K,he,Pe,Ce,ie,St,Ne,Ke,Oe,tt,rt,ye,be,_e,ut,ce,de,G,vt,Ct,ht,kt,mt,Qe=n[0].filter&&Vs(n),Et=Object.entries(et),q=[];for(let re=0;re<Et.length;re+=1)q[re]=Ys(Hs(n,Et,re));let V=n[0].mode===et.ShortestPath&&Ks(n),ae=(n[0].mode===et.AdamicAdar||n[0].mode===et.CoCitation)&&Zs(n),ge=n[0].filters;const Re=re=>re[23];for(let re=0;re<ge.length;re+=1){let Ae=qs(n,ge,re),je=Re(Ae);Q.set(je,M[re]=Qs(je,Ae))}let xe=null;ge.length||(xe=Xs());let Be=n[0].filter&&Js(n);return{c(){t=oe("div"),e=oe("section"),r=oe("div"),i=oe("input"),o=Se(),a=oe("div"),s=oe("label"),s.textContent="keep only found",c=Se(),l=oe("input"),f=Se(),Qe&&Qe.c(),p=Se(),g=oe("section"),v=oe("h2"),v.textContent="Mode",m=Se(),E=oe("div"),S=oe("select");for(let re=0;re<q.length;re+=1)q[re].c();C=Se(),V&&V.c(),L=Se(),ae&&ae.c(),O=Se(),x=oe("section"),A=oe("div"),R=oe("div"),b=oe("h2"),b.textContent="Filters",_=Se(),w=oe("button"),w.textContent="+",$=Se();for(let re=0;re<M.length;re+=1)M[re].c();xe&&xe.c(),pe=Se(),J=oe("section"),Te=oe("h2"),Te.textContent="Display",Ve=Se(),le=oe("div"),D=oe("label"),D.textContent="Label threshold",U=Se(),B=oe("input"),I=Se(),P=oe("div"),fe=oe("label"),fe.textContent="Nodes gravity",K=Se(),he=oe("input"),Pe=Se(),Ce=oe("div"),ie=oe("label"),ie.textContent="Scaling ratio",St=Se(),Ne=oe("input"),Ke=Se(),Oe=oe("div"),tt=oe("label"),tt.textContent="Edge weight impact",rt=Se(),ye=oe("input"),be=Se(),Be&&Be.c(),_e=Se(),ut=oe("div"),ce=oe("label"),ce.textContent="Size",de=Se(),G=oe("select"),vt=oe("option"),vt.textContent="inbound links",Ct=oe("option"),Ct.textContent="outbound links",z(i,"type","search"),z(i,"placeholder","Search"),z(i,"class","svelte-jccoww"),z(r,"class","input-row svelte-jccoww"),z(r,"id","search"),z(s,"for","filter"),z(s,"class","svelte-jccoww"),z(l,"type","checkbox"),z(l,"class","svelte-jccoww"),z(a,"class","input-row svelte-jccoww"),z(e,"class","svelte-jccoww"),z(v,"class","svelte-jccoww"),z(S,"class","svelte-jccoww"),n[0].mode===void 0&&_i(()=>n[8].call(S)),z(E,"class","input-row svelte-jccoww"),z(g,"class","svelte-jccoww"),z(b,"class","svelte-jccoww"),z(w,"class","svelte-jccoww"),z(R,"class","input-row svelte-jccoww"),z(x,"class","svelte-jccoww"),z(Te,"class","svelte-jccoww"),z(D,"for","labelThreshold"),z(D,"class","svelte-jccoww"),z(B,"type","range"),z(B,"min","0"),z(B,"step","0.05"),z(B,"max","10"),z(le,"class","input-row svelte-jccoww"),z(fe,"for","gravity"),z(fe,"class","svelte-jccoww"),z(he,"type","range"),z(he,"min","0.01"),z(he,"step","0.01"),z(he,"max","20"),z(P,"class","input-row svelte-jccoww"),z(ie,"for","scalingRatio"),z(ie,"class","svelte-jccoww"),z(Ne,"type","range"),z(Ne,"min","0.001"),z(Ne,"step","0.0001"),z(Ne,"max","1.5"),z(Ce,"class","input-row svelte-jccoww"),z(tt,"for","edgeWeightInfluence"),z(tt,"class","svelte-jccoww"),z(ye,"type","range"),z(ye,"min","-2"),z(ye,"step","0.1"),z(ye,"max","2"),z(Oe,"class","input-row svelte-jccoww"),z(ce,"for","size"),z(ce,"class","svelte-jccoww"),vt.selected=!0,vt.__value="in",vt.value=vt.__value,Ct.__value="out",Ct.value=Ct.__value,z(G,"id","size"),z(G,"name","size"),z(G,"class","svelte-jccoww"),n[0].size===void 0&&_i(()=>n[21].call(G)),z(ut,"class","input-row svelte-jccoww"),z(J,"class","svelte-jccoww"),z(t,"class","settings")},m(re,Ae){st(re,t,Ae),H(t,e),H(e,r),H(r,i),Xe(i,n[0].search),H(e,o),H(e,a),H(a,s),H(a,c),H(a,l),l.checked=n[0].filter,H(e,f),Qe&&Qe.m(e,null),H(t,p),H(t,g),H(g,v),H(g,m),H(g,E),H(E,S);for(let je=0;je<q.length;je+=1)q[je].m(S,null);eo(S,n[0].mode),H(g,C),V&&V.m(g,null),H(g,L),ae&&ae.m(g,null),H(t,O),H(t,x),H(x,A),H(A,R),H(R,b),H(R,_),H(R,w),H(A,$);for(let je=0;je<M.length;je+=1)M[je].m(A,null);xe&&xe.m(A,null),H(t,pe),H(t,J),H(J,Te),H(J,Ve),H(J,le),H(le,D),H(le,U),H(le,B),Xe(B,n[0].labelThreshold),H(J,I),H(J,P),H(P,fe),H(P,K),H(P,he),Xe(he,n[0].nodesGravity),H(J,Pe),H(J,Ce),H(Ce,ie),H(Ce,St),H(Ce,Ne),Xe(Ne,n[0].scalingRatio),H(J,Ke),H(J,Oe),H(Oe,tt),H(Oe,rt),H(Oe,ye),Xe(ye,n[0].edgeWeightInfluence),H(J,be),Be&&Be.m(J,null),H(J,_e),H(J,ut),H(ut,ce),H(ut,de),H(ut,G),H(G,vt),H(G,Ct),eo(G,n[0].size),ht=!0,kt||(mt=[ze(i,"input",n[5]),ze(l,"change",n[6]),ze(S,"change",n[8]),ze(w,"click",n[3]),ze(B,"change",n[16]),ze(B,"input",n[16]),ze(he,"change",n[17]),ze(he,"input",n[17]),ze(Ne,"change",n[18]),ze(Ne,"input",n[18]),ze(ye,"change",n[19]),ze(ye,"input",n[19]),ze(G,"change",n[21])],kt=!0)},p(re,Ae){if(Ae[0]&1&&Xe(i,re[0].search),Ae[0]&1&&(l.checked=re[0].filter),re[0].filter?Qe?Qe.p(re,Ae):(Qe=Vs(re),Qe.c(),Qe.m(e,null)):Qe&&(Qe.d(1),Qe=null),Ae[0]&16){Et=Object.entries(et);let je;for(je=0;je<Et.length;je+=1){const gr=Hs(re,Et,je);q[je]?q[je].p(gr,Ae):(q[je]=Ys(gr),q[je].c(),q[je].m(S,null))}for(;je<q.length;je+=1)q[je].d(1);q.length=Et.length}Ae[0]&1&&eo(S,re[0].mode),re[0].mode===et.ShortestPath?V?V.p(re,Ae):(V=Ks(re),V.c(),V.m(g,L)):V&&(V.d(1),V=null),re[0].mode===et.AdamicAdar||re[0].mode===et.CoCitation?ae?ae.p(re,Ae):(ae=Zs(re),ae.c(),ae.m(g,null)):ae&&(ae.d(1),ae=null),Ae[0]&7&&(ge=re[0].filters,ca(),M=fa(M,Ae,Re,1,re,ge,Q,A,da,Qs,null,qs),ha(),!ge.length&&xe?xe.p(re,Ae):ge.length?xe&&(xe.d(1),xe=null):(xe=Xs(),xe.c(),xe.m(A,null))),Ae[0]&1&&Xe(B,re[0].labelThreshold),Ae[0]&1&&Xe(he,re[0].nodesGravity),Ae[0]&1&&Xe(Ne,re[0].scalingRatio),Ae[0]&1&&Xe(ye,re[0].edgeWeightInfluence),re[0].filter?Be?Be.p(re,Ae):(Be=Js(re),Be.c(),Be.m(J,_e)):Be&&(Be.d(1),Be=null),Ae[0]&1&&eo(G,re[0].size)},i(re){if(!ht){for(let Ae=0;Ae<ge.length;Ae+=1)rr(M[Ae]);ht=!0}},o(re){for(let Ae=0;Ae<M.length;Ae+=1)fr(M[Ae]);ht=!1},d(re){re&&nt(t),Qe&&Qe.d(),Gh(q,re),V&&V.d(),ae&&ae.d();for(let Ae=0;Ae<M.length;Ae+=1)M[Ae].d();xe&&xe.d(),Be&&Be.d(),kt=!1,Wt(mt)}}}function pp(n,t,e){let r;$r(n,Ie,w=>e(0,r=w));function i(w){if(r.filters[w.detail.id]!=w.detail){let $=r.filters;$[w.detail.id]=w.detail,Mt(Ie,r.filters=[...$],r)}}function o(w){Mt(Ie,r.filters=r.filters.filter($=>$.id!==w),r)}function a(){let w=0;r.filters&&(w=r.filters.length);const $={id:w,searchString:"",searchType:"color",searchColor:"#000000",foundNodeIds:[]};Mt(Ie,r.filters=[...r.filters,$],r)}const s={[et.Navigate]:"Observe your graph. Click to open page, shift-click to open in side bar",[et.ShortestPath]:"Shortest path between two nodes",[et.AdamicAdar]:"Find secret connections between your notes",[et.CoCitation]:"Checks how alike documents are by looking at how close their shared references are"};function c(){r.search=this.value,Ie.set(r)}function l(){r.filter=this.checked,Ie.set(r)}function f(){r.filterLength=Xr(this.value),Ie.set(r)}function p(){r.mode=Is(this),Ie.set(r)}function g(){r.directed=this.checked,Ie.set(r)}function v(){r.pathA=this.value,Ie.set(r)}function m(){r.pathB=this.value,Ie.set(r)}function E(){r.pathA=this.value,Ie.set(r)}function S(){r.bubbleSize=Xr(this.value),Ie.set(r)}const C=w=>o(w),L=w=>o(w);function O(){r.labelThreshold=Xr(this.value),Ie.set(r)}function x(){r.nodesGravity=Xr(this.value),Ie.set(r)}function A(){r.scalingRatio=Xr(this.value),Ie.set(r)}function R(){r.edgeWeightInfluence=Xr(this.value),Ie.set(r)}function b(){r.filterLength=Xr(this.value),Ie.set(r)}function _(){r.size=Is(this),Ie.set(r)}return[r,i,o,a,s,c,l,f,p,g,v,m,E,S,C,L,O,x,A,R,b,_]}class gp extends Dn{constructor(t){super(),xn(this,t,pp,fp,nn,{},null,[-1,-1])}}var vp=function(){var t,e,r={};(function(){var o=0,a=1,s=2,c=3,l=4,f=5,p=6,g=7,v=8,m=9,E=0,S=1,C=2,L=0,O=1,x=2,A=3,R=4,b=5,_=6,w=7,$=8,M=3,Q=10,pe=3,J=9,Te=10;r.exports=function(le,D,U){var B,I,P,fe,K,he,Pe,Ce,ie,St,Ne=D.length,Ke=U.length,Oe=le.adjustSizes,tt=le.barnesHutTheta*le.barnesHutTheta,rt,ye,be,_e,ut,ce,de,G=[];for(P=0;P<Ne;P+=Q)D[P+l]=D[P+s],D[P+f]=D[P+c],D[P+s]=0,D[P+c]=0;if(le.outboundAttractionDistribution){for(rt=0,P=0;P<Ne;P+=Q)rt+=D[P+p];rt/=Ne/Q}if(le.barnesHutOptimize){var vt=1/0,Ct=-1/0,ht=1/0,kt=-1/0,mt,Qe,Et;for(P=0;P<Ne;P+=Q)vt=Math.min(vt,D[P+o]),Ct=Math.max(Ct,D[P+o]),ht=Math.min(ht,D[P+a]),kt=Math.max(kt,D[P+a]);var q=Ct-vt,V=kt-ht;for(q>V?(ht-=(q-V)/2,kt=ht+q):(vt-=(V-q)/2,Ct=vt+V),G[0+L]=-1,G[0+O]=(vt+Ct)/2,G[0+x]=(ht+kt)/2,G[0+A]=Math.max(Ct-vt,kt-ht),G[0+R]=-1,G[0+b]=-1,G[0+_]=0,G[0+w]=0,G[0+$]=0,B=1,P=0;P<Ne;P+=Q)for(I=0,Et=M;;)if(G[I+b]>=0){D[P+o]<G[I+O]?D[P+a]<G[I+x]?mt=G[I+b]:mt=G[I+b]+J:D[P+a]<G[I+x]?mt=G[I+b]+J*2:mt=G[I+b]+J*3,G[I+w]=(G[I+w]*G[I+_]+D[P+o]*D[P+p])/(G[I+_]+D[P+p]),G[I+$]=(G[I+$]*G[I+_]+D[P+a]*D[P+p])/(G[I+_]+D[P+p]),G[I+_]+=D[P+p],I=mt;continue}else if(G[I+L]<0){G[I+L]=P;break}else{if(G[I+b]=B*J,Ce=G[I+A]/2,ie=G[I+b],G[ie+L]=-1,G[ie+O]=G[I+O]-Ce,G[ie+x]=G[I+x]-Ce,G[ie+A]=Ce,G[ie+R]=ie+J,G[ie+b]=-1,G[ie+_]=0,G[ie+w]=0,G[ie+$]=0,ie+=J,G[ie+L]=-1,G[ie+O]=G[I+O]-Ce,G[ie+x]=G[I+x]+Ce,G[ie+A]=Ce,G[ie+R]=ie+J,G[ie+b]=-1,G[ie+_]=0,G[ie+w]=0,G[ie+$]=0,ie+=J,G[ie+L]=-1,G[ie+O]=G[I+O]+Ce,G[ie+x]=G[I+x]-Ce,G[ie+A]=Ce,G[ie+R]=ie+J,G[ie+b]=-1,G[ie+_]=0,G[ie+w]=0,G[ie+$]=0,ie+=J,G[ie+L]=-1,G[ie+O]=G[I+O]+Ce,G[ie+x]=G[I+x]+Ce,G[ie+A]=Ce,G[ie+R]=G[I+R],G[ie+b]=-1,G[ie+_]=0,G[ie+w]=0,G[ie+$]=0,B+=4,D[G[I+L]+o]<G[I+O]?D[G[I+L]+a]<G[I+x]?mt=G[I+b]:mt=G[I+b]+J:D[G[I+L]+a]<G[I+x]?mt=G[I+b]+J*2:mt=G[I+b]+J*3,G[I+_]=D[G[I+L]+p],G[I+w]=D[G[I+L]+o],G[I+$]=D[G[I+L]+a],G[mt+L]=G[I+L],G[I+L]=-1,D[P+o]<G[I+O]?D[P+a]<G[I+x]?Qe=G[I+b]:Qe=G[I+b]+J:D[P+a]<G[I+x]?Qe=G[I+b]+J*2:Qe=G[I+b]+J*3,mt===Qe)if(Et--){I=mt;continue}else{Et=M;break}G[Qe+L]=P;break}}if(le.barnesHutOptimize)for(ye=le.scalingRatio,P=0;P<Ne;P+=Q)for(I=0;;)if(G[I+b]>=0)if(ce=Math.pow(D[P+o]-G[I+w],2)+Math.pow(D[P+a]-G[I+$],2),St=G[I+A],4*St*St/ce<tt){if(be=D[P+o]-G[I+w],_e=D[P+a]-G[I+$],Oe===!0?ce>0?(de=ye*D[P+p]*G[I+_]/ce,D[P+s]+=be*de,D[P+c]+=_e*de):ce<0&&(de=-ye*D[P+p]*G[I+_]/Math.sqrt(ce),D[P+s]+=be*de,D[P+c]+=_e*de):ce>0&&(de=ye*D[P+p]*G[I+_]/ce,D[P+s]+=be*de,D[P+c]+=_e*de),I=G[I+R],I<0)break;continue}else{I=G[I+b];continue}else{if(he=G[I+L],he>=0&&he!==P&&(be=D[P+o]-D[he+o],_e=D[P+a]-D[he+a],ce=be*be+_e*_e,Oe===!0?ce>0?(de=ye*D[P+p]*D[he+p]/ce,D[P+s]+=be*de,D[P+c]+=_e*de):ce<0&&(de=-ye*D[P+p]*D[he+p]/Math.sqrt(ce),D[P+s]+=be*de,D[P+c]+=_e*de):ce>0&&(de=ye*D[P+p]*D[he+p]/ce,D[P+s]+=be*de,D[P+c]+=_e*de)),I=G[I+R],I<0)break;continue}else for(ye=le.scalingRatio,fe=0;fe<Ne;fe+=Q)for(K=0;K<fe;K+=Q)be=D[fe+o]-D[K+o],_e=D[fe+a]-D[K+a],Oe===!0?(ce=Math.sqrt(be*be+_e*_e)-D[fe+v]-D[K+v],ce>0?(de=ye*D[fe+p]*D[K+p]/ce/ce,D[fe+s]+=be*de,D[fe+c]+=_e*de,D[K+s]-=be*de,D[K+c]-=_e*de):ce<0&&(de=100*ye*D[fe+p]*D[K+p],D[fe+s]+=be*de,D[fe+c]+=_e*de,D[K+s]-=be*de,D[K+c]-=_e*de)):(ce=Math.sqrt(be*be+_e*_e),ce>0&&(de=ye*D[fe+p]*D[K+p]/ce/ce,D[fe+s]+=be*de,D[fe+c]+=_e*de,D[K+s]-=be*de,D[K+c]-=_e*de));for(ie=le.gravity/le.scalingRatio,ye=le.scalingRatio,P=0;P<Ne;P+=Q)de=0,be=D[P+o],_e=D[P+a],ce=Math.sqrt(Math.pow(be,2)+Math.pow(_e,2)),le.strongGravityMode?ce>0&&(de=ye*D[P+p]*ie):ce>0&&(de=ye*D[P+p]*ie/ce),D[P+s]-=be*de,D[P+c]-=_e*de;for(ye=1*(le.outboundAttractionDistribution?rt:1),Pe=0;Pe<Ke;Pe+=pe)fe=U[Pe+E],K=U[Pe+S],Ce=U[Pe+C],ut=Math.pow(Ce,le.edgeWeightInfluence),be=D[fe+o]-D[K+o],_e=D[fe+a]-D[K+a],Oe===!0?(ce=Math.sqrt(be*be+_e*_e)-D[fe+v]-D[K+v],le.linLogMode?le.outboundAttractionDistribution?ce>0&&(de=-ye*ut*Math.log(1+ce)/ce/D[fe+p]):ce>0&&(de=-ye*ut*Math.log(1+ce)/ce):le.outboundAttractionDistribution?ce>0&&(de=-ye*ut/D[fe+p]):ce>0&&(de=-ye*ut)):(ce=Math.sqrt(Math.pow(be,2)+Math.pow(_e,2)),le.linLogMode?le.outboundAttractionDistribution?ce>0&&(de=-ye*ut*Math.log(1+ce)/ce/D[fe+p]):ce>0&&(de=-ye*ut*Math.log(1+ce)/ce):le.outboundAttractionDistribution?(ce=1,de=-ye*ut/D[fe+p]):(ce=1,de=-ye*ut)),ce>0&&(D[fe+s]+=be*de,D[fe+c]+=_e*de,D[K+s]-=be*de,D[K+c]-=_e*de);var ae,ge,Re,xe,Be,re;if(Oe===!0)for(P=0;P<Ne;P+=Q)D[P+m]!==1&&(ae=Math.sqrt(Math.pow(D[P+s],2)+Math.pow(D[P+c],2)),ae>Te&&(D[P+s]=D[P+s]*Te/ae,D[P+c]=D[P+c]*Te/ae),ge=D[P+p]*Math.sqrt((D[P+l]-D[P+s])*(D[P+l]-D[P+s])+(D[P+f]-D[P+c])*(D[P+f]-D[P+c])),Re=Math.sqrt((D[P+l]+D[P+s])*(D[P+l]+D[P+s])+(D[P+f]+D[P+c])*(D[P+f]+D[P+c]))/2,xe=.1*Math.log(1+Re)/(1+Math.sqrt(ge)),Be=D[P+o]+D[P+s]*(xe/le.slowDown),D[P+o]=Be,re=D[P+a]+D[P+c]*(xe/le.slowDown),D[P+a]=re);else for(P=0;P<Ne;P+=Q)D[P+m]!==1&&(ge=D[P+p]*Math.sqrt((D[P+l]-D[P+s])*(D[P+l]-D[P+s])+(D[P+f]-D[P+c])*(D[P+f]-D[P+c])),Re=Math.sqrt((D[P+l]+D[P+s])*(D[P+l]+D[P+s])+(D[P+f]+D[P+c])*(D[P+f]+D[P+c]))/2,xe=D[P+g]*Math.log(1+Re)/(1+Math.sqrt(ge)),D[P+g]=Math.min(1,Math.sqrt(xe*(Math.pow(D[P+s],2)+Math.pow(D[P+c],2))/(1+Math.sqrt(ge)))),Be=D[P+o]+D[P+s]*(xe/le.slowDown),D[P+o]=Be,re=D[P+a]+D[P+c]*(xe/le.slowDown),D[P+a]=re);return{}}})();var i=r.exports;self.addEventListener("message",function(o){var a=o.data;t=new Float32Array(a.nodes),a.edges&&(e=new Float32Array(a.edges)),i(a.settings,t,e),self.postMessage({nodes:t.buffer},[t.buffer])})},Or={},Si=10,eu=3;Or.assign=function(n){n=n||{};var t=Array.prototype.slice.call(arguments).slice(1),e,r,i;for(e=0,i=t.length;e<i;e++)if(!!t[e])for(r in t[e])n[r]=t[e][r];return n};Or.validateSettings=function(n){return"linLogMode"in n&&typeof n.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in n&&typeof n.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in n&&typeof n.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in n&&typeof n.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in n&&!(typeof n.scalingRatio=="number"&&n.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in n&&typeof n.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in n&&!(typeof n.gravity=="number"&&n.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in n&&!(typeof n.slowDown=="number"||n.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in n&&typeof n.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in n&&!(typeof n.barnesHutTheta=="number"&&n.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null};Or.graphToByteArrays=function(n,t){var e=n.order,r=n.size,i={},o,a=new Float32Array(e*Si),s=new Float32Array(r*eu);return o=0,n.forEachNode(function(c,l){i[c]=o,a[o]=l.x,a[o+1]=l.y,a[o+2]=0,a[o+3]=0,a[o+4]=0,a[o+5]=0,a[o+6]=1,a[o+7]=1,a[o+8]=l.size||1,a[o+9]=l.fixed?1:0,o+=Si}),o=0,n.forEachEdge(function(c,l,f,p,g,v,m){var E=i[f],S=i[p],C=t(c,l,f,p,g,v,m);a[E+6]+=C,a[S+6]+=C,s[o]=E,s[o+1]=S,s[o+2]=C,o+=eu}),{nodes:a,edges:s}};Or.assignLayoutChanges=function(n,t,e){var r=0;n.updateEachNodeAttributes(function(i,o){return o.x=t[r],o.y=t[r+1],r+=Si,e?e(i,o):o})};Or.readGraphPositions=function(n,t){var e=0;n.forEachNode(function(r,i){t[e]=i.x,t[e+1]=i.y,e+=Si})};Or.collectLayoutChanges=function(n,t,e){for(var r=n.nodes(),i={},o=0,a=0,s=t.length;o<s;o+=Si){if(e){var c=Object.assign({},n.getNodeAttributes(r[a]));c.x=t[o],c.y=t[o+1],c=e(r[a],c),i[r[a]]={x:c.x,y:c.y}}else i[r[a]]={x:t[o],y:t[o+1]};a++}return i};Or.createWorker=function(t){var e=window.URL||window.webkitURL,r=t.toString(),i=e.createObjectURL(new Blob(["("+r+").call(this);"],{type:"text/javascript"})),o=new Worker(i);return e.revokeObjectURL(i),o};var Dl={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5},mp=vp,yp=on,bp=In.createEdgeWeightGetter,Sn=Or,wp=Dl;function Nr(n,t){if(t=t||{},!yp(n))throw new Error("graphology-layout-forceatlas2/worker: the given graph is not a valid graphology instance.");var e=bp("getEdgeWeight"in t?t.getEdgeWeight:"weight").fromEntry,r=Sn.assign({},wp,t.settings),i=Sn.validateSettings(r);if(i)throw new Error("graphology-layout-forceatlas2/worker: "+i.message);this.worker=null,this.graph=n,this.settings=r,this.getEdgeWeight=e,this.matrices=null,this.running=!1,this.killed=!1,this.outputReducer=typeof t.outputReducer=="function"?t.outputReducer:null,this.handleMessage=this.handleMessage.bind(this);var o=void 0,a=this;this.handleGraphUpdate=function(){a.worker&&a.worker.terminate(),o&&clearTimeout(o),o=setTimeout(function(){o=void 0,a.spawnWorker()},0)},n.on("nodeAdded",this.handleGraphUpdate),n.on("edgeAdded",this.handleGraphUpdate),n.on("nodeDropped",this.handleGraphUpdate),n.on("edgeDropped",this.handleGraphUpdate),this.spawnWorker()}Nr.prototype.isRunning=function(){return this.running};Nr.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=Sn.createWorker(mp),this.worker.addEventListener("message",this.handleMessage),this.running&&(this.running=!1,this.start())};Nr.prototype.handleMessage=function(n){if(!!this.running){var t=new Float32Array(n.data.nodes);Sn.assignLayoutChanges(this.graph,t,this.outputReducer),this.outputReducer&&Sn.readGraphPositions(this.graph,t),this.matrices.nodes=t,this.askForIterations()}};Nr.prototype.askForIterations=function(n){var t=this.matrices,e={settings:this.settings,nodes:t.nodes.buffer},r=[t.nodes.buffer];return n&&(e.edges=t.edges.buffer,r.push(t.edges.buffer)),this.worker.postMessage(e,r),this};Nr.prototype.start=function(){if(this.killed)throw new Error("graphology-layout-forceatlas2/worker.start: layout was killed.");return this.running?this:(this.matrices=Sn.graphToByteArrays(this.graph,this.getEdgeWeight),this.running=!0,this.askForIterations(!0),this)};Nr.prototype.stop=function(){return this.running=!1,this};Nr.prototype.kill=function(){if(this.killed)return this;this.running=!1,this.killed=!0,this.matrices=null,this.worker.terminate(),this.graph.removeListener("nodeAdded",this.handleGraphUpdate),this.graph.removeListener("edgeAdded",this.handleGraphUpdate),this.graph.removeListener("nodeDropped",this.handleGraphUpdate),this.graph.removeListener("edgeDropped",this.handleGraphUpdate)};var _p=Nr,gt=0,ot=1,Ge=2,$e=3,_r=4,Er=5,Me=6,tu=7,no=8,ru=9,Ep=0,Ap=1,Sp=2,At=0,Ht=1,Dt=2,Qr=3,jr=4,ct=5,Ut=6,lr=7,cr=8,nu=3,tr=10,Cp=3,Tt=9,na=10,Lp=function(t,e,r){var i,o,a,s,c,l,f,p,g,v,m=e.length,E=r.length,S=t.adjustSizes,C=t.barnesHutTheta*t.barnesHutTheta,L,O,x,A,R,b,_,w=[];for(a=0;a<m;a+=tr)e[a+_r]=e[a+Ge],e[a+Er]=e[a+$e],e[a+Ge]=0,e[a+$e]=0;if(t.outboundAttractionDistribution){for(L=0,a=0;a<m;a+=tr)L+=e[a+Me];L/=m/tr}if(t.barnesHutOptimize){var $=1/0,M=-1/0,Q=1/0,pe=-1/0,J,Te,Ve;for(a=0;a<m;a+=tr)$=Math.min($,e[a+gt]),M=Math.max(M,e[a+gt]),Q=Math.min(Q,e[a+ot]),pe=Math.max(pe,e[a+ot]);var le=M-$,D=pe-Q;for(le>D?(Q-=(le-D)/2,pe=Q+le):($-=(D-le)/2,M=$+D),w[0+At]=-1,w[0+Ht]=($+M)/2,w[0+Dt]=(Q+pe)/2,w[0+Qr]=Math.max(M-$,pe-Q),w[0+jr]=-1,w[0+ct]=-1,w[0+Ut]=0,w[0+lr]=0,w[0+cr]=0,i=1,a=0;a<m;a+=tr)for(o=0,Ve=nu;;)if(w[o+ct]>=0){e[a+gt]<w[o+Ht]?e[a+ot]<w[o+Dt]?J=w[o+ct]:J=w[o+ct]+Tt:e[a+ot]<w[o+Dt]?J=w[o+ct]+Tt*2:J=w[o+ct]+Tt*3,w[o+lr]=(w[o+lr]*w[o+Ut]+e[a+gt]*e[a+Me])/(w[o+Ut]+e[a+Me]),w[o+cr]=(w[o+cr]*w[o+Ut]+e[a+ot]*e[a+Me])/(w[o+Ut]+e[a+Me]),w[o+Ut]+=e[a+Me],o=J;continue}else if(w[o+At]<0){w[o+At]=a;break}else{if(w[o+ct]=i*Tt,p=w[o+Qr]/2,g=w[o+ct],w[g+At]=-1,w[g+Ht]=w[o+Ht]-p,w[g+Dt]=w[o+Dt]-p,w[g+Qr]=p,w[g+jr]=g+Tt,w[g+ct]=-1,w[g+Ut]=0,w[g+lr]=0,w[g+cr]=0,g+=Tt,w[g+At]=-1,w[g+Ht]=w[o+Ht]-p,w[g+Dt]=w[o+Dt]+p,w[g+Qr]=p,w[g+jr]=g+Tt,w[g+ct]=-1,w[g+Ut]=0,w[g+lr]=0,w[g+cr]=0,g+=Tt,w[g+At]=-1,w[g+Ht]=w[o+Ht]+p,w[g+Dt]=w[o+Dt]-p,w[g+Qr]=p,w[g+jr]=g+Tt,w[g+ct]=-1,w[g+Ut]=0,w[g+lr]=0,w[g+cr]=0,g+=Tt,w[g+At]=-1,w[g+Ht]=w[o+Ht]+p,w[g+Dt]=w[o+Dt]+p,w[g+Qr]=p,w[g+jr]=w[o+jr],w[g+ct]=-1,w[g+Ut]=0,w[g+lr]=0,w[g+cr]=0,i+=4,e[w[o+At]+gt]<w[o+Ht]?e[w[o+At]+ot]<w[o+Dt]?J=w[o+ct]:J=w[o+ct]+Tt:e[w[o+At]+ot]<w[o+Dt]?J=w[o+ct]+Tt*2:J=w[o+ct]+Tt*3,w[o+Ut]=e[w[o+At]+Me],w[o+lr]=e[w[o+At]+gt],w[o+cr]=e[w[o+At]+ot],w[J+At]=w[o+At],w[o+At]=-1,e[a+gt]<w[o+Ht]?e[a+ot]<w[o+Dt]?Te=w[o+ct]:Te=w[o+ct]+Tt:e[a+ot]<w[o+Dt]?Te=w[o+ct]+Tt*2:Te=w[o+ct]+Tt*3,J===Te)if(Ve--){o=J;continue}else{Ve=nu;break}w[Te+At]=a;break}}if(t.barnesHutOptimize)for(O=t.scalingRatio,a=0;a<m;a+=tr)for(o=0;;)if(w[o+ct]>=0)if(b=Math.pow(e[a+gt]-w[o+lr],2)+Math.pow(e[a+ot]-w[o+cr],2),v=w[o+Qr],4*v*v/b<C){if(x=e[a+gt]-w[o+lr],A=e[a+ot]-w[o+cr],S===!0?b>0?(_=O*e[a+Me]*w[o+Ut]/b,e[a+Ge]+=x*_,e[a+$e]+=A*_):b<0&&(_=-O*e[a+Me]*w[o+Ut]/Math.sqrt(b),e[a+Ge]+=x*_,e[a+$e]+=A*_):b>0&&(_=O*e[a+Me]*w[o+Ut]/b,e[a+Ge]+=x*_,e[a+$e]+=A*_),o=w[o+jr],o<0)break;continue}else{o=w[o+ct];continue}else{if(l=w[o+At],l>=0&&l!==a&&(x=e[a+gt]-e[l+gt],A=e[a+ot]-e[l+ot],b=x*x+A*A,S===!0?b>0?(_=O*e[a+Me]*e[l+Me]/b,e[a+Ge]+=x*_,e[a+$e]+=A*_):b<0&&(_=-O*e[a+Me]*e[l+Me]/Math.sqrt(b),e[a+Ge]+=x*_,e[a+$e]+=A*_):b>0&&(_=O*e[a+Me]*e[l+Me]/b,e[a+Ge]+=x*_,e[a+$e]+=A*_)),o=w[o+jr],o<0)break;continue}else for(O=t.scalingRatio,s=0;s<m;s+=tr)for(c=0;c<s;c+=tr)x=e[s+gt]-e[c+gt],A=e[s+ot]-e[c+ot],S===!0?(b=Math.sqrt(x*x+A*A)-e[s+no]-e[c+no],b>0?(_=O*e[s+Me]*e[c+Me]/b/b,e[s+Ge]+=x*_,e[s+$e]+=A*_,e[c+Ge]-=x*_,e[c+$e]-=A*_):b<0&&(_=100*O*e[s+Me]*e[c+Me],e[s+Ge]+=x*_,e[s+$e]+=A*_,e[c+Ge]-=x*_,e[c+$e]-=A*_)):(b=Math.sqrt(x*x+A*A),b>0&&(_=O*e[s+Me]*e[c+Me]/b/b,e[s+Ge]+=x*_,e[s+$e]+=A*_,e[c+Ge]-=x*_,e[c+$e]-=A*_));for(g=t.gravity/t.scalingRatio,O=t.scalingRatio,a=0;a<m;a+=tr)_=0,x=e[a+gt],A=e[a+ot],b=Math.sqrt(Math.pow(x,2)+Math.pow(A,2)),t.strongGravityMode?b>0&&(_=O*e[a+Me]*g):b>0&&(_=O*e[a+Me]*g/b),e[a+Ge]-=x*_,e[a+$e]-=A*_;for(O=1*(t.outboundAttractionDistribution?L:1),f=0;f<E;f+=Cp)s=r[f+Ep],c=r[f+Ap],p=r[f+Sp],R=Math.pow(p,t.edgeWeightInfluence),x=e[s+gt]-e[c+gt],A=e[s+ot]-e[c+ot],S===!0?(b=Math.sqrt(x*x+A*A)-e[s+no]-e[c+no],t.linLogMode?t.outboundAttractionDistribution?b>0&&(_=-O*R*Math.log(1+b)/b/e[s+Me]):b>0&&(_=-O*R*Math.log(1+b)/b):t.outboundAttractionDistribution?b>0&&(_=-O*R/e[s+Me]):b>0&&(_=-O*R)):(b=Math.sqrt(Math.pow(x,2)+Math.pow(A,2)),t.linLogMode?t.outboundAttractionDistribution?b>0&&(_=-O*R*Math.log(1+b)/b/e[s+Me]):b>0&&(_=-O*R*Math.log(1+b)/b):t.outboundAttractionDistribution?(b=1,_=-O*R/e[s+Me]):(b=1,_=-O*R)),b>0&&(e[s+Ge]+=x*_,e[s+$e]+=A*_,e[c+Ge]-=x*_,e[c+$e]-=A*_);var U,B,I,P,fe,K;if(S===!0)for(a=0;a<m;a+=tr)e[a+ru]!==1&&(U=Math.sqrt(Math.pow(e[a+Ge],2)+Math.pow(e[a+$e],2)),U>na&&(e[a+Ge]=e[a+Ge]*na/U,e[a+$e]=e[a+$e]*na/U),B=e[a+Me]*Math.sqrt((e[a+_r]-e[a+Ge])*(e[a+_r]-e[a+Ge])+(e[a+Er]-e[a+$e])*(e[a+Er]-e[a+$e])),I=Math.sqrt((e[a+_r]+e[a+Ge])*(e[a+_r]+e[a+Ge])+(e[a+Er]+e[a+$e])*(e[a+Er]+e[a+$e]))/2,P=.1*Math.log(1+I)/(1+Math.sqrt(B)),fe=e[a+gt]+e[a+Ge]*(P/t.slowDown),e[a+gt]=fe,K=e[a+ot]+e[a+$e]*(P/t.slowDown),e[a+ot]=K);else for(a=0;a<m;a+=tr)e[a+ru]!==1&&(B=e[a+Me]*Math.sqrt((e[a+_r]-e[a+Ge])*(e[a+_r]-e[a+Ge])+(e[a+Er]-e[a+$e])*(e[a+Er]-e[a+$e])),I=Math.sqrt((e[a+_r]+e[a+Ge])*(e[a+_r]+e[a+Ge])+(e[a+Er]+e[a+$e])*(e[a+Er]+e[a+$e]))/2,P=e[a+tu]*Math.log(1+I)/(1+Math.sqrt(B)),e[a+tu]=Math.min(1,Math.sqrt(P*(Math.pow(e[a+Ge],2)+Math.pow(e[a+$e],2))/(1+Math.sqrt(B)))),fe=e[a+gt]+e[a+Ge]*(P/t.slowDown),e[a+gt]=fe,K=e[a+ot]+e[a+$e]*(P/t.slowDown),e[a+ot]=K);return{}},Tp=on,Op=In.createEdgeWeightGetter,kp=Lp,fi=Or,xp=Dl;function Pl(n,t,e){if(!Tp(t))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof e=="number"&&(e={iterations:e});var r=e.iterations;if(typeof r!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(r<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var i=Op("getEdgeWeight"in e?e.getEdgeWeight:"weight").fromEntry,o=typeof e.outputReducer=="function"?e.outputReducer:null,a=fi.assign({},xp,e.settings),s=fi.validateSettings(a);if(s)throw new Error("graphology-layout-forceatlas2: "+s.message);var c=fi.graphToByteArrays(t,i),l;for(l=0;l<r;l++)kp(a,c.nodes,c.edges);if(n){fi.assignLayoutChanges(t,c.nodes,o);return}return fi.collectLayoutChanges(t,c.nodes)}function Dp(n){var t=typeof n=="number"?n:n.order;return{barnesHutOptimize:t>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(t)}}var Ua=Pl.bind(null,!1);Ua.assign=Pl.bind(null,!0);Ua.inferSettings=Dp;var Pp=Ua;const Rp=4;function Fp(n,t){var e;return(e=n==null?void 0:n.filter(r=>t.includes(r)))!=null?e:[]}function Rl(n,t=Rp){return Math.round(n*Math.pow(10,t))/Math.pow(10,t)}function Ip(n){return n.length===0?0:n.reduce((t,e)=>t+e)}function jp(n,t){const e={},r=n.neighbors(t);return n.forEachNode(i=>{const o=n.neighbors(i),a=Fp(r,o);let s=1/0;if(a.length){const c=a.map(l=>n.outNeighbors(l).length);s=Rl(Ip(c.map(l=>1/Math.log(l))))}e[i]={measure:s,extra:a}}),Object.fromEntries(Object.entries(e).filter(([i,o])=>o.measure!==0&&Number.isFinite(o.measure)))}const Gp=async(n,t)=>{const e=c=>`[
    :find ?b ?page 
    :where 
      [?b :block/path-refs ?link]
      [?link :block/name "${c}"]
      [?b :block/path-refs ?otherlinks]
      [?otherlinks :block/name ?page]
    ]`,r=n.getNodeAttributes(t),i=await Promise.all([r.label,...r.rawAliases].map(c=>logseq.DB.datascriptQuery(e(c))));console.log(i);const o={};for(const c of i.flat()){const l=Ai(n,c[1]);!l||(o[l]?o[l]+=1:o[l]=1)}const a=Math.max(...Object.values(o)),s={};for(const c of Object.keys(o))s[c]={measure:Rl(10*o[c]/a),extra:["1"]};return s};function mn(n,t,e){const r=Ai(n,t),i=Ai(n,e);if(!r||!i)return{nodes:void 0,edges:void 0};const o=ga.bidirectional(n,r,i)||ga.bidirectional(n,i,r);if(o){const a=Yf(n,o);return{nodes:o,edges:a}}else return{nodes:void 0,edges:void 0}}function va(n,t,e){const r=Ai(n,t),i=Ai(n,e);if(!r||!i)return{nodes:void 0,edges:void 0};const o=Ll(n),a=ga.bidirectional(o,r,i);if(a){const s=[];for(let c=0;c<a.length-1;c++){const l=n.directedEdges(a[c],a[c+1]).concat(n.directedEdges(a[c],a[c+1]));l.length&&s.push(l[0])}return{nodes:a,edges:s}}else return{nodes:void 0,edges:void 0}}function $p(n,t){return n==null?void 0:n.includes(t)}if(yo.vitest){const{it:n,expect:t,describe:e}=yo.vitest;e("shortestPathDirected",()=>{n("returns directed paths",()=>{const r=new ke;r.addNode("A",{label:"A"}),r.addNode("B",{label:"B"}),r.addNode("C",{label:"C"}),r.addEdge("A","B"),r.addEdge("B","C");const{nodes:i,edges:o}=mn(r,"A","C");t(i).toMatchObject(["A","B","C"]),t(o).toMatchObject([r.edge("A","B"),r.edge("B","C")])}),n("returns directed paths even if backwards",()=>{const r=new ke;r.addNode("A",{label:"A"}),r.addNode("B",{label:"B"}),r.addNode("C",{label:"C"}),r.addEdge("A","B"),r.addEdge("B","C");const{nodes:i,edges:o}=mn(r,"C","A");t(i).toMatchObject(["A","B","C"]),t(o).toMatchObject([r.edge("A","B"),r.edge("B","C")])}),n("will not return undirected paths",()=>{const r=new ke;r.addNode("A",{label:"A"}),r.addNode("B",{label:"B"}),r.addNode("C",{label:"C"}),r.addEdge("A","B"),r.addEdge("C","B");const{nodes:i,edges:o}=mn(r,"C","A");t(i).toBeUndefined(),t(o).toBeUndefined()}),n("will not return disconnected paths",()=>{const r=new ke;r.addNode("A",{label:"A"}),r.addNode("B",{label:"B"}),r.addNode("C",{label:"C"}),r.addEdge("A","B");const{nodes:i,edges:o}=mn(r,"A","C");t(i).toBeUndefined(),t(o).toBeUndefined()})}),e("shortestPathUndirected",()=>{n("will return undirected paths",()=>{const r=new ke;r.addNode("A",{label:"A"}),r.addNode("B",{label:"B"}),r.addNode("C",{label:"C"}),r.addEdge("A","B"),r.addEdge("C","B");const{nodes:i,edges:o}=va(r,"A","C");t(i).toMatchObject(["A","B","C"]),t(o).toMatchObject([r.edge("A","B"),r.edge("C","B")])}),n("will not return disconnected paths",()=>{const r=new ke;r.addNode("A",{label:"A"}),r.addNode("B",{label:"B"}),r.addNode("C",{label:"C"}),r.addEdge("A","B");const{nodes:i,edges:o}=va(r,"A","C");t(i).toBeUndefined(),t(o).toBeUndefined()}),n("returns paths that involve aliases",()=>{const r=new ke;r.addNode("A",{label:"A",aliases:["B"]}),r.addNode("C",{label:"C"}),r.addEdge("C","A");const{nodes:i,edges:o}=mn(r,"B","C");t(i).toMatchObject(["C","A"]),t(o).toMatchObject([r.edge("C","A")])})})}var Na={},we={},Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.multiplyVec2=Pt.multiply=Pt.translate=Pt.rotate=Pt.scale=Pt.identity=void 0;function Up(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}Pt.identity=Up;function Np(n,t,e){return n[0]=t,n[4]=typeof e=="number"?e:t,n}Pt.scale=Np;function Mp(n,t){var e=Math.sin(t),r=Math.cos(t);return n[0]=r,n[1]=e,n[3]=-e,n[4]=r,n}Pt.rotate=Mp;function zp(n,t,e){return n[6]=t,n[7]=e,n}Pt.translate=zp;function Bp(n,t){var e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],c=n[6],l=n[7],f=n[8],p=t[0],g=t[1],v=t[2],m=t[3],E=t[4],S=t[5],C=t[6],L=t[7],O=t[8];return n[0]=p*e+g*o+v*c,n[1]=p*r+g*a+v*l,n[2]=p*i+g*s+v*f,n[3]=m*e+E*o+S*c,n[4]=m*r+E*a+S*l,n[5]=m*i+E*s+S*f,n[6]=C*e+L*o+O*c,n[7]=C*r+L*a+O*l,n[8]=C*i+L*s+O*f,n}Pt.multiply=Bp;function Wp(n,t,e){e===void 0&&(e=1);var r=n[0],i=n[1],o=n[3],a=n[4],s=n[6],c=n[7],l=t.x,f=t.y;return{x:l*r+f*o+s*e,y:l*i+f*a+c*e}}Pt.multiplyVec2=Wp;var To={};Object.defineProperty(To,"__esModule",{value:!0});To.HTML_COLORS=void 0;To.HTML_COLORS={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"};var iu=Y&&Y.__read||function(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r=e.call(n),i,o=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(a)throw a.error}}return o},qp=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(we,"__esModule",{value:!0});we.validateGraph=we.canUse32BitsIndices=we.extractPixel=we.getMatrixImpact=we.matrixFromCamera=we.getCorrectionRatio=we.floatColor=we.floatArrayColor=we.parseColor=we.zIndexOrdering=we.createNormalizationFunction=we.graphExtent=we.getPixelRatio=we.createElement=we.cancelFrame=we.requestFrame=we.assignDeep=we.assign=we.isPlainObject=void 0;var Hp=qp(on),Ze=Pt,fo=To;function Fl(n){return typeof n=="object"&&n!==null&&n.constructor===Object}we.isPlainObject=Fl;function Vp(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];n=n||{};for(var r=0,i=t.length;r<i;r++){var o=t[r];!o||Object.assign(n,o)}return n}we.assign=Vp;function Il(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];n=n||{};for(var r=0,i=t.length;r<i;r++){var o=t[r];if(!!o)for(var a in o)Fl(o[a])?n[a]=Il(n[a],o[a]):n[a]=o[a]}return n}we.assignDeep=Il;we.requestFrame=typeof requestAnimationFrame!="undefined"?function(n){return requestAnimationFrame(n)}:function(n){return setTimeout(n,0)};we.cancelFrame=typeof cancelAnimationFrame!="undefined"?function(n){return cancelAnimationFrame(n)}:function(n){return clearTimeout(n)};function Yp(n,t,e){var r=document.createElement(n);if(t)for(var i in t)r.style[i]=t[i];if(e)for(var i in e)r.setAttribute(i,e[i]);return r}we.createElement=Yp;function Kp(){return typeof window.devicePixelRatio!="undefined"?window.devicePixelRatio:1}we.getPixelRatio=Kp;function Zp(n){if(!n.order)return{x:[0,1],y:[0,1]};var t=1/0,e=-1/0,r=1/0,i=-1/0;return n.forEachNode(function(o,a){var s=a.x,c=a.y;s<t&&(t=s),s>e&&(e=s),c<r&&(r=c),c>i&&(i=c)}),{x:[t,e],y:[r,i]}}we.graphExtent=Zp;function Xp(n){var t=iu(n.x,2),e=t[0],r=t[1],i=iu(n.y,2),o=i[0],a=i[1],s=Math.max(r-e,a-o),c=(r+e)/2,l=(a+o)/2;(s===0||Math.abs(s)===1/0||isNaN(s))&&(s=1),isNaN(c)&&(c=0),isNaN(l)&&(l=0);var f=function(p){return{x:.5+(p.x-c)/s,y:.5+(p.y-l)/s}};return f.applyTo=function(p){p.x=.5+(p.x-c)/s,p.y=.5+(p.y-l)/s},f.inverse=function(p){return{x:c+s*(p.x-.5),y:l+s*(p.y-.5)}},f.ratio=s,f}we.createNormalizationFunction=Xp;function Qp(n,t,e){return e.sort(function(r,i){var o=t(r)||0,a=t(i)||0;return o<a?-1:o>a?1:0})}we.zIndexOrdering=Qp;var jl=new Int8Array(4),Jp=new Int32Array(jl.buffer,0,1),eg=new Float32Array(jl.buffer,0,1),tg=/^\s*rgba?\s*\(/,rg=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function Ma(n){var t=0,e=0,r=0,i=1;if(n[0]==="#")n.length===4?(t=parseInt(n.charAt(1)+n.charAt(1),16),e=parseInt(n.charAt(2)+n.charAt(2),16),r=parseInt(n.charAt(3)+n.charAt(3),16)):(t=parseInt(n.charAt(1)+n.charAt(2),16),e=parseInt(n.charAt(3)+n.charAt(4),16),r=parseInt(n.charAt(5)+n.charAt(6),16));else if(tg.test(n)){var o=n.match(rg);o&&(t=+o[1],e=+o[2],r=+o[3],o[4]&&(i=+o[4]))}return{r:t,g:e,b:r,a:i}}we.parseColor=Ma;var wn={};for(var io in fo.HTML_COLORS)wn[io]=Gl(fo.HTML_COLORS[io]),wn[fo.HTML_COLORS[io]]=wn[io];function ng(n){n=fo.HTML_COLORS[n]||n;var t=Ma(n),e=t.r,r=t.g,i=t.b,o=t.a;return new Float32Array([e/255,r/255,i/255,o])}we.floatArrayColor=ng;function Gl(n){if(typeof wn[n]!="undefined")return wn[n];var t=Ma(n),e=t.r,r=t.g,i=t.b,o=t.a;o=o*255|0,Jp[0]=(o<<24|i<<16|r<<8|e)&4278190079;var a=eg[0];return wn[n]=a,a}we.floatColor=Gl;function $l(n,t){var e=n.height/n.width,r=t.height/t.width;return e<1&&r>1||e>1&&r<1?1:Math.min(Math.max(r,1/r),Math.max(1/e,e))}we.getCorrectionRatio=$l;function ig(n,t,e,r,i){var o=n.angle,a=n.ratio,s=n.x,c=n.y,l=t.width,f=t.height,p=(0,Ze.identity)(),g=Math.min(l,f)-2*r,v=$l(t,e);return i?((0,Ze.multiply)(p,(0,Ze.translate)((0,Ze.identity)(),s,c)),(0,Ze.multiply)(p,(0,Ze.scale)((0,Ze.identity)(),a)),(0,Ze.multiply)(p,(0,Ze.rotate)((0,Ze.identity)(),o)),(0,Ze.multiply)(p,(0,Ze.scale)((0,Ze.identity)(),l/g/2/v,f/g/2/v))):((0,Ze.multiply)(p,(0,Ze.scale)((0,Ze.identity)(),2*(g/l)*v,2*(g/f)*v)),(0,Ze.multiply)(p,(0,Ze.rotate)((0,Ze.identity)(),-o)),(0,Ze.multiply)(p,(0,Ze.scale)((0,Ze.identity)(),1/a)),(0,Ze.multiply)(p,(0,Ze.translate)((0,Ze.identity)(),-s,-c))),p}we.matrixFromCamera=ig;function og(n,t,e){var r=(0,Ze.multiplyVec2)(n,{x:Math.cos(t.angle),y:Math.sin(t.angle)},0),i=r.x,o=r.y;return 1/Math.sqrt(Math.pow(i,2)+Math.pow(o,2))/e.width}we.getMatrixImpact=og;function ag(n,t,e,r){var i=r||new Uint8Array(4);return n.readPixels(t,e,1,1,n.RGBA,n.UNSIGNED_BYTE,i),i}we.extractPixel=ag;function sg(n){var t=typeof WebGL2RenderingContext!="undefined"&&n instanceof WebGL2RenderingContext;return t||!!n.getExtension("OES_element_index_uint")}we.canUse32BitsIndices=sg;function ug(n){if(!(0,Hp.default)(n))throw new Error("Sigma: invalid graph instance.");n.forEachNode(function(t,e){if(!Number.isFinite(e.x)||!Number.isFinite(e.y))throw new Error("Sigma: Coordinates of node ".concat(t," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}we.validateGraph=ug;var Ul={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`attribute vec2 a_position;
attribute float a_size;
attribute vec4 a_color;

uniform float u_ratio;
uniform float u_scale;
uniform mat3 u_matrix;

varying vec4 v_color;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  gl_Position = vec4(
    (u_matrix * vec3(a_position, 1)).xy,
    0,
    1
  );

  // Multiply the point size twice:
  //  - x SCALING_RATIO to correct the canvas scaling
  //  - x 2 to correct the formulae
  gl_PointSize = a_size * u_ratio * u_scale * 2.0;

  v_border = (1.0 / u_ratio) * (0.5 / a_size);

  // Extract the color:
  v_color = a_color;
  v_color.a *= bias;
}
`;Ul.exports=t})();var Nl={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`precision mediump float;

varying vec4 v_color;
varying float v_border;

const float radius = 0.5;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  vec2 m = gl_PointCoord - vec2(0.5, 0.5);
  float dist = radius - length(m);

  float t = 0.0;
  if (dist > v_border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / v_border;

  gl_FragColor = mix(transparent, v_color, t);
}
`;Nl.exports=t})();var rn={},ki={},Ur={};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.loadProgram=Ur.loadFragmentShader=Ur.loadVertexShader=void 0;function Ml(n,t,e){var r=n==="VERTEX"?t.VERTEX_SHADER:t.FRAGMENT_SHADER,i=t.createShader(r);if(i===null)throw new Error("loadShader: error while creating the shader");t.shaderSource(i,e),t.compileShader(i);var o=t.getShaderParameter(i,t.COMPILE_STATUS);if(!o){var a=t.getShaderInfoLog(i);throw t.deleteShader(i),new Error(`loadShader: error while compiling the shader:
`.concat(a,`
`).concat(e))}return i}function lg(n,t){return Ml("VERTEX",n,t)}Ur.loadVertexShader=lg;function cg(n,t){return Ml("FRAGMENT",n,t)}Ur.loadFragmentShader=cg;function hg(n,t){var e=n.createProgram();if(e===null)throw new Error("loadProgram: error while creating the program.");var r,i;for(r=0,i=t.length;r<i;r++)n.attachShader(e,t[r]);n.linkProgram(e);var o=n.getProgramParameter(e,n.LINK_STATUS);if(!o)throw n.deleteProgram(e),new Error("loadProgram: error while linking the program.");return e}Ur.loadProgram=hg;Object.defineProperty(ki,"__esModule",{value:!0});ki.AbstractProgram=void 0;var ia=Ur,dg=function(){function n(t,e,r,i,o){this.array=new Float32Array,this.points=i,this.attributes=o,this.gl=t,this.vertexShaderSource=e,this.fragmentShaderSource=r;var a=t.createBuffer();if(a===null)throw new Error("AbstractProgram: error while creating the buffer");this.buffer=a,t.bindBuffer(t.ARRAY_BUFFER,this.buffer),this.vertexShader=(0,ia.loadVertexShader)(t,this.vertexShaderSource),this.fragmentShader=(0,ia.loadFragmentShader)(t,this.fragmentShaderSource),this.program=(0,ia.loadProgram)(t,[this.vertexShader,this.fragmentShader])}return n.prototype.bufferData=function(){var t=this.gl;t.bufferData(t.ARRAY_BUFFER,this.array,t.DYNAMIC_DRAW)},n.prototype.allocate=function(t){this.array=new Float32Array(this.points*this.attributes*t)},n.prototype.hasNothingToRender=function(){return this.array.length===0},n}();ki.AbstractProgram=dg;var fg=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(rn,"__esModule",{value:!0});rn.createNodeCompoundProgram=rn.AbstractNodeProgram=void 0;var pg=ki,gg=function(n){fg(t,n);function t(e,r,i,o,a){var s=n.call(this,e,r,i,o,a)||this;s.positionLocation=e.getAttribLocation(s.program,"a_position"),s.sizeLocation=e.getAttribLocation(s.program,"a_size"),s.colorLocation=e.getAttribLocation(s.program,"a_color");var c=e.getUniformLocation(s.program,"u_matrix");if(c===null)throw new Error("AbstractNodeProgram: error while getting matrixLocation");s.matrixLocation=c;var l=e.getUniformLocation(s.program,"u_ratio");if(l===null)throw new Error("AbstractNodeProgram: error while getting ratioLocation");s.ratioLocation=l;var f=e.getUniformLocation(s.program,"u_scale");if(f===null)throw new Error("AbstractNodeProgram: error while getting scaleLocation");return s.scaleLocation=f,s}return t.prototype.bind=function(){var e=this.gl;e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.sizeLocation),e.enableVertexAttribArray(this.colorLocation),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(this.sizeLocation,1,e.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,8),e.vertexAttribPointer(this.colorLocation,4,e.UNSIGNED_BYTE,!0,this.attributes*Float32Array.BYTES_PER_ELEMENT,12)},t}(pg.AbstractProgram);rn.AbstractNodeProgram=gg;function vg(n){return function(){function t(e,r){this.programs=n.map(function(i){return new i(e,r)})}return t.prototype.bufferData=function(){this.programs.forEach(function(e){return e.bufferData()})},t.prototype.allocate=function(e){this.programs.forEach(function(r){return r.allocate(e)})},t.prototype.bind=function(){},t.prototype.render=function(e){this.programs.forEach(function(r){r.bind(),r.bufferData(),r.render(e)})},t.prototype.process=function(e,r,i){this.programs.forEach(function(o){return o.process(e,r,i)})},t}()}rn.createNodeCompoundProgram=vg;var mg=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),zl=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Na,"__esModule",{value:!0});var yg=we,bg=zl(Ul.exports),wg=zl(Nl.exports),_g=rn,ou=1,oa=4,Eg=function(n){mg(t,n);function t(e){var r=n.call(this,e,bg.default,wg.default,ou,oa)||this;return r.bind(),r}return t.prototype.process=function(e,r,i){var o=this.array,a=i*ou*oa;if(r){o[a++]=0,o[a++]=0,o[a++]=0,o[a++]=0;return}var s=(0,yg.floatColor)(e.color);o[a++]=e.x,o[a++]=e.y,o[a++]=e.size,o[a]=s},t.prototype.render=function(e){if(!this.hasNothingToRender()){var r=this.gl,i=this.program;r.useProgram(i),r.uniform1f(this.ratioLocation,1/Math.sqrt(e.ratio)),r.uniform1f(this.scaleLocation,e.scalingRatio),r.uniformMatrix3fv(this.matrixLocation,!1,e.matrix),r.drawArrays(r.POINTS,0,this.array.length/oa)}},t}(_g.AbstractNodeProgram),Ag=Na.default=Eg,Bl={},Wl={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`attribute vec2 a_position;
attribute float a_size;
attribute vec4 a_color;
attribute vec4 a_texture;

uniform float u_ratio;
uniform float u_scale;
uniform mat3 u_matrix;

varying vec4 v_color;
varying float v_border;
varying vec4 v_texture;

const float bias = 255.0 / 254.0;

void main() {
  gl_Position = vec4(
    (u_matrix * vec3(a_position, 1)).xy,
    0,
    1
  );

  // Multiply the point size twice:
  //  - x SCALING_RATIO to correct the canvas scaling
  //  - x 2 to correct the formulae
  gl_PointSize = a_size * u_ratio * u_scale * 2.0;

  v_border = (1.0 / u_ratio) * (0.5 / a_size);

  // Extract the color:
  v_color = a_color;
  v_color.a *= bias;

  // Pass the texture coordinates:
  v_texture = a_texture;
}
`;Wl.exports=t})();var ql={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`precision mediump float;

varying vec4 v_color;
varying float v_border;
varying vec4 v_texture;

uniform sampler2D u_atlas;

const float radius = 0.5;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  vec4 color;

  if (v_texture.w > 0.0) {
    vec4 texel = texture2D(u_atlas, v_texture.xy + gl_PointCoord * v_texture.zw, -1.0);
    color = vec4(mix(v_color, texel, texel.a).rgb, max(texel.a, v_color.a));
  } else {
    color = v_color;
  }

  vec2 m = gl_PointCoord - vec2(0.5, 0.5);
  float dist = length(m);

  if (dist < radius - v_border) {
    gl_FragColor = color;
  } else if (dist < radius) {
    gl_FragColor = mix(transparent, color, (radius - dist) / v_border);
  } else {
    gl_FragColor = transparent;
  }
}
`;ql.exports=t})();var Hl=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Sg=Y&&Y.__read||function(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r=e.call(n),i,o=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(a)throw a.error}}return o},Cg=Y&&Y.__spreadArray||function(n,t,e){if(e||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return n.concat(o||Array.prototype.slice.call(t))},Vl=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Bl,"__esModule",{value:!0});var Lg=we,Yl=Vl(Wl.exports),Kl=Vl(ql.exports),Zl=rn,ma=1,po=8,Tg=100;(function(n){Hl(t,n);function t(e,r){return n.call(this,e,Yl.default,Kl.default,ma,po)||this}return t.prototype.bind=function(){},t.prototype.process=function(e,r,i){},t.prototype.render=function(e){},t.prototype.rebindTexture=function(){},t})(Zl.AbstractNodeProgram);function Og(){var n=[],t={},e,r=!1,i=void 0;function o(s){if(!t[s]){var c=new Image;c.addEventListener("load",function(){t[s]={status:"pending",image:c},typeof i!="number"&&(i=requestAnimationFrame(function(){return a()}))}),c.addEventListener("error",function(){t[s]={status:"error"}}),t[s]={status:"loading"},c.setAttribute("crossOrigin",""),c.src=s}}function a(){i=void 0;var s=[];for(var c in t){var l=t[c];l.status==="pending"&&s.push({id:c,image:l.image,size:Math.min(l.image.width,l.image.height)||1})}var f=document.createElement("canvas"),p=f.getContext("2d");f.width=s.reduce(function(v,m){var E=m.size;return v+E},r?e.width:0),f.height=Math.max.apply(Math,Cg([r?e.height:0],Sg(s.map(function(v){var m=v.size;return m})),!1));var g=0;r&&(p.putImageData(e,0,0),g=e.width),s.forEach(function(v){var m=v.id,E=v.image,S=v.size,C=Math.min(Tg,S),L=0,O=0;(E.width||0)>(E.height||0)?L=(E.width-E.height)/2:O=(E.height-E.width)/2,p.drawImage(E,L,O,S,S,g,0,C,C),t[m]={status:"ready",x:g,y:0,width:C,height:C},g+=C}),e=p.getImageData(0,0,f.width,f.height),r=!0,n.forEach(function(v){return v()})}return function(s){Hl(c,s);function c(l,f){var p=s.call(this,l,Yl.default,Kl.default,ma,po)||this;n.push(function(){p&&p.rebindTexture&&p.rebindTexture(),f&&f.refresh&&f.refresh()}),e=new ImageData(1,1),p.textureLocation=l.getAttribLocation(p.program,"a_texture");var g=l.getUniformLocation(p.program,"u_atlas");if(g===null)throw new Error("NodeProgramImage: error while getting atlasLocation");return p.atlasLocation=g,p.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,p.texture),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),p.bind(),p}return c.prototype.bind=function(){s.prototype.bind.call(this);var l=this.gl;l.enableVertexAttribArray(this.textureLocation),l.vertexAttribPointer(this.textureLocation,4,l.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,16)},c.prototype.process=function(l,f,p){var g=this.array,v=p*ma*po,m=l.image,E=m&&t[m];if(typeof m=="string"&&!E&&o(m),f){g[v++]=0,g[v++]=0,g[v++]=0,g[v++]=0,g[v++]=0,g[v++]=0,g[v++]=0,g[v++]=0;return}if(g[v++]=l.x,g[v++]=l.y,g[v++]=l.size,g[v++]=(0,Lg.floatColor)(l.color),E&&E.status==="ready"){var S=e.width,C=e.height;g[v++]=E.x/S,g[v++]=E.y/C,g[v++]=E.width/S,g[v++]=E.height/C}else g[v++]=0,g[v++]=0,g[v++]=0,g[v++]=0},c.prototype.render=function(l){if(!this.hasNothingToRender()){this.latestRenderParams=l;var f=this.gl,p=this.program;f.useProgram(p),f.uniform1f(this.ratioLocation,1/Math.sqrt(l.ratio)),f.uniform1f(this.scaleLocation,l.scalingRatio),f.uniformMatrix3fv(this.matrixLocation,!1,l.matrix),f.uniform1i(this.atlasLocation,0),f.drawArrays(f.POINTS,0,this.array.length/po)}},c.prototype.rebindTexture=function(){var l=this.gl;l.bindTexture(l.TEXTURE_2D,this.texture),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,e),l.generateMipmap(l.TEXTURE_2D),this.latestRenderParams&&(this.bind(),this.bufferData(),this.render(this.latestRenderParams))},c}(Zl.AbstractNodeProgram)}var kg=Bl.default=Og;const xg={mode:"light",nodeColor:"#5c5c5c",edgeColor:"#e5e5e5",nodeLabelColor:"#000000",nodeLabelBackground:"#ffffff",nodeLabelShadowColor:"rgb(0, 0, 0)"},Dg={mode:"dark",nodeColor:"#aaaaaa",edgeColor:"#444444",nodeLabelColor:"#ffffff",nodeLabelBackground:"rgb(0, 0, 0, 0.7)",nodeLabelShadowColor:"#ffffff"},ya=()=>{const n=parent.document.querySelector("#root");if(n){const t=getComputedStyle(n);document.body.style.setProperty("--theme-background",t.getPropertyValue("--ls-primary-background-color")||"#ffffff"),document.body.style.setProperty("--theme-color",t.getPropertyValue("--ls-primary-text-color")||"#000000"),document.body.style.setProperty("--theme-accent-color",t.getPropertyValue("--ls-primary-accent-color")||"#000000"),document.body.style.setProperty("--theme-secondary-background",t.getPropertyValue("--ls-secondary-background-color")||"#000000"),document.body.style.setProperty("--theme-border-color",t.getPropertyValue("--ls-border-color")||"#000000")}};function au(n){return n==="light"?xg:Dg}var Oo={};Object.defineProperty(Oo,"__esModule",{value:!0});function Pg(n,t,e){if(!!t.label){var r=e.labelSize,i=e.labelFont,o=e.labelWeight,a=e.labelColor.attribute?t[e.labelColor.attribute]||e.labelColor.color||"#000":e.labelColor.color;n.fillStyle=a,n.font="".concat(o," ").concat(r,"px ").concat(i),n.fillText(t.label,t.x+t.size+3,t.y+r/3)}}var Rg=Oo.default=Pg;function Fg(n,t,e){const r=e.labelSize,i=e.labelFont,o=e.labelWeight;n.font=`${o} ${r}px ${i}`,n.fillStyle=e.labelBackgroundColor||"#FFF",n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=8,n.shadowColor=e.labelShadowColor||"#000";const a=2;if(typeof t.label=="string"){const s=n.measureText(t.label).width,c=Math.round(s+5),l=Math.round(r+2*a),f=Math.max(t.size,r/2)+a,p=Math.asin(l/2/f),g=Math.sqrt(Math.abs(Math.pow(f,2)-Math.pow(l/2,2)));n.beginPath(),n.moveTo(t.x+g,t.y+l/2),n.lineTo(t.x+f+c,t.y+l/2),n.lineTo(t.x+f+c,t.y-l/2),n.lineTo(t.x+g,t.y-l/2),n.arc(t.x,t.y,f,p,-p),n.closePath(),n.fill()}else n.beginPath(),n.arc(t.x,t.y,t.size+a,0,Math.PI*2),n.closePath(),n.fill();n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,Rg(n,t,e)}var hr={},za={},ko={},Xl={},Ba={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.cubicInOut=n.cubicOut=n.cubicIn=n.quadraticInOut=n.quadraticOut=n.quadraticIn=n.linear=void 0;var t=function(l){return l};n.linear=t;var e=function(l){return l*l};n.quadraticIn=e;var r=function(l){return l*(2-l)};n.quadraticOut=r;var i=function(l){return(l*=2)<1?.5*l*l:-.5*(--l*(l-2)-1)};n.quadraticInOut=i;var o=function(l){return l*l*l};n.cubicIn=o;var a=function(l){return--l*l*l+1};n.cubicOut=a;var s=function(l){return(l*=2)<1?.5*l*l*l:.5*((l-=2)*l*l+2)};n.cubicInOut=s;var c={linear:n.linear,quadraticIn:n.quadraticIn,quadraticOut:n.quadraticOut,quadraticInOut:n.quadraticInOut,cubicIn:n.cubicIn,cubicOut:n.cubicOut,cubicInOut:n.cubicInOut};n.default=c})(Ba);(function(n){var t=Y&&Y.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(n,"__esModule",{value:!0}),n.animateNodes=n.ANIMATE_DEFAULTS=void 0;var e=we,r=t(Ba);n.ANIMATE_DEFAULTS={easing:"quadraticInOut",duration:150};function i(o,a,s,c){var l=Object.assign({},n.ANIMATE_DEFAULTS,s),f=typeof l.easing=="function"?l.easing:r.default[l.easing],p=Date.now(),g={};for(var v in a){var m=a[v];g[v]={};for(var E in m)g[v][E]=o.getNodeAttribute(v,E)}var S=null,C=function(){S=null;var L=(Date.now()-p)/l.duration;if(L>=1){for(var O in a){var x=a[O];for(var A in x)o.setNodeAttribute(O,A,x[A])}typeof c=="function"&&c();return}L=f(L);for(var O in a){var x=a[O],R=g[O];for(var A in x)o.setNodeAttribute(O,A,x[A]*L+R[A]*(1-L))}S=(0,e.requestFrame)(C)};return C(),function(){S&&(0,e.cancelFrame)(S)}}n.animateNodes=i})(Xl);var jn={},Ig=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(jn,"__esModule",{value:!0});jn.TypedEventEmitter=void 0;var jg=_o.exports,Gg=function(n){Ig(t,n);function t(){var e=n.call(this)||this;return e.rawEmitter=e,e}return t}(jg.EventEmitter);jn.TypedEventEmitter=Gg;var $g=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ug=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ko,"__esModule",{value:!0});var Ng=Xl,Mg=Ug(Ba),aa=we,zg=jn,oo=1.5,Bg=function(n){$g(t,n);function t(){var e=n.call(this)||this;return e.x=.5,e.y=.5,e.angle=0,e.ratio=1,e.minRatio=null,e.maxRatio=null,e.nextFrame=null,e.previousState=null,e.enabled=!0,e.previousState=e.getState(),e}return t.from=function(e){var r=new t;return r.setState(e)},t.prototype.enable=function(){return this.enabled=!0,this},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.getState=function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}},t.prototype.hasState=function(e){return this.x===e.x&&this.y===e.y&&this.ratio===e.ratio&&this.angle===e.angle},t.prototype.getPreviousState=function(){var e=this.previousState;return e?{x:e.x,y:e.y,angle:e.angle,ratio:e.ratio}:null},t.prototype.getBoundedRatio=function(e){var r=e;return typeof this.minRatio=="number"&&(r=Math.max(r,this.minRatio)),typeof this.maxRatio=="number"&&(r=Math.min(r,this.maxRatio)),r},t.prototype.validateState=function(e){var r={};return typeof e.x=="number"&&(r.x=e.x),typeof e.y=="number"&&(r.y=e.y),typeof e.angle=="number"&&(r.angle=e.angle),typeof e.ratio=="number"&&(r.ratio=this.getBoundedRatio(e.ratio)),r},t.prototype.isAnimated=function(){return!!this.nextFrame},t.prototype.setState=function(e){if(!this.enabled)return this;this.previousState=this.getState();var r=this.validateState(e);return typeof r.x=="number"&&(this.x=r.x),typeof r.y=="number"&&(this.y=r.y),typeof r.angle=="number"&&(this.angle=r.angle),typeof r.ratio=="number"&&(this.ratio=r.ratio),this.hasState(this.previousState)||this.emit("updated",this.getState()),this},t.prototype.animate=function(e,r,i){var o=this;if(!!this.enabled){var a=Object.assign({},Ng.ANIMATE_DEFAULTS,r),s=this.validateState(e),c=typeof a.easing=="function"?a.easing:Mg.default[a.easing],l=Date.now(),f=this.getState(),p=function(){var g=(Date.now()-l)/a.duration;if(g>=1){o.nextFrame=null,o.setState(s),o.animationCallback&&(o.animationCallback.call(null),o.animationCallback=void 0);return}var v=c(g),m={};typeof s.x=="number"&&(m.x=f.x+(s.x-f.x)*v),typeof s.y=="number"&&(m.y=f.y+(s.y-f.y)*v),typeof s.angle=="number"&&(m.angle=f.angle+(s.angle-f.angle)*v),typeof s.ratio=="number"&&(m.ratio=f.ratio+(s.ratio-f.ratio)*v),o.setState(m),o.nextFrame=(0,aa.requestFrame)(p)};this.nextFrame?((0,aa.cancelFrame)(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=(0,aa.requestFrame)(p)):p(),this.animationCallback=i}},t.prototype.animatedZoom=function(e){if(!e)this.animate({ratio:this.ratio/oo});else{if(typeof e=="number")return this.animate({ratio:this.ratio/e});this.animate({ratio:this.ratio/(e.factor||oo)},e)}},t.prototype.animatedUnzoom=function(e){if(!e)this.animate({ratio:this.ratio*oo});else{if(typeof e=="number")return this.animate({ratio:this.ratio*e});this.animate({ratio:this.ratio*(e.factor||oo)},e)}},t.prototype.animatedReset=function(e){this.animate({x:.5,y:.5,ratio:1,angle:0},e)},t.prototype.copy=function(){return t.from(this.getState())},t}(zg.TypedEventEmitter);ko.default=Bg;var xo={},Ot={},Wg=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Cn=Y&&Y.__assign||function(){return Cn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Cn.apply(this,arguments)};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.getWheelDelta=Ot.getTouchCoords=Ot.getTouchesArray=Ot.getWheelCoords=Ot.getMouseCoords=Ot.getPosition=void 0;var qg=jn;function Wa(n,t){var e=t.getBoundingClientRect();return{x:n.clientX-e.left,y:n.clientY-e.top}}Ot.getPosition=Wa;function Ql(n,t){var e=Cn(Cn({},Wa(n,t)),{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){e.sigmaDefaultPrevented=!0},original:n});return e}Ot.getMouseCoords=Ql;function Hg(n,t){return Cn(Cn({},Ql(n,t)),{delta:ec(n)})}Ot.getWheelCoords=Hg;var Vg=2;function Jl(n){for(var t=[],e=0,r=Math.min(n.length,Vg);e<r;e++)t.push(n[e]);return t}Ot.getTouchesArray=Jl;function Yg(n,t){return{touches:Jl(n.touches).map(function(e){return Wa(e,t)}),original:n}}Ot.getTouchCoords=Yg;function ec(n){if(typeof n.deltaY!="undefined")return n.deltaY*-3/360;if(typeof n.detail!="undefined")return n.detail/-9;throw new Error("Captor: could not extract delta from event.")}Ot.getWheelDelta=ec;var Kg=function(n){Wg(t,n);function t(e,r){var i=n.call(this)||this;return i.container=e,i.renderer=r,i}return t}(qg.TypedEventEmitter);Ot.default=Kg;var Zg=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Xg=Y&&Y.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e),Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[e]}})}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),Qg=Y&&Y.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),Jg=Y&&Y.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&Xg(t,n,e);return Qg(t,n),t};Object.defineProperty(xo,"__esModule",{value:!0});var Nt=Jg(Ot),ev=100,tv=3,rv=200,su=3,uu=250,lu=1.7,nv=300,iv=2.2,ov=200,av=function(n){Zg(t,n);function t(e,r){var i=n.call(this,e,r)||this;return i.enabled=!0,i.draggedEvents=0,i.downStartTime=null,i.lastMouseX=null,i.lastMouseY=null,i.isMouseDown=!1,i.isMoving=!1,i.movingTimeout=null,i.startCameraState=null,i.clicks=0,i.doubleClickTimeout=null,i.currentWheelDirection=0,i.handleClick=i.handleClick.bind(i),i.handleRightClick=i.handleRightClick.bind(i),i.handleDown=i.handleDown.bind(i),i.handleUp=i.handleUp.bind(i),i.handleMove=i.handleMove.bind(i),i.handleWheel=i.handleWheel.bind(i),i.handleOut=i.handleOut.bind(i),e.addEventListener("click",i.handleClick,!1),e.addEventListener("contextmenu",i.handleRightClick,!1),e.addEventListener("mousedown",i.handleDown,!1),e.addEventListener("wheel",i.handleWheel,!1),e.addEventListener("mouseout",i.handleOut,!1),document.addEventListener("mousemove",i.handleMove,!1),document.addEventListener("mouseup",i.handleUp,!1),i}return t.prototype.kill=function(){var e=this.container;e.removeEventListener("click",this.handleClick),e.removeEventListener("contextmenu",this.handleRightClick),e.removeEventListener("mousedown",this.handleDown),e.removeEventListener("wheel",this.handleWheel),e.removeEventListener("mouseout",this.handleOut),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)},t.prototype.handleClick=function(e){var r=this;if(!!this.enabled){if(this.clicks++,this.clicks===2)return this.clicks=0,typeof this.doubleClickTimeout=="number"&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(e);setTimeout(function(){r.clicks=0,r.doubleClickTimeout=null},nv),this.draggedEvents<tv&&this.emit("click",(0,Nt.getMouseCoords)(e,this.container))}},t.prototype.handleRightClick=function(e){!this.enabled||this.emit("rightClick",(0,Nt.getMouseCoords)(e,this.container))},t.prototype.handleDoubleClick=function(e){if(!!this.enabled){e.preventDefault(),e.stopPropagation();var r=(0,Nt.getMouseCoords)(e,this.container);if(this.emit("doubleClick",r),!r.sigmaDefaultPrevented){var i=this.renderer.getCamera(),o=i.getBoundedRatio(i.getState().ratio/iv);i.animate(this.renderer.getViewportZoomedState((0,Nt.getPosition)(e,this.container),o),{easing:"quadraticInOut",duration:ov})}}},t.prototype.handleDown=function(e){if(!!this.enabled){this.startCameraState=this.renderer.getCamera().getState();var r=(0,Nt.getPosition)(e,this.container),i=r.x,o=r.y;this.lastMouseX=i,this.lastMouseY=o,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0,this.emit("mousedown",(0,Nt.getMouseCoords)(e,this.container))}},t.prototype.handleUp=function(e){var r=this;if(!(!this.enabled||!this.isMouseDown)){var i=this.renderer.getCamera();this.isMouseDown=!1,typeof this.movingTimeout=="number"&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var o=(0,Nt.getPosition)(e,this.container),a=o.x,s=o.y,c=i.getState(),l=i.getPreviousState()||{x:0,y:0};this.isMoving?i.animate({x:c.x+su*(c.x-l.x),y:c.y+su*(c.y-l.y)},{duration:rv,easing:"quadraticOut"}):(this.lastMouseX!==a||this.lastMouseY!==s)&&i.setState({x:c.x,y:c.y}),this.isMoving=!1,setTimeout(function(){r.draggedEvents=0,r.renderer.refresh()},0),this.emit("mouseup",(0,Nt.getMouseCoords)(e,this.container))}},t.prototype.handleMove=function(e){var r=this;if(!!this.enabled){var i=(0,Nt.getMouseCoords)(e,this.container);if(this.emit("mousemovebody",i),e.target===this.container&&this.emit("mousemove",i),!i.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout=="number"&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){r.movingTimeout=null,r.isMoving=!1},ev);var o=this.renderer.getCamera(),a=(0,Nt.getPosition)(e,this.container),s=a.x,c=a.y,l=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),f=this.renderer.viewportToFramedGraph({x:s,y:c}),p=l.x-f.x,g=l.y-f.y,v=o.getState(),m=v.x+p,E=v.y+g;o.setState({x:m,y:E}),this.lastMouseX=s,this.lastMouseY=c,e.preventDefault(),e.stopPropagation()}}},t.prototype.handleWheel=function(e){var r=this;if(!!this.enabled){e.preventDefault(),e.stopPropagation();var i=(0,Nt.getWheelDelta)(e);if(!!i){var o=(0,Nt.getWheelCoords)(e,this.container);if(this.emit("wheel",o),!o.sigmaDefaultPrevented){var a=i>0?1/lu:lu,s=this.renderer.getCamera(),c=s.getBoundedRatio(s.getState().ratio*a),l=i>0?1:-1,f=Date.now();this.currentWheelDirection===l&&this.lastWheelTriggerTime&&f-this.lastWheelTriggerTime<uu/5||(s.animate(this.renderer.getViewportZoomedState((0,Nt.getPosition)(e,this.container),c),{easing:"quadraticOut",duration:uu},function(){r.currentWheelDirection=0}),this.currentWheelDirection=l,this.lastWheelTriggerTime=f)}}}},t.prototype.handleOut=function(){},t}(Nt.default);xo.default=av;var Vt={},cu=Y&&Y.__read||function(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r=e.call(n),i,o=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(a)throw a.error}}return o},hu=Y&&Y.__spreadArray||function(n,t,e){if(e||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return n.concat(o||Array.prototype.slice.call(t))},sv=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.rectangleCollidesWithQuad=Vt.squareCollidesWithQuad=Vt.getCircumscribedAlignedRectangle=Vt.isRectangleAligned=void 0;var uv=sv(gl),zt=4,pi=5,yn="outside",Rt=0,Ft=1,It=2,jt=3,lv=1,cv=2,hv=3,dv=4,du=!1;function tc(n){return n.x1===n.x2||n.y1===n.y2}Vt.isRectangleAligned=tc;function rc(n){var t=Math.sqrt(Math.pow(n.x2-n.x1,2)+Math.pow(n.y2-n.y1,2)),e={x:(n.y1-n.y2)*n.height/t,y:(n.x2-n.x1)*n.height/t},r={x:n.x1,y:n.y1},i={x:n.x2,y:n.y2},o={x:n.x1+e.x,y:n.y1+e.y},a={x:n.x2+e.x,y:n.y2+e.y},s=Math.min(r.x,i.x,o.x,a.x),c=Math.max(r.x,i.x,o.x,a.x),l=Math.min(r.y,i.y,o.y,a.y),f=Math.max(r.y,i.y,o.y,a.y);return{x1:s,y1:l,x2:c,y2:l,height:f-l}}Vt.getCircumscribedAlignedRectangle=rc;function vi(n,t,e,r,i,o,a){return n<r+o&&n+e>r&&t<i+a&&t+e>i}Vt.squareCollidesWithQuad=vi;function mi(n,t,e,r,i,o,a,s){return n<i+a&&n+e>i&&t<o+s&&t+r>o}Vt.rectangleCollidesWithQuad=mi;function fv(n,t,e,r,i,o){var a=e+i/2,s=r+o/2,c=t<s,l=n<a;return c?l?lv:cv:l?hv:dv}function pv(n,t){for(var e=[0,0];e.length;){var r=e.pop(),i=e.pop(),o=4*i+zt,a=4*i+2*zt,s=4*i+3*zt,c=4*i+4*zt,l=t[i+Rt],f=t[i+Ft],p=t[i+It],g=t[i+jt],v=p/2,m=g/2;t[o+Rt]=l,t[o+Ft]=f,t[o+It]=v,t[o+jt]=m,t[a+Rt]=l+v,t[a+Ft]=f,t[a+It]=v,t[a+jt]=m,t[s+Rt]=l,t[s+Ft]=f+m,t[s+It]=v,t[s+jt]=m,t[c+Rt]=l+v,t[c+Ft]=f+m,t[c+It]=v,t[c+jt]=m,r<n-1&&(e.push(c,r+1),e.push(s,r+1),e.push(a,r+1),e.push(o,r+1))}}function gv(n,t,e,r,i,o,a){for(var s=i-a,c=o-a,l=a*2,f=0,p=0;;){if(f>=n){e[p]=e[p]||[],e[p].push(r);return}var g=4*p+zt,v=4*p+2*zt,m=4*p+3*zt,E=4*p+4*zt,S=vi(s,c,l,t[g+Rt],t[g+Ft],t[g+It],t[g+jt]),C=vi(s,c,l,t[v+Rt],t[v+Ft],t[v+It],t[v+jt]),L=vi(s,c,l,t[m+Rt],t[m+Ft],t[m+It],t[m+jt]),O=vi(s,c,l,t[E+Rt],t[E+Ft],t[E+It],t[E+jt]),x=[S,C,L,O].reduce(function(A,R){return R?A+1:A},0);if(x===0&&f===0){e[yn].push(r),!du&&e[yn].length>=5&&(du=!0,console.warn("sigma/quadtree.insertNode: At least 5 nodes are outside the global quadtree zone. You might have a problem with the normalization function or the custom bounding box."));return}if(x===0)throw new Error("sigma/quadtree.insertNode: no collision (level: ".concat(f,", key: ").concat(r,", x: ").concat(i,", y: ").concat(o,", size: ").concat(a,")."));if(x===3)throw new Error("sigma/quadtree.insertNode: 3 impossible collisions (level: ".concat(f,", key: ").concat(r,", x: ").concat(i,", y: ").concat(o,", size: ").concat(a,")."));if(x>1){e[p]=e[p]||[],e[p].push(r);return}else f++;S&&(p=g),C&&(p=v),L&&(p=m),O&&(p=E)}}function vv(n,t,e,r,i,o,a){for(var s=[0,0],c=[],l;s.length;){var f=s.pop(),p=s.pop();if(l=e[p],l&&(0,uv.default)(c,l),!(f>=n)){var g=4*p+zt,v=4*p+2*zt,m=4*p+3*zt,E=4*p+4*zt,S=mi(r,i,o,a,t[g+Rt],t[g+Ft],t[g+It],t[g+jt]),C=mi(r,i,o,a,t[v+Rt],t[v+Ft],t[v+It],t[v+jt]),L=mi(r,i,o,a,t[m+Rt],t[m+Ft],t[m+It],t[m+jt]),O=mi(r,i,o,a,t[E+Rt],t[E+Ft],t[E+It],t[E+jt]);S&&s.push(g,f+1),C&&s.push(v,f+1),L&&s.push(m,f+1),O&&s.push(E,f+1)}}return c}var mv=function(){function n(t){var e;t===void 0&&(t={}),this.containers=(e={},e[yn]=[],e),this.cache=null,this.lastRectangle=null;var r=Math.pow(4,pi);this.data=new Float32Array(zt*((4*r-1)/3)),t.boundaries?this.resize(t.boundaries):this.resize({x:0,y:0,width:1,height:1})}return n.prototype.add=function(t,e,r,i){return gv(pi,this.data,this.containers,t,e,r,i),this},n.prototype.resize=function(t){this.clear(),this.data[Rt]=t.x,this.data[Ft]=t.y,this.data[It]=t.width,this.data[jt]=t.height,pv(pi,this.data)},n.prototype.clear=function(){var t;return this.containers=(t={},t[yn]=[],t),this},n.prototype.point=function(t,e){var r=this.containers[yn],i=0,o=0;do{this.containers[i]&&r.push.apply(r,hu([],cu(this.containers[i]),!1));var a=fv(t,e,this.data[i+Rt],this.data[i+Ft],this.data[i+It],this.data[i+jt]);i=4*i+a*zt,o++}while(o<=pi);return r},n.prototype.rectangle=function(t,e,r,i,o){var a,s=this.lastRectangle;return s&&t===s.x1&&r===s.x2&&e===s.y1&&i===s.y2&&o===s.height?this.cache:(this.lastRectangle={x1:t,y1:e,x2:r,y2:i,height:o},tc(this.lastRectangle)||(this.lastRectangle=rc(this.lastRectangle)),this.cache=vv(pi,this.data,this.containers,t,e,Math.abs(t-r)||Math.abs(e-i),o),(a=this.cache).push.apply(a,hu([],cu(this.containers[yn]),!1)),this.cache)},n}();Vt.default=mv;var Ln={};Object.defineProperty(Ln,"__esModule",{value:!0});Ln.edgeLabelsToDisplayFromNodes=Ln.LabelGrid=void 0;var fu=function(){function n(t,e){this.key=t,this.size=e}return n.compare=function(t,e){return t.size>e.size?-1:t.size<e.size||t.key>e.key?1:-1},n}(),yv=function(){function n(){this.width=0,this.height=0,this.cellSize=0,this.columns=0,this.rows=0,this.cells={}}return n.prototype.resizeAndClear=function(t,e){this.width=t.width,this.height=t.height,this.cellSize=e,this.columns=Math.ceil(t.width/e),this.rows=Math.ceil(t.height/e),this.cells={}},n.prototype.getIndex=function(t){var e=Math.floor(t.x/this.cellSize),r=Math.floor(t.y/this.cellSize);return r*this.columns+e},n.prototype.add=function(t,e,r){var i=new fu(t,e),o=this.getIndex(r),a=this.cells[o];a||(a=[],this.cells[o]=a),a.push(i)},n.prototype.organize=function(){for(var t in this.cells){var e=this.cells[t];e.sort(fu.compare)}},n.prototype.getLabelsToDisplay=function(t,e){var r=this.cellSize*this.cellSize,i=r/t/t,o=i*e/r,a=Math.ceil(o),s=[];for(var c in this.cells)for(var l=this.cells[c],f=0;f<Math.min(a,l.length);f++)s.push(l[f].key);return s},n}();Ln.LabelGrid=yv;function bv(n){var t=n.graph,e=n.hoveredNode,r=n.highlightedNodes,i=n.displayedNodeLabels,o=[];return t.forEachEdge(function(a,s,c,l){(c===e||l===e||r.has(c)||r.has(l)||i.has(c)&&i.has(l))&&o.push(a)}),o}Ln.edgeLabelsToDisplayFromNodes=bv;var Tn={},qa={},wv=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(qa,"__esModule",{value:!0});var _v=wv(Oo);function Ev(n,t,e){var r=e.labelSize,i=e.labelFont,o=e.labelWeight;n.font="".concat(o," ").concat(r,"px ").concat(i),n.fillStyle="#FFF",n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=8,n.shadowColor="#000";var a=2;if(typeof t.label=="string"){var s=n.measureText(t.label).width,c=Math.round(s+5),l=Math.round(r+2*a),f=Math.max(t.size,r/2)+a,p=Math.asin(l/2/f),g=Math.sqrt(Math.abs(Math.pow(f,2)-Math.pow(l/2,2)));n.beginPath(),n.moveTo(t.x+g,t.y+l/2),n.lineTo(t.x+f+c,t.y+l/2),n.lineTo(t.x+f+c,t.y-l/2),n.lineTo(t.x+g,t.y-l/2),n.arc(t.x,t.y,f,p,-p),n.closePath(),n.fill()}else n.beginPath(),n.arc(t.x,t.y,t.size+a,0,Math.PI*2),n.closePath(),n.fill();n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,(0,_v.default)(n,t,e)}qa.default=Ev;var Ha={};Object.defineProperty(Ha,"__esModule",{value:!0});function Av(n,t,e,r,i){var o=i.edgeLabelSize,a=i.edgeLabelFont,s=i.edgeLabelWeight,c=i.edgeLabelColor.attribute?t[i.edgeLabelColor.attribute]||i.edgeLabelColor.color||"#000":i.edgeLabelColor.color,l=t.label;if(!!l){n.fillStyle=c,n.font="".concat(s," ").concat(o,"px ").concat(a);var f=e.size,p=r.size,g=e.x,v=e.y,m=r.x,E=r.y,S=(g+m)/2,C=(v+E)/2,L=m-g,O=E-v,x=Math.sqrt(L*L+O*O);if(!(x<f+p)){g+=L*f/x,v+=O*f/x,m-=L*p/x,E-=O*p/x,S=(g+m)/2,C=(v+E)/2,L=m-g,O=E-v,x=Math.sqrt(L*L+O*O);var A=n.measureText(l).width;if(A>x){var R="\u2026";for(l=l+R,A=n.measureText(l).width;A>x&&l.length>1;)l=l.slice(0,-2)+R,A=n.measureText(l).width;if(l.length<4)return}var b;L>0?O>0?b=Math.acos(L/x):b=Math.asin(O/x):O>0?b=Math.acos(L/x)+Math.PI:b=Math.asin(L/x)+Math.PI/2,n.save(),n.translate(S,C),n.rotate(b),n.fillText(l,-A/2,t.size/2+o),n.restore()}}}Ha.default=Av;var Va={},nc={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`attribute vec4 a_color;
attribute vec2 a_normal;
attribute vec2 a_position;

uniform mat3 u_matrix;
uniform float u_sqrtZoomRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;

const float minThickness = 1.7;
const float bias = 255.0 / 254.0;

void main() {
  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // We require edges to be at least \`minThickness\` pixels thick *on screen*
  // (so we need to compensate the SQRT zoom ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sqrtZoomRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio;

  // Finally, we adapt the edge thickness to the "SQRT rule" in sigma (so that
  // items are not too big when zoomed in, and not too small when zoomed out).
  // The exact computation should be \`adapted = value * zoom / sqrt(zoom)\`, but
  // it's simpler like this:
  float adaptedWebGLThickness = webGLThickness * u_sqrtZoomRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(a_position + unitNormal * adaptedWebGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasint effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_sqrtZoomRatio;

  v_normal = unitNormal;
  v_color = a_color;
  v_color.a *= bias;
}
`;nc.exports=t})();var Ya={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;

const float feather = 0.001;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
}
`;Ya.exports=t})();var Lr={},Sv=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Lr,"__esModule",{value:!0});Lr.createEdgeCompoundProgram=Lr.AbstractEdgeProgram=void 0;var Cv=ki,Lv=function(n){Sv(t,n);function t(e,r,i,o,a){return n.call(this,e,r,i,o,a)||this}return t}(Cv.AbstractProgram);Lr.AbstractEdgeProgram=Lv;function Tv(n){return function(){function t(e,r){this.programs=n.map(function(i){return new i(e,r)})}return t.prototype.bufferData=function(){this.programs.forEach(function(e){return e.bufferData()})},t.prototype.allocate=function(e){this.programs.forEach(function(r){return r.allocate(e)})},t.prototype.bind=function(){},t.prototype.computeIndices=function(){this.programs.forEach(function(e){return e.computeIndices()})},t.prototype.render=function(e){this.programs.forEach(function(r){r.bind(),r.bufferData(),r.render(e)})},t.prototype.process=function(e,r,i,o,a){this.programs.forEach(function(s){return s.process(e,r,i,o,a)})},t}()}Lr.createEdgeCompoundProgram=Tv;var Ov=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ic=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Va,"__esModule",{value:!0});var pu=we,kv=ic(nc.exports),xv=ic(Ya.exports),Dv=Lr,ba=4,Jr=5,gu=ba*Jr,Pv=function(n){Ov(t,n);function t(e){var r=n.call(this,e,kv.default,xv.default,ba,Jr)||this,i=e.createBuffer();if(i===null)throw new Error("EdgeProgram: error while creating indicesBuffer");r.indicesBuffer=i,r.positionLocation=e.getAttribLocation(r.program,"a_position"),r.colorLocation=e.getAttribLocation(r.program,"a_color"),r.normalLocation=e.getAttribLocation(r.program,"a_normal");var o=e.getUniformLocation(r.program,"u_matrix");if(o===null)throw new Error("EdgeProgram: error while getting matrixLocation");r.matrixLocation=o;var a=e.getUniformLocation(r.program,"u_correctionRatio");if(a===null)throw new Error("EdgeProgram: error while getting correctionRatioLocation");r.correctionRatioLocation=a;var s=e.getUniformLocation(r.program,"u_sqrtZoomRatio");if(s===null)throw new Error("EdgeProgram: error while getting sqrtZoomRatioLocation");return r.sqrtZoomRatioLocation=s,r.canUse32BitsIndices=(0,pu.canUse32BitsIndices)(e),r.IndicesArray=r.canUse32BitsIndices?Uint32Array:Uint16Array,r.indicesArray=new r.IndicesArray,r.indicesType=r.canUse32BitsIndices?e.UNSIGNED_INT:e.UNSIGNED_SHORT,r.bind(),r}return t.prototype.bind=function(){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.normalLocation),e.enableVertexAttribArray(this.colorLocation),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,Jr*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(this.normalLocation,2,e.FLOAT,!1,Jr*Float32Array.BYTES_PER_ELEMENT,8),e.vertexAttribPointer(this.colorLocation,4,e.UNSIGNED_BYTE,!0,Jr*Float32Array.BYTES_PER_ELEMENT,16)},t.prototype.computeIndices=function(){for(var e=this.array.length/Jr,r=e+e/2,i=new this.IndicesArray(r),o=0,a=0;o<e;o+=4)i[a++]=o,i[a++]=o+1,i[a++]=o+2,i[a++]=o+2,i[a++]=o+1,i[a++]=o+3;this.indicesArray=i},t.prototype.bufferData=function(){n.prototype.bufferData.call(this);var e=this.gl;e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indicesArray,e.STATIC_DRAW)},t.prototype.process=function(e,r,i,o,a){if(o){for(var s=a*gu,c=s+gu;s<c;s++)this.array[s]=0;return}var l=i.size||1,f=e.x,p=e.y,g=r.x,v=r.y,m=(0,pu.floatColor)(i.color),E=g-f,S=v-p,C=E*E+S*S,L=0,O=0;C&&(C=1/Math.sqrt(C),L=-S*C*l,O=E*C*l);var x=ba*Jr*a,A=this.array;A[x++]=f,A[x++]=p,A[x++]=L,A[x++]=O,A[x++]=m,A[x++]=f,A[x++]=p,A[x++]=-L,A[x++]=-O,A[x++]=m,A[x++]=g,A[x++]=v,A[x++]=L,A[x++]=O,A[x++]=m,A[x++]=g,A[x++]=v,A[x++]=-L,A[x++]=-O,A[x]=m},t.prototype.render=function(e){if(!this.hasNothingToRender()){var r=this.gl,i=this.program;r.useProgram(i),r.uniformMatrix3fv(this.matrixLocation,!1,e.matrix),r.uniform1f(this.sqrtZoomRatioLocation,Math.sqrt(e.ratio)),r.uniform1f(this.correctionRatioLocation,e.correctionRatio),r.drawElements(r.TRIANGLES,this.indicesArray.length,this.indicesType,0)}},t}(Dv.AbstractEdgeProgram);Va.default=Pv;var Ka={},Za={},oc={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec4 a_color;
attribute vec3 a_barycentric;

uniform mat3 u_matrix;
uniform float u_sqrtZoomRatio;
uniform float u_correctionRatio;

varying vec4 v_color;

const float minThickness = 1.7;
const float bias = 255.0 / 254.0;
const float arrowHeadWidthLengthRatio = 0.66;
const float arrowHeadLengthThicknessRatio = 2.5;

void main() {
  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength, minThickness * u_sqrtZoomRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float adaptedWebGLThickness = webGLThickness * u_sqrtZoomRatio;
  float adaptedWebGLNodeRadius = a_radius * 2.0 * u_correctionRatio * u_sqrtZoomRatio;
  float adaptedWebGLArrowHeadLength = adaptedWebGLThickness * 2.0 * arrowHeadLengthThicknessRatio;
  float adaptedWebGLArrowHeadHalfWidth = adaptedWebGLArrowHeadLength * arrowHeadWidthLengthRatio / 2.0;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (adaptedWebGLNodeRadius * unitNormal.y)
    + db * ((adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength) * unitNormal.y + adaptedWebGLArrowHeadHalfWidth * unitNormal.x)
    + dc * ((adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength) * unitNormal.y - adaptedWebGLArrowHeadHalfWidth * unitNormal.x),

      da * (-adaptedWebGLNodeRadius * unitNormal.x)
    + db * (-(adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength) * unitNormal.x + adaptedWebGLArrowHeadHalfWidth * unitNormal.y)
    + dc * (-(adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength) * unitNormal.x - adaptedWebGLArrowHeadHalfWidth * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  // Extract the color:
  v_color = a_color;
  v_color.a *= bias;
}
`;oc.exports=t})();var ac={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`;ac.exports=t})();var Rv=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),sc=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Za,"__esModule",{value:!0});var Fv=we,Iv=sc(oc.exports),jv=sc(ac.exports),Gv=Lr,wa=3,Sr=9,vu=wa*Sr,$v=function(n){Rv(t,n);function t(e){var r=n.call(this,e,Iv.default,jv.default,wa,Sr)||this;r.positionLocation=e.getAttribLocation(r.program,"a_position"),r.colorLocation=e.getAttribLocation(r.program,"a_color"),r.normalLocation=e.getAttribLocation(r.program,"a_normal"),r.radiusLocation=e.getAttribLocation(r.program,"a_radius"),r.barycentricLocation=e.getAttribLocation(r.program,"a_barycentric");var i=e.getUniformLocation(r.program,"u_matrix");if(i===null)throw new Error("EdgeArrowHeadProgram: error while getting matrixLocation");r.matrixLocation=i;var o=e.getUniformLocation(r.program,"u_sqrtZoomRatio");if(o===null)throw new Error("EdgeArrowHeadProgram: error while getting sqrtZoomRatioLocation");r.sqrtZoomRatioLocation=o;var a=e.getUniformLocation(r.program,"u_correctionRatio");if(a===null)throw new Error("EdgeArrowHeadProgram: error while getting correctionRatioLocation");return r.correctionRatioLocation=a,r.bind(),r}return t.prototype.bind=function(){var e=this.gl;e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.normalLocation),e.enableVertexAttribArray(this.radiusLocation),e.enableVertexAttribArray(this.colorLocation),e.enableVertexAttribArray(this.barycentricLocation),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,Sr*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(this.normalLocation,2,e.FLOAT,!1,Sr*Float32Array.BYTES_PER_ELEMENT,8),e.vertexAttribPointer(this.radiusLocation,1,e.FLOAT,!1,Sr*Float32Array.BYTES_PER_ELEMENT,16),e.vertexAttribPointer(this.colorLocation,4,e.UNSIGNED_BYTE,!0,Sr*Float32Array.BYTES_PER_ELEMENT,20),e.vertexAttribPointer(this.barycentricLocation,3,e.FLOAT,!1,Sr*Float32Array.BYTES_PER_ELEMENT,24)},t.prototype.computeIndices=function(){},t.prototype.process=function(e,r,i,o,a){if(o){for(var s=a*vu,c=s+vu;s<c;s++)this.array[s]=0;return}var l=i.size||1,f=r.size||1,p=e.x,g=e.y,v=r.x,m=r.y,E=(0,Fv.floatColor)(i.color),S=v-p,C=m-g,L=S*S+C*C,O=0,x=0;L&&(L=1/Math.sqrt(L),O=-C*L*l,x=S*L*l);var A=wa*Sr*a,R=this.array;R[A++]=v,R[A++]=m,R[A++]=-O,R[A++]=-x,R[A++]=f,R[A++]=E,R[A++]=1,R[A++]=0,R[A++]=0,R[A++]=v,R[A++]=m,R[A++]=-O,R[A++]=-x,R[A++]=f,R[A++]=E,R[A++]=0,R[A++]=1,R[A++]=0,R[A++]=v,R[A++]=m,R[A++]=-O,R[A++]=-x,R[A++]=f,R[A++]=E,R[A++]=0,R[A++]=0,R[A]=1},t.prototype.render=function(e){if(!this.hasNothingToRender()){var r=this.gl,i=this.program;r.useProgram(i),r.uniformMatrix3fv(this.matrixLocation,!1,e.matrix),r.uniform1f(this.sqrtZoomRatioLocation,Math.sqrt(e.ratio)),r.uniform1f(this.correctionRatioLocation,e.correctionRatio),r.drawArrays(r.TRIANGLES,0,this.array.length/Sr)}},t}(Gv.AbstractEdgeProgram);Za.default=$v;var Xa={},uc={exports:{}};(()=>{var n={d:(r,i)=>{for(var o in i)n.o(i,o)&&!n.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(r,i)=>Object.prototype.hasOwnProperty.call(r,i),r:r=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};n.r(t),n.d(t,{default:()=>e});const e=`attribute vec4 a_color;
attribute vec2 a_normal;
attribute vec2 a_position;
attribute float a_radius;

uniform mat3 u_matrix;
uniform float u_sqrtZoomRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;

const float minThickness = 1.7;
const float bias = 255.0 / 254.0;
const float arrowHeadLengthThicknessRatio = 2.5;

void main() {
  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sqrtZoomRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float adaptedWebGLThickness = webGLThickness * u_sqrtZoomRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(a_radius);
  float adaptedWebGLNodeRadius = direction * a_radius * 2.0 * u_correctionRatio * u_sqrtZoomRatio;
  float adaptedWebGLArrowHeadLength = adaptedWebGLThickness * 2.0 * arrowHeadLengthThicknessRatio;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(a_position + unitNormal * adaptedWebGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_sqrtZoomRatio;

  v_normal = unitNormal;
  v_color = a_color;
  v_color.a *= bias;
}
`;uc.exports=t})();var Uv=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),lc=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Xa,"__esModule",{value:!0});var Nv=Lr,mu=we,Mv=lc(uc.exports),zv=lc(Ya.exports),_a=4,Gr=6,yu=_a*Gr,Bv=function(n){Uv(t,n);function t(e){var r=n.call(this,e,Mv.default,zv.default,_a,Gr)||this,i=e.createBuffer();if(i===null)throw new Error("EdgeClampedProgram: error while getting resolutionLocation");r.indicesBuffer=i,r.positionLocation=e.getAttribLocation(r.program,"a_position"),r.colorLocation=e.getAttribLocation(r.program,"a_color"),r.normalLocation=e.getAttribLocation(r.program,"a_normal"),r.radiusLocation=e.getAttribLocation(r.program,"a_radius");var o=e.getUniformLocation(r.program,"u_matrix");if(o===null)throw new Error("EdgeClampedProgram: error while getting matrixLocation");r.matrixLocation=o;var a=e.getUniformLocation(r.program,"u_sqrtZoomRatio");if(a===null)throw new Error("EdgeClampedProgram: error while getting cameraRatioLocation");r.sqrtZoomRatioLocation=a;var s=e.getUniformLocation(r.program,"u_correctionRatio");if(s===null)throw new Error("EdgeClampedProgram: error while getting viewportRatioLocation");return r.correctionRatioLocation=s,r.canUse32BitsIndices=(0,mu.canUse32BitsIndices)(e),r.IndicesArray=r.canUse32BitsIndices?Uint32Array:Uint16Array,r.indicesArray=new r.IndicesArray,r.indicesType=r.canUse32BitsIndices?e.UNSIGNED_INT:e.UNSIGNED_SHORT,r.bind(),r}return t.prototype.bind=function(){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.normalLocation),e.enableVertexAttribArray(this.colorLocation),e.enableVertexAttribArray(this.radiusLocation),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,Gr*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(this.normalLocation,2,e.FLOAT,!1,Gr*Float32Array.BYTES_PER_ELEMENT,8),e.vertexAttribPointer(this.colorLocation,4,e.UNSIGNED_BYTE,!0,Gr*Float32Array.BYTES_PER_ELEMENT,16),e.vertexAttribPointer(this.radiusLocation,1,e.FLOAT,!1,Gr*Float32Array.BYTES_PER_ELEMENT,20)},t.prototype.process=function(e,r,i,o,a){if(o){for(var s=a*yu,c=s+yu;s<c;s++)this.array[s]=0;return}var l=i.size||1,f=e.x,p=e.y,g=r.x,v=r.y,m=r.size||1,E=(0,mu.floatColor)(i.color),S=g-f,C=v-p,L=S*S+C*C,O=0,x=0;L&&(L=1/Math.sqrt(L),O=-C*L*l,x=S*L*l);var A=_a*Gr*a,R=this.array;R[A++]=f,R[A++]=p,R[A++]=O,R[A++]=x,R[A++]=E,R[A++]=0,R[A++]=f,R[A++]=p,R[A++]=-O,R[A++]=-x,R[A++]=E,R[A++]=0,R[A++]=g,R[A++]=v,R[A++]=O,R[A++]=x,R[A++]=E,R[A++]=m,R[A++]=g,R[A++]=v,R[A++]=-O,R[A++]=-x,R[A++]=E,R[A]=-m},t.prototype.computeIndices=function(){for(var e=this.array.length/Gr,r=e+e/2,i=new this.IndicesArray(r),o=0,a=0;o<e;o+=4)i[a++]=o,i[a++]=o+1,i[a++]=o+2,i[a++]=o+2,i[a++]=o+1,i[a++]=o+3;this.indicesArray=i},t.prototype.bufferData=function(){n.prototype.bufferData.call(this);var e=this.gl;e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indicesArray,e.STATIC_DRAW)},t.prototype.render=function(e){if(!this.hasNothingToRender()){var r=this.gl,i=this.program;r.useProgram(i),r.uniformMatrix3fv(this.matrixLocation,!1,e.matrix),r.uniform1f(this.sqrtZoomRatioLocation,Math.sqrt(e.ratio)),r.uniform1f(this.correctionRatioLocation,e.correctionRatio),r.drawElements(r.TRIANGLES,this.indicesArray.length,this.indicesType,0)}},t}(Nv.AbstractEdgeProgram);Xa.default=Bv;var cc=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ka,"__esModule",{value:!0});var Wv=Lr,qv=cc(Za),Hv=cc(Xa),Vv=(0,Wv.createEdgeCompoundProgram)([Hv.default,qv.default]);Ka.default=Vv;var Gn=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.DEFAULT_SETTINGS=Tn.validateSettings=void 0;var Yv=Gn(Oo),Kv=Gn(qa),Zv=Gn(Ha),Xv=Gn(Na),Qv=Gn(Va),Jv=Gn(Ka);function em(n){if(typeof n.labelDensity!="number"||n.labelDensity<0)throw new Error("Settings: invalid `labelDensity`. Expecting a positive number.");var t=n.minCameraRatio,e=n.maxCameraRatio;if(typeof t=="number"&&typeof e=="number"&&e<t)throw new Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}Tn.validateSettings=em;Tn.DEFAULT_SETTINGS={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeClickEvents:!1,enableEdgeWheelEvents:!1,enableEdgeHoverEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,labelRenderer:Yv.default,hoverRenderer:Kv.default,edgeLabelRenderer:Zv.default,allowInvalidContainer:!1,nodeProgramClasses:{circle:Xv.default},edgeProgramClasses:{arrow:Jv.default,line:Qv.default}};var Qa={},tm=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),rm=Y&&Y.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e),Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[e]}})}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),nm=Y&&Y.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),im=Y&&Y.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&rm(t,n,e);return nm(t,n),t},bu=Y&&Y.__read||function(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r=e.call(n),i,o=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(a)throw a.error}}return o};Object.defineProperty(Qa,"__esModule",{value:!0});var Ar=im(Ot),om=200,wu=3,am=200,sm=function(n){tm(t,n);function t(e,r){var i=n.call(this,e,r)||this;return i.enabled=!0,i.isMoving=!1,i.touchMode=0,i.handleStart=i.handleStart.bind(i),i.handleLeave=i.handleLeave.bind(i),i.handleMove=i.handleMove.bind(i),e.addEventListener("touchstart",i.handleStart,!1),e.addEventListener("touchend",i.handleLeave,!1),e.addEventListener("touchcancel",i.handleLeave,!1),e.addEventListener("touchmove",i.handleMove,!1),i}return t.prototype.kill=function(){var e=this.container;e.removeEventListener("touchstart",this.handleStart),e.removeEventListener("touchend",this.handleLeave),e.removeEventListener("touchcancel",this.handleLeave),e.removeEventListener("touchmove",this.handleMove)},t.prototype.getDimensions=function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}},t.prototype.dispatchRelatedMouseEvent=function(e,r,i,o){var a=i||(0,Ar.getPosition)(r.touches[0],this.container),s=new MouseEvent(e,{clientX:a.x,clientY:a.y,altKey:r.altKey,ctrlKey:r.ctrlKey});s.isFakeSigmaMouseEvent=!0,(o||this.container).dispatchEvent(s)},t.prototype.handleStart=function(e){var r=this;if(!!this.enabled){e.preventDefault(),e.touches.length===1&&this.dispatchRelatedMouseEvent("mousedown",e);var i=(0,Ar.getTouchesArray)(e.touches);if(this.isMoving=!0,this.touchMode=i.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=i.map(function(g){return(0,Ar.getPosition)(g,r.container)}),this.lastTouchesPositions=this.startTouchesPositions,this.touchMode===2){var o=bu(this.startTouchesPositions,2),a=o[0],s=a.x,c=a.y,l=o[1],f=l.x,p=l.y;this.startTouchesAngle=Math.atan2(p-c,f-s),this.startTouchesDistance=Math.sqrt(Math.pow(f-s,2)+Math.pow(p-c,2))}this.emit("touchdown",(0,Ar.getTouchCoords)(e,this.container))}},t.prototype.handleLeave=function(e){if(!!this.enabled){switch(e.preventDefault(),e.touches.length===0&&this.lastTouchesPositions&&this.lastTouchesPositions.length&&(this.dispatchRelatedMouseEvent("mouseup",e,this.lastTouchesPositions[0],document),this.dispatchRelatedMouseEvent("click",e,this.lastTouchesPositions[0])),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(e.touches.length===1){this.handleStart(e),e.preventDefault();break}case 1:if(this.isMoving){var r=this.renderer.getCamera(),i=r.getState(),o=r.getPreviousState()||{x:0,y:0};r.animate({x:i.x+wu*(i.x-o.x),y:i.y+wu*(i.y-o.y)},{duration:am,easing:"quadraticOut"})}this.isMoving=!1,this.touchMode=0;break}this.emit("touchup",(0,Ar.getTouchCoords)(e,this.container))}},t.prototype.handleMove=function(e){var r,i=this;if(!!this.enabled){e.preventDefault(),e.touches.length===1&&this.dispatchRelatedMouseEvent("mousemove",e);var o=this.renderer.getCamera(),a=this.startCameraState,s=(0,Ar.getTouchesArray)(e.touches),c=s.map(function(Te){return(0,Ar.getPosition)(Te,i.container)});switch(this.lastTouchesPositions=c,this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){i.isMoving=!1},om),this.touchMode){case 1:{var l=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),f=l.x,p=l.y,g=this.renderer.viewportToFramedGraph(c[0]),v=g.x,m=g.y;o.setState({x:a.x+f-v,y:a.y+p-m});break}case 2:{var E={},S=c[0],C=S.x,L=S.y,O=c[1],x=O.x,A=O.y,R=Math.atan2(A-L,x-C)-this.startTouchesAngle,b=Math.hypot(A-L,x-C)/this.startTouchesDistance,_=o.getBoundedRatio(a.ratio/b);E.ratio=_,E.angle=a.angle+R;var w=this.getDimensions(),$=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:a}),M=Math.min(w.width,w.height),Q=M/w.width,pe=M/w.height,J=_/M,v=C-M/2/Q,m=L-M/2/pe;r=bu([v*Math.cos(-E.angle)-m*Math.sin(-E.angle),m*Math.cos(-E.angle)+v*Math.sin(-E.angle)],2),v=r[0],m=r[1],E.x=$.x-v*J,E.y=$.y+m*J,o.setState(E);break}}this.emit("touchmove",(0,Ar.getTouchCoords)(e,this.container))}},t}(Ar.default);Qa.default=sm;var On={};Object.defineProperty(On,"__esModule",{value:!0});On.doEdgeCollideWithPoint=On.isPixelColored=void 0;function um(n,t,e){var r=new Uint8Array(4);return n.readPixels(t,n.drawingBufferHeight-e,1,1,n.RGBA,n.UNSIGNED_BYTE,r),r[3]>0}On.isPixelColored=um;function lm(n,t,e,r,i,o,a){if(n<e-a&&n<i-a||t<r-a&&t<o-a||n>e+a&&n>i+a||t>r+a&&t>o+a)return!1;var s=Math.abs((i-e)*(r-t)-(e-n)*(o-r))/Math.sqrt(Math.pow(i-e,2)+Math.pow(o-r,2));return s<a/2}On.doEdgeCollideWithPoint=lm;var cm=Y&&Y.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ue=Y&&Y.__assign||function(){return Ue=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ue.apply(this,arguments)},hm=Y&&Y.__values||function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Do=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(za,"__esModule",{value:!0});var _u=Do(ko),dm=Do(xo),Eu=Do(Vt),fm=jn,at=we,Au=Ln,ao=Tn,pm=Do(Qa),so=Pt,Su=On;function gm(n,t,e){if(!e.hasOwnProperty("x")||!e.hasOwnProperty("y"))throw new Error('Sigma: could not find a valid position (x, y) for node "'.concat(t,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return e.color||(e.color=n.defaultNodeColor),!e.label&&e.label!==""&&(e.label=null),e.label!==void 0&&e.label!==null?e.label=""+e.label:e.label=null,e.size||(e.size=2),e.hasOwnProperty("hidden")||(e.hidden=!1),e.hasOwnProperty("highlighted")||(e.highlighted=!1),e.hasOwnProperty("forceLabel")||(e.forceLabel=!1),(!e.type||e.type==="")&&(e.type=n.defaultNodeType),e.zIndex||(e.zIndex=0),e}function vm(n,t,e){return e.color||(e.color=n.defaultEdgeColor),e.label||(e.label=""),e.size||(e.size=.5),e.hasOwnProperty("hidden")||(e.hidden=!1),e.hasOwnProperty("forceLabel")||(e.forceLabel=!1),(!e.type||e.type==="")&&(e.type=n.defaultEdgeType),e.zIndex||(e.zIndex=0),e}var mm=function(n){cm(t,n);function t(e,r,i){i===void 0&&(i={});var o=n.call(this)||this;if(o.elements={},o.canvasContexts={},o.webGLContexts={},o.activeListeners={},o.quadtree=new Eu.default,o.labelGrid=new Au.LabelGrid,o.nodeDataCache={},o.edgeDataCache={},o.nodesWithForcedLabels=[],o.edgesWithForcedLabels=[],o.nodeExtent={x:[0,1],y:[0,1]},o.matrix=(0,so.identity)(),o.invMatrix=(0,so.identity)(),o.correctionRatio=1,o.customBBox=null,o.normalizationFunction=(0,at.createNormalizationFunction)({x:[0,1],y:[0,1]}),o.cameraSizeRatio=1,o.width=0,o.height=0,o.pixelRatio=(0,at.getPixelRatio)(),o.displayedLabels=new Set,o.highlightedNodes=new Set,o.hoveredNode=null,o.hoveredEdge=null,o.renderFrame=null,o.renderHighlightedNodesFrame=null,o.needToProcess=!1,o.needToSoftProcess=!1,o.checkEdgesEventsFrame=null,o.nodePrograms={},o.hoverNodePrograms={},o.edgePrograms={},o.settings=(0,at.assign)({},ao.DEFAULT_SETTINGS,i),(0,ao.validateSettings)(o.settings),(0,at.validateGraph)(e),!(r instanceof HTMLElement))throw new Error("Sigma: container should be an html element.");o.graph=e,o.container=r,o.createWebGLContext("edges",{preserveDrawingBuffer:!0}),o.createCanvasContext("edgeLabels"),o.createWebGLContext("nodes"),o.createCanvasContext("labels"),o.createCanvasContext("hovers"),o.createWebGLContext("hoverNodes"),o.createCanvasContext("mouse");for(var a in o.webGLContexts){var s=o.webGLContexts[a];s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.enable(s.BLEND)}for(var c in o.settings.nodeProgramClasses){var l=o.settings.nodeProgramClasses[c];o.nodePrograms[c]=new l(o.webGLContexts.nodes,o),o.hoverNodePrograms[c]=new l(o.webGLContexts.hoverNodes,o)}for(var c in o.settings.edgeProgramClasses){var f=o.settings.edgeProgramClasses[c];o.edgePrograms[c]=new f(o.webGLContexts.edges,o)}return o.resize(),o.camera=new _u.default,o.bindCameraHandlers(),o.mouseCaptor=new dm.default(o.elements.mouse,o),o.touchCaptor=new pm.default(o.elements.mouse,o),o.bindEventHandlers(),o.bindGraphHandlers(),o.handleSettingsUpdate(),o.process(),o.render(),o}return t.prototype.createCanvas=function(e){var r=(0,at.createElement)("canvas",{position:"absolute"},{class:"sigma-".concat(e)});return this.elements[e]=r,this.container.appendChild(r),r},t.prototype.createCanvasContext=function(e){var r=this.createCanvas(e),i={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[e]=r.getContext("2d",i),this},t.prototype.createWebGLContext=function(e,r){var i=this.createCanvas(e),o=Ue({preserveDrawingBuffer:!1,antialias:!1},r||{}),a;return a=i.getContext("webgl2",o),a||(a=i.getContext("webgl",o)),a||(a=i.getContext("experimental-webgl",o)),this.webGLContexts[e]=a,this},t.prototype.bindCameraHandlers=function(){var e=this;return this.activeListeners.camera=function(){e._scheduleRefresh()},this.camera.on("updated",this.activeListeners.camera),this},t.prototype.mouseIsOnNode=function(e,r,i){var o=e.x,a=e.y,s=r.x,c=r.y;return o>s-i&&o<s+i&&a>c-i&&a<c+i&&Math.sqrt(Math.pow(o-s,2)+Math.pow(a-c,2))<i},t.prototype.getQuadNodes=function(e){var r=this.viewportToFramedGraph(e);return this.quadtree.point(r.x,1-r.y)},t.prototype.getNodeAtPosition=function(e){for(var r=e.x,i=e.y,o=this.getQuadNodes(e),a=1/0,s=null,c=0,l=o.length;c<l;c++){var f=o[c],p=this.nodeDataCache[f],g=this.framedGraphToViewport(p),v=this.scaleSize(p.size);if(!p.hidden&&this.mouseIsOnNode(e,g,v)){var m=Math.sqrt(Math.pow(r-g.x,2)+Math.pow(i-g.y,2));m<a&&(a=m,s=f)}}return s},t.prototype.bindEventHandlers=function(){var e=this;this.activeListeners.handleResize=function(){e.needToSoftProcess=!0,e._scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(i){var o={event:i,preventSigmaDefault:function(){i.preventSigmaDefault()}},a=e.getNodeAtPosition(i);if(a&&e.hoveredNode!==a&&!e.nodeDataCache[a].hidden){e.hoveredNode&&e.emit("leaveNode",Ue(Ue({},o),{node:e.hoveredNode})),e.hoveredNode=a,e.emit("enterNode",Ue(Ue({},o),{node:a})),e.scheduleHighlightedNodesRender();return}if(e.hoveredNode){var s=e.nodeDataCache[e.hoveredNode],c=e.framedGraphToViewport(s),l=e.scaleSize(s.size);if(!e.mouseIsOnNode(i,c,l)){var f=e.hoveredNode;e.hoveredNode=null,e.emit("leaveNode",Ue(Ue({},o),{node:f})),e.scheduleHighlightedNodesRender();return}}e.settings.enableEdgeHoverEvents===!0?e.checkEdgeHoverEvents(o):e.settings.enableEdgeHoverEvents==="debounce"&&(e.checkEdgesEventsFrame||(e.checkEdgesEventsFrame=(0,at.requestFrame)(function(){e.checkEdgeHoverEvents(o),e.checkEdgesEventsFrame=null})))};var r=function(i){return function(o){var a={event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}},s=o.original.isFakeSigmaMouseEvent,c=s?e.getNodeAtPosition(o):e.hoveredNode;if(c)return e.emit("".concat(i,"Node"),Ue(Ue({},a),{node:c}));if(i==="wheel"?e.settings.enableEdgeWheelEvents:e.settings.enableEdgeClickEvents){var l=e.getEdgeAtPoint(o.x,o.y);if(l)return e.emit("".concat(i,"Edge"),Ue(Ue({},a),{edge:l}))}return e.emit("".concat(i,"Stage"),a)}};return this.activeListeners.handleClick=r("click"),this.activeListeners.handleRightClick=r("rightClick"),this.activeListeners.handleDoubleClick=r("doubleClick"),this.activeListeners.handleWheel=r("wheel"),this.activeListeners.handleDown=r("down"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this},t.prototype.bindGraphHandlers=function(){var e=this,r=this.graph;return this.activeListeners.graphUpdate=function(){e.needToProcess=!0,e._scheduleRefresh()},this.activeListeners.softGraphUpdate=function(){e.needToSoftProcess=!0,e._scheduleRefresh()},this.activeListeners.dropNodeGraphUpdate=function(i){delete e.nodeDataCache[i.key],e.hoveredNode===i.key&&(e.hoveredNode=null),e.activeListeners.graphUpdate()},this.activeListeners.dropEdgeGraphUpdate=function(i){delete e.edgeDataCache[i.key],e.hoveredEdge===i.key&&(e.hoveredEdge=null),e.activeListeners.graphUpdate()},this.activeListeners.clearEdgesGraphUpdate=function(){e.edgeDataCache={},e.hoveredEdge=null,e.activeListeners.graphUpdate()},this.activeListeners.clearGraphUpdate=function(){e.nodeDataCache={},e.hoveredNode=null,e.activeListeners.clearEdgesGraphUpdate()},r.on("nodeAdded",this.activeListeners.graphUpdate),r.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),r.on("nodeAttributesUpdated",this.activeListeners.softGraphUpdate),r.on("eachNodeAttributesUpdated",this.activeListeners.graphUpdate),r.on("edgeAdded",this.activeListeners.graphUpdate),r.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),r.on("edgeAttributesUpdated",this.activeListeners.softGraphUpdate),r.on("eachEdgeAttributesUpdated",this.activeListeners.graphUpdate),r.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),r.on("cleared",this.activeListeners.clearGraphUpdate),this},t.prototype.checkEdgeHoverEvents=function(e){var r=this.hoveredNode?null:this.getEdgeAtPoint(e.event.x,e.event.y);return r!==this.hoveredEdge&&(this.hoveredEdge&&this.emit("leaveEdge",Ue(Ue({},e),{edge:this.hoveredEdge})),r&&this.emit("enterEdge",Ue(Ue({},e),{edge:r})),this.hoveredEdge=r),this},t.prototype.getEdgeAtPoint=function(e,r){var i,o,a=this,s=this,c=s.edgeDataCache,l=s.nodeDataCache;if(!(0,Su.isPixelColored)(this.webGLContexts.edges,e*this.pixelRatio,r*this.pixelRatio))return null;var f=this.viewportToGraph({x:e,y:r}),p=f.x,g=f.y,v=0;if(this.graph.someEdge(function(A,R,b,_,w,$){var M=w.x,Q=w.y,pe=$.x,J=$.y;if(c[A].hidden||l[b].hidden||l[_].hidden)return!1;if(M!==pe||Q!==J){var Te=Math.sqrt(Math.pow(pe-M,2)+Math.pow(J-Q,2)),Ve=a.graphToViewport({x:M,y:Q}),le=Ve.x,D=Ve.y,U=a.graphToViewport({x:pe,y:J}),B=U.x,I=U.y,P=Math.sqrt(Math.pow(B-le,2)+Math.pow(I-D,2));return v=Te/P,!0}}),!v)return null;var m=this.graph.filterEdges(function(A,R,b,_,w,$){if(c[A].hidden||l[b].hidden||l[_].hidden)return!1;if((0,Su.doEdgeCollideWithPoint)(p,g,w.x,w.y,$.x,$.y,c[A].size*v/a.cameraSizeRatio))return!0});if(m.length===0)return null;var E=m[m.length-1],S=-1/0;try{for(var C=hm(m),L=C.next();!L.done;L=C.next()){var O=L.value,x=this.graph.getEdgeAttribute(O,"zIndex");x>=S&&(E=O,S=x)}}catch(A){i={error:A}}finally{try{L&&!L.done&&(o=C.return)&&o.call(C)}finally{if(i)throw i.error}}return E},t.prototype.process=function(e){var r=this;e===void 0&&(e=!1);var i=this.graph,o=this.settings,a=this.getDimensions(),s=[1/0,-1/0],c=[1/0,-1/0];this.quadtree.clear(),this.labelGrid.resizeAndClear(a,o.labelGridCellSize),this.highlightedNodes=new Set,this.nodeExtent=(0,at.graphExtent)(i),this.nodesWithForcedLabels=[],this.edgesWithForcedLabels=[];var l=new _u.default,f=(0,at.matrixFromCamera)(l.getState(),this.getDimensions(),this.getGraphDimensions(),this.getSetting("stagePadding")||0);this.normalizationFunction=(0,at.createNormalizationFunction)(this.customBBox||this.nodeExtent);for(var p={},g=i.nodes(),v=0,m=g.length;v<m;v++){var E=g[v],S=Object.assign({},i.getNodeAttributes(E));o.nodeReducer&&(S=o.nodeReducer(E,S));var C=gm(this.settings,E,S);p[C.type]=(p[C.type]||0)+1,this.nodeDataCache[E]=C,this.normalizationFunction.applyTo(C),C.forceLabel&&this.nodesWithForcedLabels.push(E),this.settings.zIndex&&(C.zIndex<s[0]&&(s[0]=C.zIndex),C.zIndex>s[1]&&(s[1]=C.zIndex))}for(var L in this.nodePrograms){if(!this.nodePrograms.hasOwnProperty(L))throw new Error('Sigma: could not find a suitable program for node type "'.concat(L,'"!'));e||this.nodePrograms[L].allocate(p[L]||0),p[L]=0}this.settings.zIndex&&s[0]!==s[1]&&(g=(0,at.zIndexOrdering)(s,function(M){return r.nodeDataCache[M].zIndex},g));for(var v=0,m=g.length;v<m;v++){var E=g[v],C=this.nodeDataCache[E];this.quadtree.add(E,C.x,1-C.y,C.size/this.width),typeof C.label=="string"&&!C.hidden&&this.labelGrid.add(E,C.size,this.framedGraphToViewport(C,{matrix:f})),this.nodePrograms[C.type].process(C,C.hidden,p[C.type]++),C.highlighted&&!C.hidden&&this.highlightedNodes.add(E)}this.labelGrid.organize();for(var O={},x=i.edges(),v=0,m=x.length;v<m;v++){var A=x[v],S=Object.assign({},i.getEdgeAttributes(A));o.edgeReducer&&(S=o.edgeReducer(A,S));var C=vm(this.settings,A,S);O[C.type]=(O[C.type]||0)+1,this.edgeDataCache[A]=C,C.forceLabel&&!C.hidden&&this.edgesWithForcedLabels.push(A),this.settings.zIndex&&(C.zIndex<c[0]&&(c[0]=C.zIndex),C.zIndex>c[1]&&(c[1]=C.zIndex))}for(var L in this.edgePrograms){if(!this.edgePrograms.hasOwnProperty(L))throw new Error('Sigma: could not find a suitable program for edge type "'.concat(L,'"!'));e||this.edgePrograms[L].allocate(O[L]||0),O[L]=0}this.settings.zIndex&&c[0]!==c[1]&&(x=(0,at.zIndexOrdering)(c,function(M){return r.edgeDataCache[M].zIndex},x));for(var v=0,m=x.length;v<m;v++){var A=x[v],C=this.edgeDataCache[A],R=i.extremities(A),b=this.nodeDataCache[R[0]],_=this.nodeDataCache[R[1]],w=C.hidden||b.hidden||_.hidden;this.edgePrograms[C.type].process(b,_,C,w,O[C.type]++)}for(var L in this.edgePrograms){var $=this.edgePrograms[L];!e&&typeof $.computeIndices=="function"&&$.computeIndices()}return this},t.prototype.handleSettingsUpdate=function(){return this.camera.minRatio=this.settings.minCameraRatio,this.camera.maxRatio=this.settings.maxCameraRatio,this.camera.setState(this.camera.validateState(this.camera.getState())),this},t.prototype._refresh=function(){return this.needToProcess?this.process():this.needToSoftProcess&&this.process(!0),this.needToProcess=!1,this.needToSoftProcess=!1,this.render(),this},t.prototype._scheduleRefresh=function(){var e=this;return this.renderFrame||(this.renderFrame=(0,at.requestFrame)(function(){e._refresh(),e.renderFrame=null})),this},t.prototype.renderLabels=function(){if(!this.settings.renderLabels)return this;var e=this.camera.getState(),r;if(e.ratio>=1)r=new Set(this.graph.nodes());else{var i=this.viewRectangle();r=new Set(this.quadtree.rectangle(i.x1,1-i.y1,i.x2,1-i.y2,i.height))}var o=this.labelGrid.getLabelsToDisplay(e.ratio,this.settings.labelDensity).concat(this.nodesWithForcedLabels);this.displayedLabels=new Set;for(var a=this.canvasContexts.labels,s=0,c=o.length;s<c;s++){var l=o[s],f=this.nodeDataCache[l];if(!this.displayedLabels.has(l)&&!f.hidden){var p=this.framedGraphToViewport(f),g=p.x,v=p.y,m=this.scaleSize(f.size);!f.forceLabel&&m<this.settings.labelRenderedSizeThreshold||!r.has(l)||(this.displayedLabels.add(l),this.settings.labelRenderer(a,Ue(Ue({key:l},f),{size:m,x:g,y:v}),this.settings))}}return this},t.prototype.renderEdgeLabels=function(){if(!this.settings.renderEdgeLabels)return this;var e=this.canvasContexts.edgeLabels;e.clearRect(0,0,this.width,this.height);for(var r=(0,Au.edgeLabelsToDisplayFromNodes)({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedLabels,highlightedNodes:this.highlightedNodes}).concat(this.edgesWithForcedLabels),i=new Set,o=0,a=r.length;o<a;o++){var s=r[o],c=this.graph.extremities(s),l=this.nodeDataCache[c[0]],f=this.nodeDataCache[c[1]],p=this.edgeDataCache[s];i.has(s)||p.hidden||l.hidden||f.hidden||(this.settings.edgeLabelRenderer(e,Ue(Ue({key:s},p),{size:this.scaleSize(p.size)}),Ue(Ue(Ue({key:c[0]},l),this.framedGraphToViewport(l)),{size:this.scaleSize(l.size)}),Ue(Ue(Ue({key:c[1]},f),this.framedGraphToViewport(f)),{size:this.scaleSize(f.size)}),this.settings),i.add(s))}return this},t.prototype.renderHighlightedNodes=function(){var e=this,r=this.canvasContexts.hovers;r.clearRect(0,0,this.width,this.height);var i=function(l){var f=e.nodeDataCache[l],p=e.framedGraphToViewport(f),g=p.x,v=p.y,m=e.scaleSize(f.size);e.settings.hoverRenderer(r,Ue(Ue({key:l},f),{size:m,x:g,y:v}),e.settings)},o=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&o.push(this.hoveredNode),this.highlightedNodes.forEach(function(l){l!==e.hoveredNode&&o.push(l)}),o.forEach(function(l){return i(l)});var a={};o.forEach(function(l){var f=e.nodeDataCache[l].type;a[f]=(a[f]||0)+1});for(var s in this.hoverNodePrograms)this.hoverNodePrograms[s].allocate(a[s]||0),a[s]=0;o.forEach(function(l){var f=e.nodeDataCache[l];e.hoverNodePrograms[f.type].process(f,f.hidden,a[f.type]++)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);for(var s in this.hoverNodePrograms){var c=this.hoverNodePrograms[s];c.bind(),c.bufferData(),c.render({matrix:this.matrix,width:this.width,height:this.height,ratio:this.camera.ratio,correctionRatio:this.correctionRatio/this.camera.ratio,scalingRatio:this.pixelRatio})}},t.prototype.scheduleHighlightedNodesRender=function(){var e=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=(0,at.requestFrame)(function(){e.renderHighlightedNodesFrame=null,e.renderHighlightedNodes(),e.renderEdgeLabels()}))},t.prototype.render=function(){var e=this;this.emit("beforeRender");var r=function(){return e.emit("afterRender"),e};if(this.renderFrame&&((0,at.cancelFrame)(this.renderFrame),this.renderFrame=null,this.needToProcess=!1,this.needToSoftProcess=!1),this.resize(),this.clear(),this.updateCachedValues(),!this.graph.order)return r();var i=this.mouseCaptor,o=this.camera.isAnimated()||i.isMoving||i.draggedEvents||i.currentWheelDirection,a=this.camera.getState(),s=this.getDimensions(),c=this.getGraphDimensions(),l=this.getSetting("stagePadding")||0;this.matrix=(0,at.matrixFromCamera)(a,s,c,l),this.invMatrix=(0,at.matrixFromCamera)(a,s,c,l,!0),this.correctionRatio=(0,at.getMatrixImpact)(this.matrix,a,s);for(var f in this.nodePrograms){var p=this.nodePrograms[f];p.bind(),p.bufferData(),p.render({matrix:this.matrix,width:this.width,height:this.height,ratio:a.ratio,correctionRatio:this.correctionRatio/a.ratio,scalingRatio:this.pixelRatio})}if(!this.settings.hideEdgesOnMove||!o)for(var f in this.edgePrograms){var p=this.edgePrograms[f];p.bind(),p.bufferData(),p.render({matrix:this.matrix,width:this.width,height:this.height,ratio:a.ratio,correctionRatio:this.correctionRatio/a.ratio,scalingRatio:this.pixelRatio})}return this.settings.hideLabelsOnMove&&o||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),r()},t.prototype.updateCachedValues=function(){var e=this.camera.getState().ratio;this.cameraSizeRatio=Math.sqrt(e)},t.prototype.getCamera=function(){return this.camera},t.prototype.getContainer=function(){return this.container},t.prototype.getGraph=function(){return this.graph},t.prototype.getMouseCaptor=function(){return this.mouseCaptor},t.prototype.getTouchCaptor=function(){return this.touchCaptor},t.prototype.getDimensions=function(){return{width:this.width,height:this.height}},t.prototype.getGraphDimensions=function(){var e=this.customBBox||this.nodeExtent;return{width:e.x[1]-e.x[0]||1,height:e.y[1]-e.y[0]||1}},t.prototype.getNodeDisplayData=function(e){var r=this.nodeDataCache[e];return r?Object.assign({},r):void 0},t.prototype.getEdgeDisplayData=function(e){var r=this.edgeDataCache[e];return r?Object.assign({},r):void 0},t.prototype.getSettings=function(){return Ue({},this.settings)},t.prototype.getSetting=function(e){return this.settings[e]},t.prototype.setSetting=function(e,r){return this.settings[e]=r,(0,ao.validateSettings)(this.settings),this.handleSettingsUpdate(),this.needToProcess=!0,this._scheduleRefresh(),this},t.prototype.updateSetting=function(e,r){return this.settings[e]=r(this.settings[e]),(0,ao.validateSettings)(this.settings),this.handleSettingsUpdate(),this.needToProcess=!0,this._scheduleRefresh(),this},t.prototype.resize=function(){var e=this.width,r=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=(0,at.getPixelRatio)(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw new Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw new Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seing this error.");if(e===this.width&&r===this.height)return this;this.emit("resize");for(var i in this.elements){var o=this.elements[i];o.style.width=this.width+"px",o.style.height=this.height+"px"}for(var i in this.canvasContexts)this.elements[i].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[i].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1&&this.canvasContexts[i].scale(this.pixelRatio,this.pixelRatio);for(var i in this.webGLContexts)this.elements[i].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[i].setAttribute("height",this.height*this.pixelRatio+"px"),this.webGLContexts[i].viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio);return this},t.prototype.clear=function(){return this.webGLContexts.nodes.clear(this.webGLContexts.nodes.COLOR_BUFFER_BIT),this.webGLContexts.edges.clear(this.webGLContexts.edges.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this},t.prototype.refresh=function(){return this.needToProcess=!0,this._refresh(),this},t.prototype.scheduleRefresh=function(){return this.needToProcess=!0,this._scheduleRefresh(),this},t.prototype.getViewportZoomedState=function(e,r){var i=this.camera.getState(),o=i.ratio,a=i.angle,s=i.x,c=i.y,l=r/o,f={x:this.width/2,y:this.height/2},p=this.viewportToFramedGraph(e),g=this.viewportToFramedGraph(f);return{angle:a,x:(p.x-g.x)*(1-l)+s,y:(p.y-g.y)*(1-l)+c,ratio:r}},t.prototype.viewRectangle=function(){var e=0*this.width/8,r=0*this.height/8,i=this.viewportToFramedGraph({x:0-e,y:0-r}),o=this.viewportToFramedGraph({x:this.width+e,y:0-r}),a=this.viewportToFramedGraph({x:0,y:this.height+r});return{x1:i.x,y1:i.y,x2:o.x,y2:o.y,height:o.y-a.y}},t.prototype.framedGraphToViewport=function(e,r){r===void 0&&(r={});var i=!!r.cameraState||!!r.viewportDimensions||!!r.graphDimensions,o=r.matrix?r.matrix:i?(0,at.matrixFromCamera)(r.cameraState||this.camera.getState(),r.viewportDimensions||this.getDimensions(),r.graphDimensions||this.getGraphDimensions(),r.padding||this.getSetting("stagePadding")||0):this.matrix,a=(0,so.multiplyVec2)(o,e);return{x:(1+a.x)*this.width/2,y:(1-a.y)*this.height/2}},t.prototype.viewportToFramedGraph=function(e,r){r===void 0&&(r={});var i=!!r.cameraState||!!r.viewportDimensions||!r.graphDimensions,o=r.matrix?r.matrix:i?(0,at.matrixFromCamera)(r.cameraState||this.camera.getState(),r.viewportDimensions||this.getDimensions(),r.graphDimensions||this.getGraphDimensions(),r.padding||this.getSetting("stagePadding")||0,!0):this.invMatrix,a=(0,so.multiplyVec2)(o,{x:e.x/this.width*2-1,y:1-e.y/this.height*2});return isNaN(a.x)&&(a.x=0),isNaN(a.y)&&(a.y=0),a},t.prototype.viewportToGraph=function(e,r){return r===void 0&&(r={}),this.normalizationFunction.inverse(this.viewportToFramedGraph(e,r))},t.prototype.graphToViewport=function(e,r){return r===void 0&&(r={}),this.framedGraphToViewport(this.normalizationFunction(e),r)},t.prototype.getBBox=function(){return(0,at.graphExtent)(this.graph)},t.prototype.getCustomBBox=function(){return this.customBBox},t.prototype.setCustomBBox=function(e){return this.customBBox=e,this._scheduleRefresh(),this},t.prototype.kill=function(){var e=this.graph;this.emit("kill"),this.removeAllListeners(),this.camera.removeListener("updated",this.activeListeners.camera),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),e.removeListener("nodeAdded",this.activeListeners.dropNodeGraphUpdate),e.removeListener("nodeDropped",this.activeListeners.graphUpdate),e.removeListener("nodeAttributesUpdated",this.activeListeners.softGraphUpdate),e.removeListener("eachNodeAttributesUpdated",this.activeListeners.graphUpdate),e.removeListener("edgeAdded",this.activeListeners.graphUpdate),e.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),e.removeListener("edgeAttributesUpdated",this.activeListeners.softGraphUpdate),e.removeListener("eachEdgeAttributesUpdated",this.activeListeners.graphUpdate),e.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),e.removeListener("cleared",this.activeListeners.clearGraphUpdate),this.quadtree=new Eu.default,this.nodeDataCache={},this.edgeDataCache={},this.nodesWithForcedLabels=[],this.edgesWithForcedLabels=[],this.highlightedNodes.clear(),this.renderFrame&&((0,at.cancelFrame)(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&((0,at.cancelFrame)(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var r=this.container;r.firstChild;)r.removeChild(r.firstChild)},t.prototype.scaleSize=function(e){return e/this.cameraSizeRatio},t.prototype.getCanvases=function(){return Ue({},this.elements)},t}(fm.TypedEventEmitter);za.default=mm;var Po=Y&&Y.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(hr,"__esModule",{value:!0});hr.Sigma=hr.MouseCaptor=hr.QuadTree=hr.Camera=void 0;var hc=Po(za);hr.Sigma=hc.default;var ym=Po(ko);hr.Camera=ym.default;var bm=Po(Vt);hr.QuadTree=bm.default;var wm=Po(xo);hr.MouseCaptor=wm.default;var _m=hr.default=hc.default;class Em extends _m{constructor(t,e,r){super(t,e,r)}}function Am(n){let t,e,r;const i=n[11].default,o=Rh(i,n,n[10],null);return{c(){t=oe("div"),e=Se(),o&&o.c(),z(t,"class","sigma svelte-u8wjrv")},m(a,s){st(a,t,s),n[12](t),st(a,e,s),o&&o.m(a,s),r=!0},p(a,[s]){o&&o.p&&(!r||s&1024)&&Ih(o,i,a,a[10],r?Fh(i,a[10],s,null):jh(a[10]),null)},i(a){r||(rr(o,a),r=!0)},o(a){fr(o,a),r=!1},d(a){a&&nt(t),n[12](null),a&&nt(e),o&&o.d(a)}}}const uo="#f87171",sa="#fb923c";function Sm(n,t,e){let r,i,o;$r(n,Ie,_=>e(7,r=_)),$r(n,$a,_=>e(8,i=_)),$r(n,kl,_=>e(9,o=_));let{$$slots:a={},$$scope:s}=t,c,l,f,{size:p}=t;const g=ju();Nh("sigma",{getGraph:()=>l==null?void 0:l.getGraph()}),bo(async()=>{const _=new ke,w=au(r.themeMode);e(2,l=new Em(_,c,{allowInvalidContainer:!0,nodeReducer:E,edgeReducer:R,defaultNodeColor:w.nodeColor,defaultEdgeColor:w.edgeColor,labelColor:{color:w.nodeLabelColor},labelBackgroundColor:w.nodeLabelBackground,labelShadowColor:w.nodeLabelShadowColor,nodeProgramClasses:{circle:Ag,image:kg()},hoverRenderer:Fg})),l.on("clickNode",v),r.cameraState&&l.getCamera().setState(r.cameraState)}),Iu(()=>{if(!l)return;let _=Pp.inferSettings(p);f==null||f.kill();const w=l.getGraph();e(3,f=new _p(w,{settings:ci(wr({},_),{gravity:r.nodesGravity*_.gravity,strongGravityMode:!0,scalingRatio:r.scalingRatio*_.scalingRatio,barnesHutTheta:.2,edgeWeightInfluence:r.edgeWeightInfluence*-1,slowDown:100})})),f.start(),l.refresh()}),wo(async()=>{f&&(f.kill(),e(3,f=void 0)),l&&(Mt(Ie,r.cameraState=l.getCamera().getState(),r),l.kill(),e(2,l=void 0))});const v=async({node:_})=>{g("nodeclick",_)},m=(_,w)=>_>w?w:_,E=(_,w)=>{const $=l==null?void 0:l.getGraph(),M=wr({},w);if(r.size==="in"?M.size=m(Math.max(2,$.neighbors(_).length/2),16):r.size==="out"&&(M.size=m($.inDegree(_),16)),r.mode===et.ShortestPath){const Q=r.pathA&&(O==null?void 0:O.get(r.pathA.toUpperCase())),pe=r.pathB&&(O==null?void 0:O.get(r.pathB.toUpperCase()));(S==null?void 0:S.includes(_))||_===Q||_===pe?(M.color=uo,M.zIndex=2,M.highlighted=!0):M.zIndex=-1}if(r.mode===et.AdamicAdar&&L){const Q=r.pathA&&(O==null?void 0:O.get(r.pathA.toUpperCase()));Q&&_===Q?(M.size=10,M.zIndex=2,M.color=sa,M.highlighted=!0):L[_]&&(M.color=uo,M.size=m(r.bubbleSize*L[_].measure,32),M.label=`${L[_].measure} ${w.label}`)}if(r.mode===et.CoCitation&&x){const Q=r.pathA&&(O==null?void 0:O.get(r.pathA.toUpperCase()));Q&&_===Q?(M.size=10,M.zIndex=2,M.color=sa,M.highlighted=!0):x[_]&&(M.color=uo,M.size=r.bubbleSize*x[_].measure,M.label=`${x[_].measure} ${w.label}`)}return M};let S,C,L,O,x,A=[];const R=(_,w)=>{const $=wr({},w);return l&&r.mode===et.ShortestPath&&$p(C,_)&&($.color=uo,$.size=5),$};function b(_){ua[_?"unshift":"push"](()=>{c=_,e(0,c)})}return n.$$set=_=>{"size"in _&&e(1,p=_.size),"$$scope"in _&&e(10,s=_.$$scope)},n.$$.update=()=>{if(n.$$.dirty&132&&l&&l.setSetting("labelRenderedSizeThreshold",r.labelThreshold),n.$$.dirty&520&&(o?f&&f.start():f&&f.stop()),n.$$.dirty&132&&l&&xl(r.search,l.getGraph()).then(_=>{e(6,A=_)}),n.$$.dirty&196&&l){const _=au(r.themeMode),w=l.getGraph();l.setSetting("defaultEdgeColor",_.edgeColor),l.setSetting("defaultNodeColor",_.nodeColor),l.setSetting("labelColor",{color:_.nodeLabelColor}),l.setSetting("labelBackgroundColor",_.nodeLabelBackground),l.setSetting("labelShadowColor",_.nodeLabelShadowColor),w.updateEachNodeAttributes(($,M)=>(M.color=_.nodeColor,M)),r.filters.forEach($=>{w.updateEachNodeAttributes((M,Q)=>{var pe,J;return Q.highlighted=!1,Q.size=((pe=Q.size)!=null?pe:Q.size)+2,$.searchType==="color"&&((J=$.foundNodeIds)==null?void 0:J.includes(M))&&(Q.color=$.searchColor),Q})}),A&&w.updateEachNodeAttributes(($,M)=>{var Q,pe;return M.highlighted=!1,M.size=((Q=M.size)!=null?Q:M.size)+2,A!=null&&A.includes($)&&(M.color=sa,M.highlighted=!0,M.size=((pe=M.size)!=null?pe:M.size)+2),M})}if(n.$$.dirty&388&&l&&(r.pathA||r.pathB||r.search)&&e(5,O=tp(i)),n.$$.dirty&132)if(l&&r.mode===et.ShortestPath&&r.pathA&&r.pathB){r.filterLength;const _=l.getGraph().copy();_.forEachNode(($,M)=>{M.hidden&&_.dropNode($)});const w=r.directed?mn(_,r.pathA,r.pathB):va(_,r.pathB,r.pathA);S=w.nodes,C=w.edges}else S=void 0,C=void 0;if(n.$$.dirty&180)if(l&&r.mode===et.AdamicAdar&&r.pathA){const _=l.getGraph(),w=r.pathA&&(O==null?void 0:O.get(r.pathA.toUpperCase()));w?(e(4,L=jp(_,w)),console.log(L)):e(4,L=void 0)}else e(4,L=void 0);if(n.$$.dirty&164)if(l&&r.mode===et.CoCitation&&r.pathA){const _=O==null?void 0:O.get(r.pathA.toUpperCase());_?(async()=>x=await Gp(l.getGraph(),_))():x=void 0}else x=void 0},[c,p,l,f,L,O,A,r,i,o,s,a,b]}class Cm extends Dn{constructor(t){super(),xn(this,t,Sm,Am,nn,{size:1})}}function Cu(n){const t=n[5](n[1],n[0].filter,n[0].search,n[0].filterLength);n[11]=t}function Lu(n,t,e){const r=n.slice();return r[12]=t[e],r}function Tu(n,t,e){const r=n.slice();return r[15]=t[e],r}function Ou(n,t){let e,r,i;return r=new ip({props:{id:t[15],attributes:t[11].getNodeAttributes(t[15])}}),{key:n,first:null,c(){e=Aa(),Ei(r.$$.fragment),this.first=e},m(o,a){st(o,e,a),_n(r,o,a),i=!0},p(o,a){t=o;const s={};a&3&&(s.id=t[15]),a&3&&(s.attributes=t[11].getNodeAttributes(t[15])),r.$set(s)},i(o){i||(rr(r.$$.fragment,o),i=!0)},o(o){fr(r.$$.fragment,o),i=!1},d(o){o&&nt(e),En(r,o)}}}function ku(n,t){let e,r,i;return r=new ap({props:{source:t[11].source(t[12]),target:t[11].target(t[12]),attributes:t[11].getEdgeAttributes(t[12])}}),{key:n,first:null,c(){e=Aa(),Ei(r.$$.fragment),this.first=e},m(o,a){st(o,e,a),_n(r,o,a),i=!0},p(o,a){t=o;const s={};a&3&&(s.source=t[11].source(t[12])),a&3&&(s.target=t[11].target(t[12])),a&3&&(s.attributes=t[11].getEdgeAttributes(t[12])),r.$set(s)},i(o){i||(rr(r.$$.fragment,o),i=!0)},o(o){fr(r.$$.fragment,o),i=!1},d(o){o&&nt(e),En(r,o)}}}function Lm(n){Cu(n);let t=[],e=new Map,r,i=[],o=new Map,a,s,c=n[11].nodes();const l=g=>g[15];for(let g=0;g<c.length;g+=1){let v=Tu(n,c,g),m=l(v);e.set(m,t[g]=Ou(m,v))}let f=n[11].edges();const p=g=>g[12];for(let g=0;g<f.length;g+=1){let v=Lu(n,f,g),m=p(v);o.set(m,i[g]=ku(m,v))}return{c(){for(let g=0;g<t.length;g+=1)t[g].c();r=Se();for(let g=0;g<i.length;g+=1)i[g].c();a=Aa()},m(g,v){for(let m=0;m<t.length;m+=1)t[m].m(g,v);st(g,r,v);for(let m=0;m<i.length;m+=1)i[m].m(g,v);st(g,a,v),s=!0},p(g,v){Cu(g),v&35&&(c=g[11].nodes(),ca(),t=fa(t,v,l,1,g,c,e,r.parentNode,da,Ou,r,Tu),ha()),v&35&&(f=g[11].edges(),ca(),i=fa(i,v,p,1,g,f,o,a.parentNode,da,ku,a,Lu),ha())},i(g){if(!s){for(let v=0;v<c.length;v+=1)rr(t[v]);for(let v=0;v<f.length;v+=1)rr(i[v]);s=!0}},o(g){for(let v=0;v<t.length;v+=1)fr(t[v]);for(let v=0;v<i.length;v+=1)fr(i[v]);s=!1},d(g){for(let v=0;v<t.length;v+=1)t[v].d(g);g&&nt(r);for(let v=0;v<i.length;v+=1)i[v].d(g);g&&nt(a)}}}function Tm(n){let t,e,r,i,o,a,s,c,l,f;return o=new Cm({props:{size:n[1].size,$$slots:{default:[Lm]},$$scope:{ctx:n}}}),o.$on("nodeclick",n[4]),s=new gp({}),{c(){t=oe("main"),e=oe("div"),r=oe("button"),r.innerHTML='<div class="i-mdi-close text-slate-600"></div>',i=Se(),Ei(o.$$.fragment),a=Se(),Ei(s.$$.fragment),z(r,"class","h-8 w-8 p-1 opacity-50 flex justify-center items-center bg-white border-0 hover:opacity-100 hover:bg-slate-100 rounded"),z(e,"class","flex flex-row justify-end pr-2"),z(t,"class","svelte-exomf0")},m(p,g){st(p,t,g),H(t,e),H(e,r),H(t,i),_n(o,t,null),H(t,a),_n(s,t,null),c=!0,l||(f=[ze(window,"keydown",n[2]),ze(window,"keyup",n[3]),ze(r,"click",Om)],l=!0)},p(p,[g]){const v={};g&2&&(v.size=p[1].size),g&262147&&(v.$$scope={dirty:g,ctx:p}),o.$set(v)},i(p){c||(rr(o.$$.fragment,p),rr(s.$$.fragment,p),c=!0)},o(p){fr(o.$$.fragment,p),fr(s.$$.fragment,p),c=!1},d(p){p&&nt(t),En(o),En(s),l=!1,Wt(f)}}}function Om(){logseq.hideMainUI()}function km(n,t,e){let r,i,o;$r(n,Ie,m=>e(0,r=m)),$r(n,kl,m=>e(9,i=m)),$r(n,$a,m=>e(1,o=m)),bo(async()=>{if(logseq.settings)if(logseq.settings.filters){let m=logseq.settings.filters;m.forEach((E,S)=>(E.id=S,E)),Mt(Ie,r.filters=m,r)}else Mt(Ie,r.filters=[],r);logseq.App.onThemeModeChanged(m=>{ya(),Mt(Ie,r.themeMode=m.mode,r)}),logseq.App.onThemeChanged(m=>{ya(),m.mode==="dark"?Mt(Ie,r.themeMode="dark",r):Mt(Ie,r.themeMode="light",r)}),logseq.on("ui:visible:changed",async({visible:m})=>{bi.visible(m),m&&bi.reload()}),Mt(Ie,r.themeMode=(await logseq.App.getUserConfigs()).preferredThemeMode,r),logseq.DB.onChanged(()=>{i&&bi.reload()})});let a=!1,s=!1;const c=m=>{m.key=="Escape"?logseq.hideMainUI():m.key==="Meta"&&(a=!0),m.key==="Shift"&&(s=!0)},l=m=>{m.key==="Meta"&&(a=!1),m.key==="Shift"&&(s=!1)},f=async m=>{if(console.log("nodeclicked",m,a,s),s){const E=await logseq.Editor.getPage(+m.detail);E&&logseq.Editor.openInRightSidebar(E.uuid)}else if(r.mode===et.Navigate||a){const E=await logseq.Editor.getPage(+m.detail);E&&(a=!1,logseq.App.pushState("page",{name:E.name}),logseq.hideMainUI())}else if(r.mode===et.AdamicAdar||r.mode===et.CoCitation){const E=await logseq.Editor.getPage(+m.detail);E&&r.pathA!==E.name?Mt(Ie,r.pathA=E.name,r):Mt(Ie,r.pathA=void 0,r)}else if(r.mode===et.ShortestPath&&!r.pathA){const E=await logseq.Editor.getPage(+m.detail);E&&Mt(Ie,r.pathA=E.name,r)}else if(r.mode===et.ShortestPath&&r.pathA){const E=await logseq.Editor.getPage(+m.detail);E&&Mt(Ie,r.pathB=E.name,r)}};let p;function g(m){if(p)for(const E of p.nodeEntries())m.hasNode(E.node)&&(m.updateNodeAttribute(E.node,"x",()=>E.attributes.x),m.updateNodeAttribute(E.node,"y",()=>E.attributes.y));return p=m,m}function v(m,E,S,C){if(m.forEachNode(O=>{m.setNodeAttribute(O,"hidden",!1)}),!E||!S)return g(m);const L=rp(m,S);return m.forEachNode(O=>{L(O,C)&&m.setNodeAttribute(O,"hidden",!0)}),g(m)}return n.$$.update=()=>{if(n.$$.dirty&1&&logseq.settings)if(logseq.settings.filters){let m=r.filters;const E=new Set;m=m.filter(S=>{if(S.id===void 0)return!1;const C=E.has(S.id);return E.add(S.id),!C}),logseq.updateSettings({filters:null}),logseq.updateSettings({filters:m})}else logseq.updateSettings({filters:[]})},[r,o,c,l,f,v]}class xm extends Dn{constructor(t){super(),xn(this,t,km,Tm,nn,{})}}const Dm=[{key:"journal",type:"boolean",title:"Show journal pages on graph",description:"Do you want to show journal pages on your graph?",default:!1},{key:"filters",type:"object",title:"Graph settings and filters",description:"Graph settings and filters",default:[]}];function Pm(){return{async openGraph(){logseq.showMainUI({autoFocus:!0})}}}async function Rm(){new xm({target:document.getElementById("app")}),ya();const n={position:"fixed",zIndex:12,height:"calc(100vh - 8px)",top:"8px",background:"var(--ls-primary-background-color)",color:"var(--ls-primary-text-color)"};logseq.setMainUIInlineStyle(n),logseq.App.registerUIItem("toolbar",{key:"logseq-graph-analysis",template:`
      <a class="button" data-on-click="openGraph" title="Open graph analysis">
        <svg style="width:24px;height:24px" viewBox="0 0 24 24">
          <path fill="currentColor" d="M21 8C19.5 8 18.7 9.4 19.1 10.5L15.5 14.1C15.2 14 14.8 14 14.5 14.1L11.9 11.5C12.3 10.4 11.5 9 10 9C8.6 9 7.7 10.4 8.1 11.5L3.5 16C2.4 15.7 1 16.5 1 18C1 19.1 1.9 20 3 20C4.4 20 5.3 18.6 4.9 17.5L9.4 12.9C9.7 13 10.1 13 10.4 12.9L13 15.5C12.7 16.5 13.5 18 15 18C16.5 18 17.3 16.6 16.9 15.5L20.5 11.9C21.6 12.2 23 11.4 23 10C23 8.9 22.1 8 21 8M15 9L15.9 6.9L18 6L15.9 5.1L15 3L14.1 5.1L12 6L14.1 6.9L15 9M3.5 11L4 9L6 8.5L4 8L3.5 6L3 8L1 8.5L3 9L3.5 11Z" />
        </svg> 
     </a>`})}logseq.useSettingsSchema(Dm);logseq.ready(Pm(),Rm).catch(()=>console.error);
